---
title: "í”„ë¡œì‹œì €(Procedure)"
excerpt: "ì•„ì´í‹°ìœŒ 0610_(3) "
categories:
      - ORACLE11g
tags:
      - ORACLE11g
      - TIL
last-modified-at: 2025-06-10T18:06
---

# ìµëª… ë¸”ë¡ (anonymous block)

- ì´ë¦„ì´ ì—†ëŠ” ë¸”ë¡
- ë§¤ë²ˆ ì»´íŒŒì¼í•´ì•¼ í•œë‹¤.
- ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë˜ì§€ ì•ŠëŠ”ë‹¤..
- ë‹¤ë¥¸ ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ í˜¸ì¶œí•  ìˆ˜ ì—†ë‹¤.
- ê°’ì„ ë°˜í™˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. (return ê°’ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ë‹¤.)
- íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. (ëª…ì‹œì  ì»¤ì„œ ë‚´ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥)

# ì„œë¸Œ í”„ë¡œê·¸ë¨ (SubProgram)

- ì´ë¦„ì´ ìˆëŠ” ë¸”ë¡
- í•œ ë²ˆë§Œ ì»´íŒŒì¼í•œë‹¤.
- ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ëœë‹¤.
- ë‹¤ë¥¸ ì‘ìš© í”„ë¡œê·¸ë¨ì—ì„œ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.
- ê°’ì„ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤.
- íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- í”„ë¡œì‹œì €(procedure), í•¨ìˆ˜(function), íŒ¨í‚¤ì§€(package)
- create procedure ì‹œìŠ¤í…œ ê¶Œí•œì´ í•„ìš”í•˜ë‹¤.

```sql
SELECT * FROM session_privs; -- CREATE
```

# í”„ë¡œì‹œì € (Procedure)

- **íŠ¹ì • ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ì„œë¸Œ í”„ë¡œê·¸ë¨**
- ë°ì´í„°ë² ì´ìŠ¤ì— ìŠ¤í‚¤ë§ˆ ê°ì²´ë¡œ ì €ì¥í•  ìˆ˜ ìˆë‹¤.
- ëª¨ë“ˆì‹, í™•ì¥ì„±, ì¬ì‚¬ìš©ì„±, ìœ ì§€ ê´€ë¦¬ ìš©ì´ì„± ì¦ëŒ€ëœë‹¤.

**ğŸ“ ì–´ëŠ ê³³ì—ì„œ ì‚¬ìš©í•˜ì‹¤ê±´ê°€ìš”?**

- í•¨ìˆ˜ â†’ SQL ì•ˆì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´, í‘œí˜„ì‹ìœ¼ë¡œ
- í”„ë¡œì‹œì € â†’ PL/SQL ì•ˆì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´. í•˜ë‚˜ì˜ ë¬¸ì²˜ëŸ¼ ì‚¬ìš©í•  ë•Œ.

```sql
CREATE OR REPLACE PROCEDURE procedure_name
(parameter [mode] datatype,
...
parameter [mode] datatype)
IS[AS]
	 ë³€ìˆ˜, ìƒìˆ˜, ëª…ì‹œì  ì»¤ì„œ, ì‚¬ìš©ìê°€ ì •ì˜í•œ ì˜ˆì™¸ì‚¬í•­
BEGIN
EXCEPTION
END;
```

# íŒŒë¼ë¯¸í„°

- íŒŒë¼ë¯¸í„°ëŠ” ë°ì´í„° ê°’ì„ í˜¸ì¶œ í™˜ê²½ì—ì„œ í”„ë¡œì‹œì € ë˜ëŠ” í”„ë¡œì‹œì €ì—ì„œ í˜¸ì¶œ í™˜ê²½ìœ¼ë¡œ ì „ì†¡í•˜ëŠ”ë° ì‚¬ìš©í•œë‹¤.

## í˜•ì‹ ë§¤ê°œë³€ìˆ˜ (formal parameter)

- ì„œë¸Œ í”„ë¡œê·¸ë¨ ì‚¬ì–‘ì˜ íŒŒë¼ë¯¸í„° ë¦¬ìŠ¤íŠ¸ì— ì„ ì–¸ëœ ë¡œì»¬ ë³€ìˆ˜
- ë°ì´í„° íƒ€ì…ë§Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤. (sizeë¥¼ í‘œí˜„í•˜ë©´ ì•ˆëœë‹¤.)

```sql
CREATE OR REPLACE PROCEDURE emp_proc(p_id IN number)
IS                                   ----------in ëª¨ë“œ    
	v_rec employees%rowtype;

BEGIN  
        SELECT *
        INTO v_rec
        FROM hr.employees
        WHERE employee_id = p_id;
        dbms_output.put_line(v_rec.last_name);
   EXCEPTION
       WHEN NO_DATA_FOUND THEN
           RAISE_APPLICATION_ERROR(-20000,'ì‚¬ì›ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',TRUE);
   END;
   /	
```

```sql
SQL> desc emp_proc
```

![image.png](/assets/20250610/6.png)

```sql
CREATE OR REPLACE PROCEDURE emp_proc -- 
IS
	v_rec employees%rowtype;

BEGIN  
        SELECT *
        INTO v_rec
        FROM hr.employees
        WHERE employee_id = 100;
        dbms_output.put_line(v_rec.last_name);
 EXCEPTION
       WHEN NO_DATA_FOUND THEN
           RAISE_APPLICATION_ERROR(-20000,'ì‚¬ì›ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',TRUE);
 END;
 /	
```

â–¶ï¸ SQL Developer ì—ì„œ ë‚´ê°€ ë§Œë“  í”„ë¡œì‹œì €  ì¡°íšŒ.

```sql
SELECT text
FROM user_source
WHERE name = 'EMP_PROC'
ORDER BY line;
```

DB ì•ˆì— Source ì½”ë“œ , parse í•œ ê°’ ì €ì¥ execute ë‹¨ê³„ì—ì„œëŠ” parse (compile) ëœ ì½”ë“œê°’ì„ ì‚¬ìš©í•œë‹¤.

![image.png](/assets/20250610/7.png)

â†’ ì—ëŸ¬ ë‚œ í”„ë¡œì‹œì €

## ì‹¤ì œ ë§¤ê°œë³€ìˆ˜ (Actual Parameter)

- ì‹¤ì œ íŒŒë¼ë¯¸í„°ë¥¼ ì‹¤ì œ ì¸ìˆ˜(argument)ë¼ê³ ë„ í•œë‹¤.
- í˜¸ì¶œ ì„œë¸Œ í”„ë¡œê·¸ë¨ì˜ íŒŒë¼ë¯¸í„° ë¦¬ìŠ¤íŠ¸ì— ì‚¬ìš©ë˜ëŠ” ë¦¬í„°ëŸ´ê°’, ë³€ìˆ˜, í‘œí˜„ì‹
    
    â†’ execute emp_proc(100)
    

```sql
BEGIN
	emp_proc(100);
END;
/
```

â–¶ï¸ parameter mode

- `IN` : í˜¸ì¶œ í™˜ê²½ì—ì„œ ê°’ì„ **í”„ë¡œì‹œì €(í•¨ìˆ˜)ë¡œ ì „ë‹¬**í•œë‹¤. **ê¸°ë³¸ê°’, ìƒìˆ˜ë¡œ ë™ì‘**í•œë‹¤..(ì…ë ¥ë°›ì€ ê°’ë§Œ ì‚¬ìš©í•œë‹¤.. ê¼­ ê°’ì„ ë„£ì–´ì•¼ í•¨.. ì‹¤ì œ ë§¤ê°œë³€ìˆ˜ í•„ìš”)
- `OUT`

```sql
-- ì‚¬ì›ë²ˆí˜¸, ê¸‰ì—¬ ì¸ìƒ ë¹„ìœ¨ì„ ì…ë ¥ê°’ìœ¼ë¡œ ë°›ì•„ì„œ ê¸‰ì—¬ë¥¼ ìˆ˜ì •í•˜ëŠ” í”„ë¡œê·¸ë¨

CREATE OR REPLACE PROCEDURE raise_salary
(p_id IN number,
 p_percent IN number)
IS
BEGIN
    UPDATE hr.employees
    SET salary = salary *(1 + p_percent / 100)
    WHERE employee_id = p_id;
END;
/
```

![image.png](/assets/20250610/8.png)

```sql
-- ì–´ë–¤ íƒ€ì…ì˜ ì‹¤ì œ ë§¤ê°œë³€ìˆ˜ê°€ ë“¤ì–´ê°€ì•¼ í•˜ëŠ”ì§€ ì¡°íšŒí•´ë³´ê¸°
desc raise_salary;
```

![image.png](/assets/20250610/9.png)

```sql
exec raise_salary(100,10);  -- ê°’ì„ ì…ë ¥ 

SELECT employee_id, salary FROM hr.employees WHERE employee_id = 100;
```

![image.png](/assets/20250610/10.png)

â–¶ï¸ í”„ë¡œì‹œì € ì‚­ì œ

```sql
DROP PROCEDURE raise_salary;
```