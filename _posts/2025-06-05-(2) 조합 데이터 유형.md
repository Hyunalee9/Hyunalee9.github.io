---
title: "[32ì¼ì°¨] ì¡°í•© ë°ì´í„° ìœ í˜•"
excerpt: "ì•„ì´í‹°ìœŒ 0605_(2) "
categories:
      - ORACLE11g
tags:
      - ORACLE11g
      - TIL
last-modified-at: 2025-06-05T19:18
---



# ì¡°í•© ë°ì´í„° ìœ í˜•

- ìŠ¤ì¹¼ë¼ ìœ í˜•(scalar data type) : ë‹¨ì¼ê°’ì„ ë³´ìœ í•˜ëŠ” ë³€ìˆ˜
- ìŠ¤ì¹¼ë¼ ìœ í˜•ê³¼ ë‹¬ë¦¬ ë‹¤ì¤‘ê°’ì„ ë³´ìœ í•  ìˆ˜ ìžˆëŠ” ë³€ìˆ˜
- ë ˆì½”ë“œ (record) : ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„° ìœ í˜•ì˜ ê°’ì„ ì €ìž¥í•˜ê³ ìž í•  ë•Œ
- ë°°ì—´ (array) : ë™ì¼í•œ ìœ í˜•ì˜ ê°’ì„ ì €ìž¥
    - index by table(ì—°ê´€ ë°°ì—´)
    - nested table(ì¤‘ì²© í…Œì´ë¸”)
    - varray

```sql
DECLARE
    /*ë ˆì½”ë“œ íƒ€ìž… ì„ ì–¸, field(í•„ë“œ)*/
     TYPE dept_record_type IS RECORD
    (dept_id departments.department_id%type,
    dept_name departments.department_name%type,
    dept_mgr departments.manager_id%type,
    dept_loc departments.location_id%type);
    
    v_rec dept_record_type;
    
BEGIN
    SELECT *
    INTO v_rec
    FROM hr.departments
    WHERE department_id = 10;
    dbms_output.put_line('ë¶€ì„œë²ˆí˜¸ : '||v_rec.dept_id);
    dbms_output.put_line('ë¶€ì„œì´ë¦„ : '||v_rec.dept_name);
    dbms_output.put_line('ë¶€ì„œìž¥ : '||v_rec.dept_mgr);
    dbms_output.put_line('ë¶€ì„œìœ„ì¹˜ : '||v_rec.dept_loc);
END;
/
```

â–¶ï¸ ì»¬ëŸ¼ ê°¯ìˆ˜ê°€ ëŠ˜ì–´ë‚˜ë©´ ì¼ì¼ížˆ ì„ ì–¸í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìžˆë‹¤.

```sql
DECLARE
    TYPE rec_type IS RECORD
    ( sal         number,
      minsal      number default 1000,
      day         employees.hire_date%type,
      rec         employees%rowtype);
      
    v_rec rec_type;  
BEGIN
    v_rec.sal := v_rec.minsal + 500;
    v_rec.day := sysdate;
    
    SELECT *
    INTO v_rec.rec
    FROM hr.employees
    WHERE employee_id = :b_id;
    
    dbms_output.put_line(v_rec.rec.first_name);
    dbms_output.put_line(trunc(months_between(v_rec.day,v_rec.rec.hire_date)/12));
END;
/
```

 âž¡ **%rowtype ì‚¬ìš©.**

ðŸ“ **%rowtype**

- í…Œì´ë¸” ë˜ëŠ” ë·°ì˜ ì—´ì—ì„œ ì»¬ëŸ¼ ë° ë°ì´í„° íƒ€ìž…ì„ ê°€ì§€ê³  ë ˆì½”ë“œ íƒ€ìž…ì„ ì„ ì–¸í•œë‹¤.
- ë ˆì½”ë“œ íƒ€ìž…ì„ ì†ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìžˆìŒ.
- ì»¬ëŸ¼ ê°¯ìˆ˜ì™€ íƒ€ìž…ì„ ì•Œ í•„ìš”ê°€ ì—†ë‹¤.
- SELECT * ë¬¸
- í–‰ ë ˆë²¨ INSERT, UPDATEë¬¸

ì˜ˆì œ 1)

```sql
DECLARE
    
    v_rec departments%rowtype;
    
BEGIN
    SELECT *
    INTO v_rec
    FROM hr.departments
    WHERE department_id = 10;
    dbms_output.put_line('ë¶€ì„œë²ˆí˜¸ : '||v_rec.department_id);
    dbms_output.put_line('ë¶€ì„œì´ë¦„ : '||v_rec.department_name);
    dbms_output.put_line('ë¶€ì„œìž¥ : '||v_rec.manager_id);
    dbms_output.put_line('ë¶€ì„œìœ„ì¹˜ : '||v_rec.location_id);
END;
/

```

ì˜ˆì œ 2)

```sql
-- í…Œì´ë¸” ë§Œë“¤ê¸°
CREATE TABLE hr.retired_emp
(no   number,
name  varchar2(30),
job   varchar2(30),
mgr   number,
hiredate date,
leavedate date,
sal number,
comm number,
deptno number);

-- 
DECLARE
    **v_rec** retired_emp%rowtype;
BEGIN
    SELECT employee_id, last_name, job_id, manager_id, hire_date, sysdate, salary, commission_pct, department_id
    INTO **v_rec**
    FROM hr.employees 
    WHERE employee_id = 116;

    INSERT INTO hr.retired_emp VALUES v_rec;  -- í–‰ ë ˆë²¨ IBSERT ê°€ëŠ¥ (êµ¬ì¡°ê°€ ë™ì¼í•˜ë‹¤ë©´)
    
    COMMIT;
END;
/
-- ë ˆì½”ë“œ ë³€ìˆ˜ì˜ ëª¨ìŠµê³¼ ì´ í…Œì´ë¸” êµ¬ì¡°ê°€ ë™ì¼í•˜ë‹¤ë©´ í–‰ ë ˆë²¨ì˜ insertê°€ ê°€ëŠ¥í•˜ë‹¤.  

SELECT * FROM hr.retired_emp;
```

âž¡ í•œ í–‰ë§Œ ìˆ˜ì • ìž‘ì—…í•  ë•Œ.

```sql

-- í•œ í–‰ë§Œ ìˆ˜ì • ì ì—…í•  ë•Œ

DECLARE
    v_rec retired_emp%rowtype;
BEGIN
    SELECT employee_id, last_name, job_id, manager_id, hire_date, sysdate, salary, commission_pct, department_id
    INTO v_rec
    FROM hr.employees
    WHERE employee_id = 116;
    
    v_rec.name := upper(v_rec.name);
    v_rec.leavedate := to_date('2025-06-01','yyyy-mm-dd');
    v_rec.comm := 0.1;
    
    /* í–‰ ë ˆë²¨ UPDATE */
    UPDATE hr.retired_emp
    SET row = v_rec
    WHERE no = 116;
END;
/
```

## ì—°ê´€ ë°°ì—´ (associative array, index by table)

- 2ê°œì˜ ì—´ì„ í¬í•¨í•˜ëŠ” collection ì´ë‹¤.
- key, valueì§‘í•©ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìžˆë‹¤.
- key : ì •ìˆ˜ (pls_integer(-2G ~ 2G)), ë¬¸ìžì—´(varchar2(32767(11g),65536(12c))) ë°ì´í„° ìœ í˜•ì˜ primary key(unique, not null)
- value : ìŠ¤ì¹¼ë¼, ë ˆì½”ë“œ ë°ì´í„° ìœ í˜•

**ðŸ“ ë°°ì—´ ë©”ì†Œë“œ**

- count : ë°°ì—´ì´ í¬í•¨í•˜ëŠ” ê°’ì˜ ìˆ˜
- first : ë°°ì—´ì˜ ì²«ë²ˆì§¸(ê°€ìž¥ ìž‘ì€ ë²ˆí˜¸) ì¸ë±ìŠ¤ ë²ˆí˜¸(ë°©ë²ˆí˜¸)
- last : ë°°ì—´ì˜ ë§ˆì§€ë§‰(ê°€ìž¥ í° ë²ˆí˜¸) ì¸ë±ìŠ¤ ë²ˆí˜¸(ë°©ë²ˆí˜¸)
- next : ë°°ì—´ ì¸ë±ìŠ¤ në²ˆ ë’¤ì— ì˜¤ëŠ” ì¸ë±ìŠ¤ ë²ˆí˜¸
- prior : ë°°ì—´ ì¸ë±ìŠ¤ në²ˆ ì•žì— ì˜¤ëŠ” ì¸ë±ìŠ¤ ë²ˆí˜¸
- delete(n) : në²ˆ ê°’ì„ ì‚­ì œ
- delete(m,n) : më²ˆ ë¶€í„° në²ˆê¹Œì§€ ê°’ì„ ì‚­ì œ
- delete : ë°°ì—´ ëª¨ë“  ê°’ì„ ì‚­ì œ

ì˜ˆì œ 1)

```sql
DECLARE
    -- TYPE ì„ ì–¸í•  ë°ì´í„° íƒ€ìž… ì´ë¦„ IS TABLE OF varchar2(10)(-> ê° ìš”ì†ŒëŠ” ì´ íƒ€ìž…ì´ë‹¤)
    -- INDEX BY pls_integer ë¥¼ ì¸ë±ìŠ¤ í‚¤ë¡œ ì‚¬ìš©í•œë‹¤. 
		TYPE tab_char_type IS TABLE OF varchar2(10) INDEX BY pls_integer;
		v_city tab_char_type;
BEGIN
		v_city(1) := 'ì„œìš¸';
		v_city(2) := 'ëŒ€ì „';
		v_city(3) := 'ê²½ê¸°';
		v_city(4) := 'ë¶€ì‚°';
		dbms_output.put_line(v_city.count);
		dbms_output.put_line(v_city.first);
		dbms_output.put_line(v_city.last);
		dbms_output.put_line(v_city.next(1));
    dbms_output.put_line(v_city.prior(3));
		
END;
/

/*
4
1
4
2
2
*/

```

ì˜ˆì œ 2)

```sql
DECLARE
	TYPE tab_char_type IS TABLE OF varchar2(10) INDEX BY pls_integer;
	v_city tab_char_type;
BEGIN
		v_city(4) := 'ì„œìš¸';
		v_city(2) := 'ëŒ€ì „';
		v_city(3) := 'ê²½ê¸°';
		v_city(1) := 'ë¶€ì‚°';
		
		v_city.delete(2);
		FOR i IN v_city.first..v_city.last LOOP   -- ì˜¤ë¥˜ ë°œìƒ
				dbms_output.put_line(v_city(i));
		END LOOP;
END;
/

-->

DECLARE
	TYPE tab_char_type IS TABLE OF varchar2(10) INDEX BY pls_integer;
	v_city tab_char_type;
BEGIN
		v_city(4) := 'ì„œìš¸';
		v_city(2) := 'ëŒ€ì „';
		v_city(3) := 'ê²½ê¸°';
		v_city(1) := 'ë¶€ì‚°';
		
		v_city.delete(2);
		FOR i IN v_city.first..v_city.last LOOP
              IF  v_city.exists(i) then
				dbms_output.put_line(v_city(i));
              ELSE
                dbms_output.put_line(i||'key-valueê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
              END IF;  
		END LOOP;
END;
/

/*

ë¶€ì‚°
2key-valueê°€ ì¡´ìž¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
ê²½ê¸°
ì„œìš¸

*/
```

ì˜ˆì œ 3)

```sql

DECLARE
		TYPE tab_char_type IS TABLE OF varchar2(10) INDEX BY pls_integer;
		v_city tab_char_type;
BEGIN
		v_city(1) := 'ì„œìš¸';
		v_city(2) := 'ëŒ€ì „';
		v_city(3) := 'ê²½ê¸°';
		v_city(4) := 'ë¶€ì‚°';
		dbms_output.put_line(v_city(1));
		dbms_output.put_line(v_city(2));
		dbms_output.put_line(v_city(3));
		dbms_output.put_line(v_city(4));
		
END;
/

/*

ì„œìš¸
ëŒ€ì „
ê²½ê¸°
ë¶€ì‚°

*/
```