---
title: "[57ì¼ì°¨] Backup & Recovery2"
excerpt: "ì•„ì´í‹°ìœŒ 0715_Failure, SMON, ë°±ì—…, ë³µêµ¬"
categories:
      - ORACLE19c
tags:
      - ORACLE19c
      - TIL
last-modified-at: 2025-07-15T18:05
---

# ë°±ì—… & ë¦¬ì»¤ë²„ë¦¬ 2

## ðŸ“ Failure ë²”ì£¼

- Statement Failure
    - ì‘ìš© í”„ë¡œê·¸ëž¨ ë…¼ë¦¬ ì˜¤ë¥˜
    - ë¶€ì í•©í•œ ë°ì´í„°ë¥¼ í…Œì´ë¸”ì— ìž…ë ¥í•˜ê³  ì‹œë„í•˜ë ¤ëŠ” ê²½ìš°
    
    â–¶ï¸ ì ì ˆí•œ ì œì•½ ì¡°ê±´ìœ¼ë¡œ ì–´ëŠì •ë„ ì»¤ë²„ ê°€ëŠ¥ 
    
    - ì¶©ë¶„í•˜ì§€ ì•Šì€ ê¶Œí•œìœ¼ë¡œ ìž‘ì—…ì„ ìˆ˜í–‰í•˜ë ¤ê³  í•˜ëŠ” ê²½ìš°
    - í…Œì´ë¸”ì„ ìƒì„±í•˜ë ¤ê³  ì‹œë„í–ˆì§€ë§Œ í• ë‹¹ëŸ‰ í•œê³„ë¥¼ ì´ˆê³¼í•œ ê²½ìš°
    - extent í• ë‹¹í•˜ê²Œ ë§Œë“œëŠ” insert, update ìž‘ì—…ì„ í…Œì´ë¸”ì— ëŒ€í•´ ì‹œë„í–ˆì§€ë§Œ. í…Œì´ë¸”ìŠ¤íŽ˜ì´ìŠ¤ ì‚¬ìš© ê°€ëŠ¥í•œ ê³µê°„ì´ ë¶€ì¡±í•œ ê²½ìš°

â–¶ï¸  **Statement Failure í•´ê²°**

  í”„ë¡œê·¸ëž¨ì˜ ë…¼ë¦¬ì  íë¦„ ìˆ˜ì •

  ì œì•½ ì¡°ê±´ì— ë§žëŠ” ë°ì´í„°ë¥¼ ìž…ë ¥í•˜ê¸° ìœ„í•œ SQLë¬¸ ìˆ˜ì • ë° ìž¬ì‹¤í–‰

  SQL ë¬¸ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ì ì ˆí•œ ê¶Œí•œ ë¶€ì—¬

  ìœ ì €ì—ê²Œ ì„¤ì •í•œ quota ê°’ì„ ìˆ˜ì •

  í…Œì´ë¸”ìŠ¤íŽ˜ì´ìŠ¤ì— datafile ì¶”ê°€, resize, autoextend ì˜µì…˜ì„ ì„¤ì •

- User Process Failure
    - userê°€ ì„¸ì…˜ì—ì„œ ë¹„ì •ìƒì ì¸ ì—°ê²° í•´ì œë¥¼ ìˆ˜í–‰í•œ ê²½ìš° (ë¹„ì •ìƒì ì¸ ì¢…ë£Œ)

â–¶ï¸  **User Process Failure í•´ê²°**

pmon ë°±ê·¸ë¼ìš´ë“œ í”„ë¡œì„¸ìŠ¤ëŠ” ë¹„ì •ìƒì ì¸ ì¢…ë£Œëœ ìœ ì €ë¥¼ ê°ì§€í•œ í›„ ìœ ì €ê°€ ìž‘ì—…í•˜ê³  ìžˆë˜ transactionì„ rollback í•˜ê³  ë¦¬ì†ŒìŠ¤(lock) ë¥¼ í•´ì œí•œë‹¤.

- User Failure
    - ìœ ì €ê°€ í…Œì´ë¸”ì„ drop, truncate í•œ ê²½ìš°
    - ìœ ì €ê°€ í…Œì´ë¸”ì— ìžˆëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œ(delete)í•œ ê²½ìš°
    - ìœ ì €ê°€ ë°ì´í„°ë¥¼ ìž˜ëª» ìˆ˜ì •(update)í•œ ê²½ìš°

â–¶ï¸  **User Failure í•´ê²°**

ë°±ì—…ë³¸ì„ ê°€ì§€ê³  point in time recovery ë¥¼ í•´ì•¼í•œë‹¤. (ë¶ˆì™„ì „ ë³µêµ¬)

logminerë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¤ë¥˜ ì‹œê°„ì„ í™•ì¸

flashback ê¸°ëŠ¥ 

- Instance Failure
    - ì •ì „ìœ¼ë¡œ ì¸í•´ ì˜¤ë¼í´ ì„œë²„ê°€ ë‚´ë ¤ê°„ ê²½ìš°
    - shutdown abort
    - ì˜¤ë¼í´ì˜ í•„ìˆ˜ ë°±ê·¸ë¼ìš´ë“œ í”„ë¡œì„¸ìŠ¤ (DBWR, LGWR, PMON, SMON, CKPT) ì¤‘ í•˜ë‚˜ê°€ failureí•œ ê²½ìš°
    

â–¶ï¸  **Instance Failure í•´ê²°**

dbaëŠ” íŠ¹ë³„í•œ recovery ì¡°ì¹˜ë¥¼ í•  í•„ìš”ê°€ ì—†ë‹¤. ì¦‰ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ startup ì‹œí‚¤ë©´ smon ë°±ê·¸ë¼ìš´ë“œ í”„ë¡œì„¸ìŠ¤ê°€ instance recovery ìˆ˜í–‰í•œë‹¤.

ðŸŒ³ SMONì˜ ì—­í• 

- roll foward
- open
- rollback

- **ì‹œë‚˜ë¦¬ì˜¤**
    
    â–¶ï¸ **ì‹œë‚˜ë¦¬ì˜¤**
    
    1. Aë¼ëŠ” ìœ ì €ê°€ update ë¬¸ìž¥ ìˆ˜í–‰í•¨(undo1)
    
    ```sql
    -- 9:00
    UPDATE hr.emp
    SET sal = 200
    WHERE id = 100;
    ```
    
    1. parse- (bind ìƒëžµ) - execute ë‹¨ê³„ â†’ undo segments í• ë‹¹ , undo segment header blockì— transaction table slot (íŠ¸ëžœìž­ì…˜ ì •ë³´) ìƒì„±, transaction ëŒ€ìƒì´ ë˜ëŠ” ë¸”ë¡ì„ ë°ì´í„° ë²„í¼ ìºì‹œì— ì‹¤í–‰ ê³„íšì„ í†µí•´ì„œ ì°¾ëŠ”ë‹¤. (ITLì— íŠ¸ëžœìž­ì…˜ entry ìƒì„±, lock ìƒì„±)
    2. redo log buffer ì— redo entry ë§Œë“¤ìŒ (ì‹œê°„, ìœ ì €, í…Œì´ë¸”, rawid ì •ë³´, ì´ì „ê°’ ìƒˆë¡œìš´ ê°’ ì •ë³´, undo , undo segments í—¤ë” ë¸”ëŸ­ì— ëŒ€í•œ ì •ë³´)
    3. undo blockì— ê¸°ë¡ 
    4. ë°ì´í„° ë²„í¼ ìºì‹œ undoì— ê°’ì„ ì €ìž¥
    5. LGWR ê°€ current í•œ ë¦¬ë‘ ë¡œê·¸ íŒŒì¼ì— ë¦¬ë‘ ì—”íŠ¸ë¦¬ì˜ ê°’ì„ ê¸°ë¡í•¨. ì–¸ì œ? (commit, 1/3, ë³€ê²½ëŸ‰ 1m, 3ì´ˆë§ˆë‹¤, DBWR ë‚´ë ¤ì“°ê¸°ì „ì—)
    6. ë¦¬ë‘ ë¡œê·¸ ë²„í¼ clear
    7. ë””ìŠ¤í¬ undo ì— commit ì™„ë£Œ ë¸”ë¡ í—¤ë” í‘œì‹œí•´ ì¤Œ (ë©”ëª¨ë¦¬ì— undoëŠ” ë‚¨ì•„ìžˆì–´ ì—¬ìœ  ê³µê°„ ë‚¨ì•„ìžˆë‹¤ë©´ ë³´ìž¥) 
    8. Bë¼ëŠ” ìœ ì €ê°€ ì‚­ì œ ìž‘ì—…ì„ ì§„í–‰í•¨(undo2)
    
    ```sql
    -- 9:02
    DELETE FROM hr.emp WHERE id = 200;
    COMMIT; -- SCN ë²ˆí˜¸ í• ë‹¹ë°›ìŒ (í˜„ìž¬ SCN ë²ˆí˜¸ 2001 ë²ˆì´ë¼ê³  ê°€ì • - ë©”ëª¨ë¦¬, ë¦¬ë‘ ë¡œê·¸, undo)
            -- ì²´í¬ í¬ì¸íŠ¸ ì•„ì§ ë°œìƒí•˜ì§€ ì•Šì•„ì„œ ë©”ëª¨ë¦¬ì— ë”í‹° ë²„í¼ ë””ìŠ¤í¬ì— ë‚´ë ¤ê°€ì§€ ì•ŠìŒ.
            -- SCNì€ íŠ¸ëžœìž­ì…˜ ë‹¨ìœ„ë¡œ ì—…ë°ì´íŠ¸ ëœë‹¤. (ë°ì´í„° íŒŒì¼ í—¤ë” ë¸”ë¡ ë“±ì— ê¸°ë¡ë˜ì–´ ìžˆìŒ) 
    ```
    
    1. ë¡œê·¸ ë¼ì´í„°ê°€ ë¦¬ë‘ ë¡œê·¸ íŒŒì¼ì— ë¦¬ë‘ ì—”íŠ¸ë¦¬ë¥¼ ê¸°ë¡í•˜ëŠ”ë° current ë¦¬ë‘ ë¡œê·¸ íŒŒì¼ ê°€ë“ ì°¸
    
    â†’ ë¡œê·¸ ìŠ¤ìœ„ì¹˜ ë°œìƒ (partial checkpoint ë°œìƒ) â†’ ckptê°€ ì•Œë¦¼(current ë¦¬ë‘ ë¡œê·¸ íŒŒì¼ì„ ë””ìŠ¤í¬ë¡œ ë‚´ë¦¬ë¼ê³  ìš”ì²­) â†’ DBWRê°€ ìˆ˜í–‰ â†’ ë°ì´í„° ë²„í¼ ìºì‹œì˜ ë¶€ë¶„ dirty ë¸”ë¡ë“¤ clear 
    
     
    
    ðŸŒ³ thread check point : ë¦¬ë‘ì— ì†í•œ commitëœ dirty blockë“¤ì„ ë””ìŠ¤í¬ë¡œ ë‚´ë¦¬ëŠ” ìž‘ì—… 
    
    1. Cë¼ëŠ” ìœ ì €ê°€ ì—…ë°ì´íŠ¸ ìˆ˜í–‰í•¨ (undo3)
    
    ```sql
    UPDATE hr.emp
    SET sal = 3000
    WHERE id =300;
    ```
    
    1. ë¦¬ë‘ ì—”íŠ¸ë¦¬ ìƒì„±,ë°ì´í„° ë²„í¼ ìºì‹œì— ê¸°ì¡´ ê°’ ì €ìž¥, ìƒˆë¡œìš´ ê°’ ì €ìž¥ 
    
    ðŸŒ³ ë¦¬ë‘ ì—”íŠ¸ë¦¬ ì•ˆì—ëŠ” ì‹œê°„, ìœ ì €, í…Œì´ë¸”, rawid ì •ë³´, ì´ì „ê°’ ìƒˆë¡œìš´ ê°’ ì •ë³´, undo , undo segments í—¤ë” ë¸”ëŸ­ì— ëŒ€í•œ ì •ë³´  ì €ìž¥ë˜ì–´ ìžˆë‹¤.
    
    1. 9ì‹œ 4ë¶„ì— partial ì²´í¬í¬ì¸íŠ¸ê°€ ë°œìƒí–ˆë‹¤ê³  ê°€ì •
    2. ì²´í¬í¬ì¸íŠ¸ ì•ˆì—ëŠ” SCN : 2001 ë²ˆ ì „ì— commitì„ í–ˆë‹¤ëŠ” ì •ë³´, ì–´ë–¤ ë¦¬ë‘ ì—”íŠ¸ë¦¬ë¥¼ ì´ìš©í–ˆëŠ”ì§€, ë¦¬ë‘ ì •ë³´, ë¦¬ë‘ ê·¸ë£¹ ì •ë³´ ì €ìž¥ë˜ì–´ìžˆìŒ
    3. ì´ë•Œ instance failure ë°œìƒ (B commit ì •ë³´ ì•„ì§ ë””ìŠ¤í¬ë¡œ ë‚´ë¦¬ì§€ ì•Šê³ , CëŠ” ì•„ì§ íŠ¸ëžœìž­ì…˜ ì¤‘ì¼ ìƒíƒœì¼ë•Œ) 
    4. startup í•˜ë©´ nomount â–¶ï¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
    
                                    mount      â–¶ï¸  ì»¨íŠ¸ë¡¤ íŒŒì¼ì„ ì—¬ëŠ”ë° ì´ ì»¨íŠ¸ë¡¤ íŒŒì¼ ì•ˆì—ëŠ” ë§ˆì§€ë§‰ SCN (ì‹œê°„. ì²´í¬í¬ì¸íŠ¸ ì‹œì ) ì €ìž¥ë˜ì–´ìžˆê³ , ë¦¬ë‘ ì •ë³´ë„ ì €ìž¥ë˜ì–´ìžˆë‹¤.  í—¤ë”ëž‘ ë¹„êµí•´ì„œ ë³µêµ¬ (2000ê¹Œì§€ë§Œ ì €ìž¥ë˜ì–´ìžˆìœ¼ë‚˜ ë§ˆì§€ë§‰ ì²´í¬í¬ì¸íŠ¸ ë°œìƒ  2001ë¼ê³  ë¦¬ë‘ ë¡œê·¸ ë²„í¼ì— ë¦¬ë‘ ì—”íŠ¸ë¦¬ì— ì €ìž¥ë˜ì–´ìžˆìœ¼ë¯€ë¡œ ë³µêµ¬ : ë™ê¸°í™” ì²´í¬) 
    
    â–¶ï¸  smonì—ê²Œ ìš”ì²­ â†’ smonì´ ë¦¬ë‘ ì—”íŠ¸ë¦¬ ì°¸ê³ í•´ì„œ ë¸”ë¡ì—ë‹¤ê°€ ì ìš©í•˜ëŠ” ìž‘ì—…ì„ í•œë‹¤. (roll forward : ì»¤ë°‹ëœ ë¸”ë¡ì€ ì •í™•ížˆ commit ìž‘ì—…, commit ë˜ì§€ ì•Šì€ íŠ¸ëžœìž­ì…˜ ì§„í–‰ì¤‘ì´ì—ˆë˜ ë¸”ë¡ì€ ê°€ë§Œížˆ ë†”ë‘ê³  IREC  í‘œì‹œí•´ë‘ )  â†’ db open â†’ roll back ( íŠ¸ëžœìž­ì…˜ ì§„í–‰ì¤‘ì´ì—ˆë˜ ë¸”ë¡ rollback ìž‘ì—…ì„ í•¨) 
    
    ðŸ“ roll forward ìž‘ì—…ì´ ë³µêµ¬í•´ì•¼ë˜ëŠ” ë°ì´í„° ë§Žì„ ë•ŒëŠ” ì˜¤ëž˜ ê±¸ë¦´ ìˆ˜ ìžˆë‹¤. ì´ê±¸ ì œì–´í•  ìˆ˜ ìžˆëŠ” ê²ƒì´ incremental checkpoint 
    
- **ì„ ìƒë‹˜ ì •ë¦¬**
    
    **ì´ ì¼ë ¨ì˜ ìž‘ì—…ì€ ëª¨ë‘ ë©”ëª¨ë¦¬ì—ì„œ ì´ë£¨ì–´ì§„ë‹¤.**
    
    1ï¸âƒ£ datafileì´ ë™ê¸°í™” ë˜ì§€ ì•Šì€ ìƒíƒœ
    
    2ï¸âƒ£ roll forward ë‹¨ê³„ ì¤‘ì— ë§ˆì§€ë§‰ checkpoint ì´í›„ redo log fileì— ê¸°ë¡ëœ ëª¨ë“  ë³€ê²½ ì‚¬í•­ì´ datafile ì— ìž¬ì ìš©ëœë‹¤. ì´ ë‹¨ê³„ì—ì„œ undo ë˜ëŠ” rollback dataê°€ ë‹¤ì‹œ ìƒì„±ëœë‹¤.
    
    rollforward ë‹¨ê³„ì—ì„œ commitëœ ë°ì´í„°ì™€ commit ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ëª¨ë‘ datafileì— ìž‘ì„±í•œë‹¤.
    
    3ï¸âƒ£ datafileì—ëŠ” commitëœ ë³€ê²½ì‚¬í•­ê³¼ commitë˜ì§€ ì•Šì€ ë³€ê²½ ì‚¬í•­ì´ ëª¨ë‘ í¬í•¨ë˜ë©° ë°ì´í„°ë² ì´ìŠ¤ ë¥¼ open í•œë‹¤.
    
    4ï¸âƒ£ commit ë˜ì§€ ì•Šì€ ëª¨ë“  ë³€ê²½ ì‚¬í•­ì´ rollbackëœë‹¤.
    
    ðŸ“ IREC (ì¸ìŠ¤í„´ìŠ¤ ë¦¬ì»¤ë²„ë¦¬ ëŒ€ìƒ ë¸”ë¡) 
    

- Media Failure
    - ë””ìŠ¤í¬ ë“œë¼ì´ë¸Œì˜ í—¤ë“œê°€ ê³ ìž¥ë‚œ ê²½ìš°
    - ë°ì´í„° íŒŒì¼, ì»¨íŠ¸ë¡¤ íŒŒì¼, ë¦¬ë‘ë¡œê·¸ íŒŒì¼ì„ ë¬¼ë¦¬ì ìœ¼ë¡œ ì‚­ì œí•œ ê²½ìš°

â–¶ï¸  **Media Failure í•´ê²°**

ë°±ì—…ì„ ì´ìš©í•´ì„œ ë³µêµ¬ ìž‘ì—…ì„ ìˆ˜í–‰í•´ì•¼ í•œë‹¤.

## ðŸ“ Backup

1. ì˜¤ì „ 10ì‹œì— ë°±ì—…ì„ ë°›ì€ ì‹œì , scn : 1000ë²ˆ 
2. 12ì‹œ 15ë¶„ ìž¥ì• ë¡œ ì¸í•˜ì—¬ì„œ data file ì†ìƒ
3. Backup : ë¬¼ë¦¬ì ìœ¼ë¡œ ë¦¬ë‘ ë¡œê·¸ íŒŒì¼ì— ë³µì‚¬í•´ë‘” ê²ƒ
4. Recover :ë§ˆì§€ë§‰ ë°±ì—… ì´í›„ì— ë³€ê²½ ì •ë³´ (ë¦¬ë‘ ë¡œê·¸ íŒŒì¼ì— ì €ìž¥ëœ) ë³µêµ¬ ìž‘ì—…

ðŸŒ³ No Archive Mode : ë¦¬ë‘ ë¡œê·¸ íŒŒì¼ì´ ê°€ë“ì°¨ ì´ˆê¸°ì˜ ë°±ì—…ë³¸ì´ overwirte ë˜ì–´ ë¶ˆì™„ì „ ë³µêµ¬

## ðŸ“ Backup ëŒ€ìƒ íŒŒì¼

1ï¸âƒ£ ë°ì´í„° íŒŒì¼ **(í•„ìˆ˜)**

```sql
select name from v$datafile;
```

2ï¸âƒ£ ì»¨íŠ¸ë¡¤ íŒŒì¼ **(í•„ìˆ˜)**

```sql
select name from v$controlfile;
```

3ï¸âƒ£ ë¦¬ë‘ ë¡œê·¸ íŒŒì¼ (ì„ íƒ)

```sql
select member from v$logfile;
```

ðŸŒ³ ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë“œ í™•ì¸

```sql
select name, log_mode from v$database;
```

ðŸŒ³ sqlplus ëª…ë ¹ì–´ë¡œ í˜„ìž¬ ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë“œ í™•ì¸

```sql
SYS@ora19c> archive log list

Database log mode              No Archive Mode
Automatic archival             Disabled
Archive destination            USE_DB_RECOVERY_FILE_DEST
Oldest online log sequence     9
Current log sequence           11
```

## ðŸ“user managed backup ë° recovery

- ìš´ì˜ì²´ì œ ëª…ë ¹ìœ¼ë¡œ íŒŒì¼ ë°±ì—…
- ìš´ì˜ì²´ì œ ëª…ë ¹ìœ¼ë¡œ ë°±ì—… restore
- SQL ë° SQL*Plus ëª…ë ¹ìœ¼ë¡œ recovery

## ðŸ“ RMAN(Recovery Manager)

- ì˜¤ë¼í´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ backup, restore, recovery ìž‘ì—…ì„ ê´€ë¦¬í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©í•˜ëŠ” ì˜¤ë¼í´ ìœ í‹¸ë¦¬í‹°

## ðŸ“No Archive Mode

- ì¼ê´€ì„± ìžˆëŠ” ë°±ì—… ( consistent backup, closed backup, cold backup, offline backup)
- ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œí•œ í›„ ë°±ì—…ì„ ìˆ˜í–‰í•œë‹¤.
- full checkpoint
- shutdown normal | transactional | immediate
- Whole database backupì„ ìˆ˜í–‰í•œë‹¤. (ë°ì´í„° íŒŒì¼, ì»¨íŠ¸ë¡¤ íŒŒì¼, ë¦¬ë‘ë¡œê·¸ íŒŒì¼)

```sql
SYS@ora19c> select checkpoint_change# from v$database;

CHECKPOINT_CHANGE#
------------------
           2792541

SYS@ora19c> select checkpoint_change#, scn_to_timestamp(checkpoint_change#) from v$database;

CHECKPOINT_CHANGE#
------------------
SCN_TO_TIMESTAMP(CHECKPOINT_CHANGE#)
---------------------------------------------------------------------------
           2792541
14-JUL-25 04.26.36.000000000 PM

SYS@ora19c> alter system checkpoint;

System altered.

SYS@ora19c>  select checkpoint_change#, scn_to_timestamp(checkpoint_change#) from v$database;

CHECKPOINT_CHANGE#
------------------
SCN_TO_TIMESTAMP(CHECKPOINT_CHANGE#)
---------------------------------------------------------------------------
           2833584
14-JUL-25 11.18.49.000000000 PM

SYS@ora19c> select name,checkpoint_change# from v$datafile;

NAME
--------------------------------------------------------------------------------
CHECKPOINT_CHANGE#
------------------
/u01/app/oracle/oradata/ORA19C/system01.dbf
           2833584

/u01/app/oracle/oradata/ORA19C/sysaux01.dbf
           2833584

/u01/app/oracle/oradata/ORA19C/undotbs01.dbf
           2833584

NAME
--------------------------------------------------------------------------------
CHECKPOINT_CHANGE#
------------------
/u01/app/oracle/oradata/ORA19C/users01.dbf
           2833584

-- ë§ˆì§€ë§‰ ì²´í¬í¬ì¸íŠ¸ ì´í›„ ì •ë³´ëŠ” v$log ë·°ì—ì„œ ì¡°íšŒ ê°€ëŠ¥
SYS@ora19c> select * from v$log;

    GROUP#    THREAD#  SEQUENCE#      BYTES  BLOCKSIZE    MEMBERS ARC
---------- ---------- ---------- ---------- ---------- ---------- ---
STATUS           FIRST_CHANGE# FIRST_TIM NEXT_CHANGE# NEXT_TIME     CON_ID
---------------- ------------- --------- ------------ --------- ----------
         1          1         10  209715200        512          1 NO
INACTIVE               2661346 09-JUL-25      2767692 14-JUL-25          0

         2          1         11  209715200        512          1 NO
CURRENT                2767692 14-JUL-25   1.8447E+19                    0

         3          1          9  209715200        512          1 NO
INACTIVE               2527330 09-JUL-25      2661346 09-JUL-25          0

ðŸ“ ë§ˆì§€ë§‰ ì²´í¬í¬ì¸íŠ¸ : current í•œ ê·¸ë£¹ì— ì†í•´ ìžˆì„ ê²ƒ. 
```

ðŸ“ **logging vs nologging** 

```sql
SYS@ora19c> select tablespace_name, logging from dba_tablespaces;

TABLESPACE_NAME                LOGGING
------------------------------ ---------
SYSTEM                         LOGGING
SYSAUX                         LOGGING
UNDOTBS1                       LOGGING
TEMP                           NOLOGGING
USERS                          LOGGING

-- user í…Œì´ë¸”ìŠ¤íŽ˜ì´ìŠ¤ nologging ìœ¼ë¡œ ë³€ê²½
-- í…Œì´ë¸”ìŠ¤íŽ˜ì´ìŠ¤ ì•ˆì— í…Œì´ë¸” ë°ì´í„° ë³€ê²½ -> redo entry ìƒì„± x
SYS@ora19c> alter tablespace users nologging;

SYS@ora19c>  select tablespace_name, logging from dba_tablespaces;

TABLESPACE_NAME                LOGGING
------------------------------ ---------
SYSTEM                         LOGGING
SYSAUX                         LOGGING
UNDOTBS1                       LOGGING
TEMP                           NOLOGGING
USERS                          NOLOGGING
```

ðŸ“ **no archive mode ë°±ì—…** 

```sql
-- DB ì •ìƒ ì¢…ë£Œ
shutdown immediate

-- vi alert.log í•´ì„œ shutdown ë²ˆí˜¸ ì²´í¬
-- tail -F alert.log
  
[oracle@oracle ~]$ mkdir -p backup/noarch
[oracle@oracle ~]$ cd backup/noarch
[oracle@oracle noarch]$ cp -v /u01/app/oracle/oradata/ORA19C/*.* .
â€˜/u01/app/oracle/oradata/ORA19C/control01.ctlâ€™ -> â€˜./control01.ctlâ€™
â€˜/u01/app/oracle/oradata/ORA19C/redo01.logâ€™ -> â€˜./redo01.logâ€™
â€˜/u01/app/oracle/oradata/ORA19C/redo02.logâ€™ -> â€˜./redo02.logâ€™
â€˜/u01/app/oracle/oradata/ORA19C/redo03.logâ€™ -> â€˜./redo03.logâ€™
â€˜/u01/app/oracle/oradata/ORA19C/sysaux01.dbfâ€™ -> â€˜./sysaux01.dbfâ€™
â€˜/u01/app/oracle/oradata/ORA19C/system01.dbfâ€™ -> â€˜./system01.dbfâ€™
â€˜/u01/app/oracle/oradata/ORA19C/temp01.dbfâ€™ -> â€˜./temp01.dbfâ€™
â€˜/u01/app/oracle/oradata/ORA19C/undotbs01.dbfâ€™ -> â€˜./undotbs01.dbfâ€™
â€˜/u01/app/oracle/oradata/ORA19C/users01.dbfâ€™ -> â€˜./users01.dbfâ€™

â–¶ï¸ ì´ ë””ë ‰í† ë¦¬ì—  v$log ë„ ë„£ì–´ë†“ê¸°.
```

 1ï¸âƒ£ íŠ¹ì •í•œ ë°ì´í„° íŒŒì¼ì´ ì†ìƒë˜ì—ˆì„ ê²½ìš° ë³µêµ¬ (ë‹¨, ë°±ì—… ì´í›„ ë¦¬ë‘ ì •ë³´ê°€ ìžˆë‹¤.)

```sql
SYS@ora19c> create table hr.new(id number) tablespace users;

Table created.

SYS@ora19c> insert into hr.new(id) values(1);

1 row created.

SYS@ora19c> commit;

Commit complete.

SYS@ora19c> select * from hr.new;

        ID
----------
         1

SYS@ora19c> select * from v$log;

    GROUP#    THREAD#  SEQUENCE#      BYTES  BLOCKSIZE    MEMBERS ARC
---------- ---------- ---------- ---------- ---------- ---------- ---
STATUS           FIRST_CHANGE# FIRST_TIM NEXT_CHANGE# NEXT_TIME     CON_ID
---------------- ------------- --------- ------------ --------- ----------
         1          1         10  209715200        512          1 NO
INACTIVE               2661346 09-JUL-25      2767692 14-JUL-25          0

         2          1         11  209715200        512          1 NO
CURRENT                2767692 14-JUL-25   1.8447E+19                    0

         3          1          9  209715200        512          1 NO
INACTIVE               2527330 09-JUL-25      2661346 09-JUL-25          0

```

```sql
SYS@ora19c> SELECT f.file_name
  FROM dba_extents   e,
       dba_data_files f
 WHERE e.file_id      = f.file_id
   AND e.segment_name = 'NEW'
   AND e.owner        = 'HR';  2    3    4    5    6

FILE_NAME
--------------------------------------------------------------------------------
/u01/app/oracle/oradata/ORA19C/users01.dbf

shutdown immediate
! rm /u01/app/oracle/oradata/ORA19C/users01.dbf  -- ì‚­ì œë˜ì–´ì„œ

startup

SYS@ora19c> select status from v$instance; -- mounted ìƒíƒœê¹Œì§€ ì˜¬ë¼ì™”ë‹¤.

STATUS
------------
MOUNTED

-- ë¬¸ì œë˜ëŠ” ë°ì´í„° íŒŒì¼
SYS@ora19c> select * from v$recover_file;

     FILE# ONLINE  ONLINE_
---------- ------- -------
ERROR                                                                CHANGE#
----------------------------------------------------------------- ----------
TIME          CON_ID
--------- ----------
         7 ONLINE  ONLINE
FILE NOT FOUND                                                             0
                   0

-- ì™„ì „ ë³µêµ¬ê°€ ë˜ëŠ” ìƒíƒœì¸ì§€ ì²´í¬í•´ë³´ê¸° 
-- ê°€ìž¥ ìµœê·¼ì— ë°›ì•„ë‘” ë°±ì—…ë³¸ì„ ì°¾ì•„ì„œ restore
SYS@ora19c> !ls backup/noarch/users01.dbf
backup/noarch/users01.dbf

SYS@ora19c> !cp -v backup/noarch/users01.dbf /u01/app/oracle/oradata/ORA19C/
â€˜backup/noarch/users01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/users01.dbfâ€™

-- ì†ìƒëœ ë°ì´í„°íŒŒì¼ì´ ì†í•œ í…Œì´ë¸”ìŠ¤íŽ˜ì´ìŠ¤ ë ˆë²¨ë¡œ recovery
SYS@ora19c>  recover tablespace users;
Media recovery complete.

SYS@ora19c> alter database open;

Database altered.

SYS@ora19c> select status from v$instance;

STATUS
------------
OPEN

-- ë°±ì—… í›„ ìƒì„±í•œ í…Œì´ë¸”ë„ ë³µêµ¬ë¨. (ë¦¬ë‘ ì •ë³´ê°€ ìžˆê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•˜ë‹¤)
SYS@ora19c> select * from hr.new;

        ID
----------
         1
         
```

2ï¸âƒ£ íŠ¹ì •í•œ ë°ì´í„° íŒŒì¼ì´ ì†ìƒë˜ì—ˆì„ ê²½ìš° ë³µêµ¬ (ë‹¨, ë°±ì—… ì´í›„ ë¦¬ë‘ ì •ë³´ê°€ ìžˆë‹¤.) 2 

```sql
shutdown abort
[oracle@oracle noarch]$ cp -v *.* /u01/app/oracle/oradata/ORA19C/
â€˜control01.ctlâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/control01.ctlâ€™
â€˜redo01.logâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/redo01.logâ€™
â€˜redo02.logâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/redo02.logâ€™
â€˜redo03.logâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/redo03.logâ€™
â€˜sysaux01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/sysaux01.dbfâ€™
â€˜system01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/system01.dbfâ€™
â€˜temp01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/temp01.dbfâ€™
â€˜undotbs01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/undotbs01.dbfâ€™
â€˜users01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/users01.dbfâ€™
[oracle@oracle noarch]$ ls
control01.ctl  redo02.log  sysaux01.dbf  temp01.dbf     users01.dbf
redo01.log     redo03.log  system01.dbf  undotbs01.dbf

SYS@ora19c> startup
ORACLE instance started.

Total System Global Area  713027608 bytes
Fixed Size                  8900632 bytes
Variable Size             507510784 bytes
Database Buffers          188743680 bytes
Redo Buffers                7872512 bytes
Database mounted.
Database opened.
SYS@ora19c> select * from hr.new;
select * from hr.new
                 *
ERROR at line 1:
ORA-00942: table or view does not exist

SYS@ora19c> create table hr.new(id number) tablespace users;

Table created.

SYS@ora19c> insert into hr.new(id) values(1);

1 row created.

SYS@ora19c> commit ;

Commit complete.

SYS@ora19c> SELECT f.file_name
  FROM dba_extents   e,
       dba_data_files f
 WHERE e.file_id      = f.file_id
   AND e.segment_name = 'NEW'
   AND e.owner        = 'HR';  2    3    4    5    6

FILE_NAME
--------------------------------------------------------------------------------
/u01/app/oracle/oradata/ORA19C/users01.dbf

shutdown immediate
SYS@ora19c> ! rm /u01/app/oracle/oradata/ORA19C/users01.dbf

startup -- mount ìƒíƒœ
SYS@ora19c> select file#,name,status from v$datafile;

-- no archive modeì—ì„œ íŠ¹ì •í•œ ë°ì´í„° íŒŒì¼ì„ offline ëª¨ë“œë¡œ ìˆ˜í–‰í•  ê²½ìš° ê¼­ 
-- **offline drop**ìœ¼ë¡œ í•´ì•¼í•œë‹¤. 

alter database datafile 7 offline drop; -- ë¬¸ì œê°€ ë˜ëŠ” ë°ì´í„° íŒŒì¼ ë²ˆí˜¸ë¥¼ ëŒ€ì‹  ì¨ë„ ëœë‹¤.
Database altered.

SYS@ora19c> alter database open;

Database altered.

SYS@ora19c> select count(*) from hr.employees;

  COUNT(*)
----------
       107

-- ë°±ì—…ì„ ì°¾ì•„ì„œ restore ìž‘ì—…
SYS@ora19c> !ls backup/noarch/users01.dbf
backup/noarch/users01.dbf

SYS@ora19c> !cp -v backup/noarch/users01.dbf /u01/app/oracle/oradata/ORA19C/
â€˜backup/noarch/users01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/users01.dbfâ€™

-- ë°±ì—… ì´í›„ ë³€ê²½ëœ ì •ë³´ë¥¼ ì´ìš©í•´ì„œ ë³µêµ¬ ìž‘ì—…
recover datafile 7;

-- ë˜ëŠ”
recover tablespace users;

alter database datafile 7 online;

-- onlineìœ¼ë¡œ ì˜¬ë¼ì™”ëŠ”ì§€ í™•ì¸ 
SYS@ora19c> select file#, name, status from v$datafile;

SYS@ora19c> select * from hr.new;

        ID
----------
         1

```

3ï¸âƒ£ ë³µêµ¬

```sql
SYS@ora19c> create table hr.new(id number) tablespace users;

Table created.

SYS@ora19c> insert into hr.new(id) values(1);

1 row created.

SYS@ora19c> commit ;

Commit complete.

SYS@ora19c> select * from v$log;

SYS@ora19c> select checkpoint_change#, scn_to_timestamp(checkpoint_change#) from v$database;

CHECKPOINT_CHANGE#
------------------
SCN_TO_TIMESTAMP(CHECKPOINT_CHANGE#)
---------------------------------------------------------------------------
           2834609
14-JUL-25 11.43.14.000000000 PM

SYS@ora19c> select name, checkpoint_change# from v$datafile;

NAME
--------------------------------------------------------------------------------
CHECKPOINT_CHANGE#
------------------
/u01/app/oracle/oradata/ORA19C/system01.dbf
           2834609

/u01/app/oracle/oradata/ORA19C/sysaux01.dbf
           2834609

/u01/app/oracle/oradata/ORA19C/undotbs01.dbf
           2834609

NAME
--------------------------------------------------------------------------------
CHECKPOINT_CHANGE#
------------------
/u01/app/oracle/oradata/ORA19C/users01.dbf
           2834609

shutdown immediate

ORACLE instance shut down.
SYS@ora19c> ! rm /u01/app/oracle/oradata/ORA19C/users01.dbf

SYS@ora19c> startup
ORACLE instance started.

Total System Global Area  713027608 bytes
Fixed Size                  8900632 bytes
Variable Size             507510784 bytes
Database Buffers          188743680 bytes
Redo Buffers                7872512 bytes
Database mounted.
ORA-01157: cannot identify/lock data file 7 - see DBWR trace file
ORA-01110: data file 7: '/u01/app/oracle/oradata/ORA19C/users01.dbf'

SYS@ora19c> select * from v$recover_file;

     FILE# ONLINE  ONLINE_
---------- ------- -------
ERROR                                                                CHANGE#
----------------------------------------------------------------- ----------
TIME          CON_ID
--------- ----------
         7 ONLINE  ONLINE
FILE NOT FOUND                                                             0
                   0

SYS@ora19c> select file#, name, status from v$datafile;

     FILE#
----------
NAME
--------------------------------------------------------------------------------
STATUS
-------
         1
/u01/app/oracle/oradata/ORA19C/system01.dbf
SYSTEM

         3
/u01/app/oracle/oradata/ORA19C/sysaux01.dbf
ONLINE

     FILE#
----------
NAME
--------------------------------------------------------------------------------
STATUS
-------

         4
/u01/app/oracle/oradata/ORA19C/undotbs01.dbf
ONLINE

         7
/u01/app/oracle/oradata/ORA19C/users01.dbf

     FILE#
----------
NAME
--------------------------------------------------------------------------------
STATUS
-------
ONLINE

SYS@ora19c> alter database datafile 7 offline drop;

Database altered.

SYS@ora19c> alter database open;

Database altered.

SYS@ora19c> select count(*) from hr.employees;

  COUNT(*)
----------
       107

-- ì™„ì „ ë³µêµ¬ë¥¼ ìœ„í•´ ë°±ì—…ë³¸ì„ ì°¾ëŠ”ë‹¤. (ì†ìƒëœ ë°ì´í„°íŒŒì¼ ë°±ì—…ë³¸ì„ ì°¾ì•„ì„œ restore)

SYS@ora19c> !cp -v backup/noarch/users01.dbf /u01/app/oracle/oradata/ORA19C/
â€˜backup/noarch/users01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/users01.dbfâ€™

# ë°±ì—… ì´í›„ ë¦¬ë‘ì •ë³´ë¥¼ ì´ìš©í•´ì„œ ë³µêµ¬ìž‘ì—…ì„ ì‹œë„í–ˆì§€ë§Œ ë¦¬ë‘ ì •ë³´ê°€ ì—†ì–´ì„œ ì™„ì „ ë³µêµ¬ ì‹¤íŒ¨

SYS@ora19c> recover datafile 7
Media recovery start
ORA-00283: recovery session canceled due to errors
ORA-00280: change 3000383 for thread 1 is in sequence #15
ORA-00278: log file needed for recovery is:
  /u01/app/oracle/fast_recovery_area/ORA19C/archivelog/2025_07_15/o1_mf_1_15_%u_.arc
Specify log: {<RET>=suggested | filename | AUTO | CANCEL}

ORA-00308: cannot open archived log '/u01/app/oracle/fast_recovery_area/ORA19C/archivelog/2025_07_15/o1_mf_1_15_%u_.arc'
ORA-27037: unable to obtain file status
Linux-x86_64 Error: 2: No such file or directory
Additional information: 7

-- noarchive modeì—ì„œ ì™„ì „ ë³µêµ¬ ì‹¤íŒ¨ê°€ ë˜ë©´ ì»¨íŠ¸ë¡¤ íŒŒì¼, ë°ì´í„° íŒŒì¼, ë¦¬ë‘ ë¡œê·¸ íŒŒì¼ì„ restore í•´ì•¼ í•œë‹¤.
shutdown abort
[oracle@oracle noarch]$ cp -v *.* /u01/app/oracle/oradata/ORA19C/
â€˜control01.ctlâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/control01.ctlâ€™
â€˜redo01.logâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/redo01.logâ€™
â€˜redo02.logâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/redo02.logâ€™
â€˜redo03.logâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/redo03.logâ€™
â€˜sysaux01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/sysaux01.dbfâ€™
â€˜system01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/system01.dbfâ€™
â€˜temp01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/temp01.dbfâ€™
â€˜undotbs01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/undotbs01.dbfâ€™
â€˜users01.dbfâ€™ -> â€˜/u01/app/oracle/oradata/ORA19C/users01.dbfâ€™
[oracle@oracle noarch]$ ls
control01.ctl  redo02.log  sysaux01.dbf  temp01.dbf     users01.dbf
redo01.log     redo03.log  system01.dbf  undotbs01.dbf

SYS@ora19c> startup

```

4ï¸âƒ£ ë°±ì—… ë°›ì§€ ì•Šì€ í…Œì´ë¸”ìŠ¤íŽ˜ì´ìŠ¤ ì†ìƒ (ë¦¬ë‘ ì •ë³´ê°€ ìžˆì„ ê²½ìš°)

```sql
select tablespace_name, file_name from dba_data_files;

-- ìƒˆë¡œìš´ í…Œì´ë¸”ìŠ¤íŽ˜ì´ìŠ¤ ìƒì„±

create tablespace hr_tbs datafile '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf' size 10m;
select tablespace_name, file_name from dba_data_files;
select * from v$log;  -- ê°€ìž¥ ìµœê·¼ ì²´í¬ í¬ì¸íŠ¸  #2767692

SYS@ora19c> create table hr.new(id number) tablespace hr_tbs;

Table created.

SYS@ora19c> insert into hr.new(id) values(1);

1 row created.

SYS@ora19c> commit;

Commit complete.

SYS@ora19c> select * from hr.new;

        ID
----------
         1
         
-- ìž¥ì•  ìœ ë°œ
SYS@ora19c> ! ls /u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf
/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf

--íŒŒì¼ì´ ì†ìƒë¨ 
SYS@ora19c> ! rm /u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf

SYS@ora19c> ! ls /u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf
ls: cannot access /u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf: No such file or directory

select name, status from v$datafile;  -- ìš°ë¦¬ê°€ ë§Œë“  í…Œì´ë¸”ìŠ¤íŽ˜ì´ìŠ¤ ì‚¬ë¼ì§

-- ë¦¬ë‘ ì •ë³´ ì²´í¬í•´ë³´ê³ 
-- ê»ë°ê¸° ë°ì´í„° íŒŒì¼ì„ ìƒì„±í•´ì„œ ë¦¬ë‘ ì ìš© 

select * from v$log;

-- ëŒ€ìƒ ë°ì´í„° íŒŒì¼ì„ offlineìœ¼ë¡œ 
alter database datafile '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf' offline drop; -- ë¬¼ë¦¬ì ì¸ íŒŒì¼ ê²½ë¡œ ì ì–´ë„ ëœë‹¤.
select name, status from v$datafile;

NAME
--------------------------------------------------------------------------------
STATUS
-------
/u01/app/oracle/oradata/ORA19C/system01.dbf
SYSTEM

/u01/app/oracle/oradata/ORA19C/sysaux01.dbf
ONLINE

/u01/app/oracle/oradata/ORA19C/undotbs01.dbf
ONLINE

NAME
--------------------------------------------------------------------------------
STATUS
-------
/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf    -- recover ìƒíƒœ
**RECOVER**

/u01/app/oracle/oradata/ORA19C/users01.dbf
ONLINE

SYS@ora19c> ! ls /u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf
ls: cannot access /u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf: No such file or directory

-- ë¹ˆê»ë°ê¸° ë°ì´í„° íŒŒì¼ ìƒì„± 
SYS@ora19c> alter database create datafile '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf';

Database altered.

SYS@ora19c> ! ls /u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf
/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf

-- ìƒˆë¡­ê²Œ ìƒì„±ëœ ë°ì´í„° íŒŒì¼ì— ëŒ€í•´ì„œ ë¦¬ë‘ ì •ë³´ë¥¼ ì´ìš©í•´ì„œ ë³µêµ¬
SYS@ora19c> alter database recover datafile '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf';

Database altered.

SYS@ora19c> select name, status from v$datafile;

NAME
--------------------------------------------------------------------------------
STATUS
-------
/u01/app/oracle/oradata/ORA19C/system01.dbf
SYSTEM

/u01/app/oracle/oradata/ORA19C/sysaux01.dbf
ONLINE

/u01/app/oracle/oradata/ORA19C/undotbs01.dbf
ONLINE

NAME
--------------------------------------------------------------------------------
STATUS
-------
/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf  -- offlineìœ¼ë¡œ ë°”ë€œ
OFFLINE

/u01/app/oracle/oradata/ORA19C/users01.dbf
ONLINE

SYS@ora19c> alter database datafile '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf' online;

Database altered.

SYS@ora19c> select name, status from v$datafile;

NAME
--------------------------------------------------------------------------------
STATUS
-------
/u01/app/oracle/oradata/ORA19C/system01.dbf
SYSTEM

/u01/app/oracle/oradata/ORA19C/sysaux01.dbf
ONLINE

/u01/app/oracle/oradata/ORA19C/undotbs01.dbf
ONLINE

NAME
--------------------------------------------------------------------------------
STATUS
-------
/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf
ONLINE

/u01/app/oracle/oradata/ORA19C/users01.dbf
ONLINE

SYS@ora19c> select * from hr.new;

        ID
----------
         1

SYS@ora19c> SELECT f.file_name
  FROM dba_extents   e,
       dba_data_files f
 WHERE e.file_id      = f.file_id
   AND e.segment_name = 'NEW'
   AND e.owner = 'HR'  2    3    4    5    6
  7  ;

-- ë³µêµ¬ ì™„ë£Œ
FILE_NAME
--------------------------------------------------------------------------------
/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf

-- í…ŒìŠ¤íŠ¸ ë í…Œì´ë¸”ìŠ¤íŽ˜ì´ìŠ¤ ì‚­ì œ  
SYS@ora19c> drop tablespace hr_tbs including contents and datafiles;

Tablespace dropped.

```

5ï¸âƒ£ ë°±ì—…ë°›ì§€ ì•Šì€ ì†ìƒëœ íŒŒì¼ ë³µêµ¬ 2

```sql
-- ì›ë³µ ì•ˆí•¨.
select tablespace_name, file_name from dba_data_files;

-- ìƒˆë¡œìš´ í…Œì´ë¸”ìŠ¤íŽ˜ì´ìŠ¤ ìƒì„±

create tablespace hr_tbs datafile '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf' size 10m;
select tablespace_name, file_name from dba_data_files;
select * from v$log;  -- ê°€ìž¥ ìµœê·¼ ì²´í¬ í¬ì¸íŠ¸  #2767692

SYS@ora19c> create table hr.new(id number) tablespace hr_tbs;

Table created.

SYS@ora19c> insert into hr.new(id) values(1);

1 row created.

SYS@ora19c> commit;

Commit complete.

SYS@ora19c> select * from hr.new;

        ID
----------
         1
         
-- ë¡œê·¸ ìŠ¤ìœ„ì¹˜ ë§Žì´ ë°œìƒì‹œí‚´ : í…Œì´ë¸” ìŠ¤íŽ˜ì´ìŠ¤ ë¦¬ë‘ ì •ë³´ ì‚¬ë¼ì§€ë„ë¡ 
SYS@ora19c> alter system switch logfile;

-- ìž¥ì•  ìœ ë°œ
SYS@ora19c> ! ls /u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf
/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf

--íŒŒì¼ì´ ì†ìƒë¨ 
SYS@ora19c> ! rm /u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf

-- offlineìœ¼ë¡œ ë‚´ë¦¬ê¸°
alter database datafile '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf' offline drop;

-- ë¹ˆê»ë°ê¸° ë°ì´í„° íŒŒì¼ ìƒì„± 
SYS@ora19c> alter database create datafile '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf';

-- ë³µêµ¬ ìž‘ì—… ì‹¤íŒ¨: í…Œì´ë¸”ìŠ¤íŽ˜ì´ìŠ¤ ìƒì„± ì‹œì ë¶€í„° í˜„ìž¬ê¹Œì§€ ë¦¬ë‘ì •ë³´ë¥¼ ì´ìš©í•´ì„œ ë³µêµ¬ ìž‘ì—…ì„ ì‹œë„í–ˆì§€ë§Œ ë³µêµ¬ ì‹¤íŒ¨
alter database recover datafile '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf';

ERROR at line 1:
ORA-00279: change 2838783 generated at 07/15/2025 02:21:42 needed for thread 1
ORA-00289: suggestion :
/u01/app/oracle/fast_recovery_area/ORA19C/archivelog/2025_07_15/o1_mf_1_11_%u_.a
rc
ORA-00280: change 2838783 for thread 1 is in sequence #11

-- â–¶ï¸ ì´ ë…€ì„ì€ ì‚´ë¦´ ìˆ˜ ìžˆëŠ” ë°©ë²• ì—†ìŒ.
-- â–¶ï¸ ë¬¸ì œê°€ ìƒê¸´ í…Œì´ë¸” ìŠ¤íŽ˜ì´ìŠ¤.. ì§€ê¸ˆì€ ì˜¨ë¼ì¸ìœ¼ë¡œ ì˜¬ë¦´ ìˆ˜ë„ ì—†ê³  ì‚­ì œë„ ì•ˆë¨

-- online x 
SYS@ora19c> alter database datafile '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf' online;
alter database datafile '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf' online
*
ERROR at line 1:
ORA-01113: file 5 needs media recovery
ORA-01110: data file 5: '/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf'

-- ì‚­ì œ x 
SYS@ora19c> drop tablespace hr_tbs including contents and datafiles;
drop tablespace hr_tbs including contents and datafiles
*
ERROR at line 1:
ORA-01156: recovery or flashback in progress may need access to files

-- ì´ëŸ´ ê²½ìš° ë””ë¹„ë¥¼ ê»ë‹¤ í‚¤ê³ , í™•ì¸ í›„ ë‹¤ì‹œ ì‚­ì œ ì‹œë„
SYS@ora19c> shutdown immediate
Database closed.
Database dismounted.
ORACLE instance shut down.
SYS@ora19c> startup
ORACLE instance started.

Total System Global Area  713027608 bytes
Fixed Size                  8900632 bytes
Variable Size             507510784 bytes
Database Buffers          188743680 bytes
Redo Buffers                7872512 bytes
Database mounted.
Database opened.
SYS@ora19c> select name, status from v$datafile;

NAME
--------------------------------------------------------------------------------
STATUS
-------
/u01/app/oracle/oradata/ORA19C/system01.dbf
SYSTEM

/u01/app/oracle/oradata/ORA19C/sysaux01.dbf
ONLINE

/u01/app/oracle/oradata/ORA19C/undotbs01.dbf
ONLINE

NAME
--------------------------------------------------------------------------------
STATUS
-------
/u01/app/oracle/oradata/ORA19C/hr_tbs01.dbf
RECOVER

/u01/app/oracle/oradata/ORA19C/users01.dbf
ONLINE

SYS@ora19c> drop tablespace hr_tbs including contents and datafiles;

Tablespace dropped.

```