---
title: "[33ì¼ì°¨] ì•”ì‹œì  ì»¤ì„œ2 "
excerpt: "ì•„ì´í‹°ìœŒ 0609_(1) "
categories:
      - ORACLE11g
tags:
      - ORACLE11g
      - TIL
last-modified-at: 2025-06-09T18:15
---

# ì•”ì‹œì  ì»¤ì„œ - (2)

â–¶ï¸  index by table(ì—°ê´€ ë°°ì—´) ì‚¬ìš© ì´ìœ 

- ë°°ì—´ ì•ˆì— ê°’ë“¤ì„ ì§‘ì–´ ë„£ì–´ ì‹¤í–‰ ê³„íšì„ sharing í•˜ê¸° ìœ„í•´ì„œ

```sql
-- ì•„ë˜ ì²˜ëŸ¼ ìƒìˆ˜ê°€ ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ì‹¤í–‰ ê³„íšì„ ê·¸ë•Œë§ˆë‹¤ ì„¸ìš°ê²Œ ëœë‹¤.
UPDATE hr.employees
SET salary = salary * 1.1
WHERE employee_id = 100;

UPDATE hr.employees
SET salary = salary * 1.1
WHERE employee_id = 102;

UPDATE hr.employees
SET salary = salary * 1.1
WHERE employee_id = 200;

-- ë„£ì–´ì•¼í•  ê°’ì„ ì•ˆë‹¤ë©´ ì´ë¥¼ ë°°ì—´ì— ë„£ì–´ì„œ ì‹¤í–‰ ê³„íšì´ sharingë˜ê²Œ í•˜ì.

--UPDATE hr.employees
--SET salary = salary * 1.1
--WHERE employee_id = 1ì°¨ì› ë°°ì—´ (ë‹¨ì¼ ë°ì´í„° íƒ€ì…)
-- ex) 1 - 100 , 2 - 102 , 3 - 200

DECLARE
    TYPE table_id_type IS TABLE OF number INDEX BY pls_integer;
    v_tab table_id_type;
BEGIN
    v_tab(1) := 100;
    v_tab(2) := 102;
    v_tab(3) := 103;
    
    UPDATE hr.employees
    SET salary = salary * 1.1
    WHERE employee_id = v_tab(1);
    
    UPDATE hr.employees
    SET salary = salary * 1.1
    WHERE employee_id = v_tab(1);
    
    UPDATE hr.employees
    SET salary = salary * 1.1
    WHERE employee_id = v_tab(1);
    
    ROLLBACK;
END;
/

-- UPDATE ë¬¸ì„ í•œ ë²ˆë§Œ ì“°ì
DECLARE
    TYPE table_id_type IS TABLE OF number INDEX BY pls_integer;
    v_tab table_id_type;
BEGIN
    v_tab(1) := 100;
    v_tab(2) := 102;
    v_tab(3) := 103;
    
    FOR i IN v_tab.first..v_tab.last LOOP
        UPDATE hr.employees
        SET salary = salary * 1.1
        WHERE employee_id = v_tab(i);
    END LOOP;
    
    ROLLBACK;
END;
/
```

â–¶ï¸ Exeception ë°œìƒ ê²½ìš° : ì˜¤ë¥˜ ë‚œë‹¤.

```sql
DECLARE
    TYPE table_id_type IS TABLE OF number INDEX BY pls_integer;
    v_tab table_id_type;
BEGIN
     v_tab(1) := 100;
     v_tab(2) := 102;
     v_tab(3) := 103;
     v_tab(5) := 200; 
    
    FOR i IN v_tab.first..v_tab.last LOOP
        UPDATE hr.employees
        SET salary = salary * 1.1
        WHERE employee_id = v_tab(i);
    END LOOP;
    
    -- ROLLBACK; ëª…ì‹œí•˜ì§€ ì•Šì•˜ë”ë¼ë„ í”„ë¡œê·¸ë¨ì´ ë¹„ì •ìƒì ìœ¼ë¡œ 
    -- ì¢…ë£Œë˜ì—ˆê¸°ë•Œë¬¸ì— ìë™ ROLLBACKëœë‹¤. 
END;
/
```

â–¶ï¸ exists() ì‚¬ìš©í•˜ê¸°

ğŸ“Œ ì—°ê´€ ë°°ì—´.exists(ì¸ë±ìŠ¤) : íŠ¹ì • ì¸ë±ìŠ¤ì˜ ìš”ì†Œê°€ ì—°ê´€ ë°°ì—´ì— ì¡´ì¬í•˜ë©´ TRUE, ì•„ë‹ˆë©´ FALSE ë°˜í™˜ 

```sql
DECLARE
    TYPE table_id_type IS TABLE OF number INDEX BY pls_integer;
    v_tab table_id_type;
BEGIN
    v_tab(1) := 100;
    v_tab(2) := 102;
    v_tab(3) := 103;
    v_tab(5) := 200; 
    
    FOR i IN v_tab.first..v_tab.last LOOP
     IF v_tab.exists(i) THEN
        UPDATE hr.employees
        SET salary = salary * 1.1
        WHERE employee_id = v_tab(i);
     ELSE
        dbms_output.put_line(i||' ìš”ì†Œ ë²ˆí˜¸ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
     END IF;
    END LOOP;
    ROLLBACK;

END;
/

```