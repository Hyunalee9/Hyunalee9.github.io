---
title: "[76ì¼ì°¨] LRU ì•Œê³ ë¦¬ì¦˜ "
excerpt: "ì•„ì´í‹°ìœŒ 0812_(2)"
categories:
      - ORACLE11g
tags:
      - ORACLE11g
      - TIL
last-modified-at: 2025-08-12T21:08
---

# LRU ì•Œê³ ë¦¬ì¦˜

ğŸ“ working set : ë²„í¼ ìºì‹œë¥¼ ê´€ë¦¬

â–¶ï¸ LRU ( Least Recently Used) list

- ê°€ì¥ ìµœê·¼ì— ì‚¬ìš©ë˜ê±°ë‚˜ ì‚¬ìš©í•˜ì§€ ì•Šì€ ë²„í¼ë“¤ì˜ ë¦¬ìŠ¤íŠ¸
- free buffer, ì‚¬ìš© ì¤‘ì´ê±°ë‚˜ ì‚¬ìš©ëœ ë²„í¼, ì•„ì§ LRUW ë¦¬ìŠ¤íŠ¸ë¡œ ì˜®ê²¨ì§€ì§€ ì•Šì€ dirty buffer(ë³€ê²½ëœ ë¸”ëŸ­)
- ë©”ì¸ ë¦¬ìŠ¤íŠ¸ : ì‚¬ìš©ëœ ë²„í¼ë“¤ì˜ ë¦¬ìŠ¤íŠ¸
- ë³´ì¡° ë¦¬ìŠ¤íŠ¸ : free buffer list , ë¯¸ì‚¬ìš©ëœ buffer, dbwrì— ì˜í•´ ê¸°ë¡ëœ ë²„í¼ë“¤ì˜ ëŒ€í•œ ë¦¬ìŠ¤íŠ¸

â–¶ï¸ LRUW (Least Recently Used Write) list 

- ì•„ì§ ë””ìŠ¤í¬ë¡œ ê¸°ë¡ë˜ì§€ ì•Šì€ ë³€ê²½ëœ buffer(dirty buffer) ë“¤ì„ ê´€ë¦¬í•˜ëŠ” ë¦¬ìŠ¤íŠ¸
- dirty list ë¼ê³ ë„ ë¶€ë¥¸ë‹¤.
- ë©”ì¸ ë¦¬ìŠ¤íŠ¸  : ë³€ê²½ëœ buffer ë“¤ì˜ ë¦¬ìŠ¤íŠ¸
- ë³´ì¡° ë¦¬ìŠ¤íŠ¸ : í˜„ì¬ dbwrì— ì˜í•´ ê¸°ë¡ì¤‘ì¸ ë²„í¼ë“¤ì˜ ë¦¬ìŠ¤

â–¶ï¸ ë¬¼ë¦¬ì  I/O ë°œìƒí•˜ë©´ cache buffers lru chain latch íšë“í•´ì•¼ í•œë‹¤.

ì´ë•Œ ê²½í•©ì´ ë°œìƒí•˜ë©´ latch : cache buffers lru chain ì´ë²¤íŠ¸ ë°œìƒí•œë‹¤.

ğŸ“ cache buffers lru chain latch tn

```sql
select count(*) from v$latch_children where name = 'cache buffers lru chain';
```

![image.png](/assets/20250812/9.png)

â–¶ï¸ 36ì´ë”ë¼ë„ ì‹¤ì œ ìˆ˜ëŠ” ë‹¤ë¥´ë‹¤.  â†’ hidden íŒŒë¼ë¯¸í„° : 18ê°œ 

```sql
select a.ksppinm parameter, b.ksppstvl value
from x$ksppi a, x$ksppcv b
where a.indx = b.indx
and a.ksppinm = '_db_block_lru_latches';
```

![image.png](/assets/20250812/10.png)

```sql
select a.bp_blksz,       
       c.child#,       
       a.bp_name,       
       c.gets,      
       c.MISSES,      
       c.SLEEPS    
  from x$kcbwbpd a, x$kcbwds b, v$latch_children c 
  where b.set_id between a.bp_lo_sid and a.bp_hi_sid   
  and c.addr = b.set_latch order by 1,2;
```

![image.png](/assets/20250812/11.png)

```sql
-- touch count ì¦ê°€ ì£¼ê¸° ì‹œê°„, touch count ì¦ê°€ëŠ” 3ì´ˆ í›„ì— ë‹¤ì‹œ accessë¥¼ í•˜ê²Œ ë˜ë©´ touch count 1ì”© ì¦ê°€
select a.ksppinm parameter, b.ksppstvl value
from x$ksppi a, x$ksppcv b
where a.indx = b.indx
and a.ksppinm = '_db_aging_touch_time';

/*
_db_aging_touch_time	3(ì´ˆ)
*/

-- touch count ê°’ì´ 2ì´ìƒì¸ bufferë¥¼ ë§Œë‚˜ë©´ hot region ì œì¼ ì•ìœ¼ë¡œ ì˜®ê²¨ì§€ëŠ” ê¸°ì¤€
select a.ksppinm parameter, b.ksppstvl value
from x$ksppi a, x$ksppcv b
where a.indx = b.indx
and a.ksppinm = '_db_aging_hot_criteria';
```

![image.png](/assets/20250812/12.png)

```sql
select a.ksppinm parameter, b.ksppstvl value
from x$ksppi a, x$ksppcv b
where a.indx = b.indx
and a.ksppinm = '_db_block_max_scan_pct';
```

![image.png](/assets/20250812/13.png)

â–¶ï¸ LRU LISTì—ì„œ free bufferë¥¼ 40% scan

â–¶ï¸ LRU LISTì—ì„œ free bufferë¥¼ 40% scanì„ í•˜ê³ ë„ í”„ë¦¬ ë²„í¼ë¥¼ ì°¾ì§€ ëª»í•˜ë©´ DBWRì—ê²Œ dirty bufferë¥¼ íŒŒì¼ì— ê¸°ë¡í•˜ê³  free  bufferë¥¼ í™•ë³´í•´ì¤„ ê²ƒì„ ìš”ì²­í•œë‹¤. 

â–¶ï¸ DBWRê°€ free buffer ê°€ í™•ë³´ë  ìˆ˜ ìˆë‹¤ ì´ë•Œê¹Œì§€ free buffer ì´ë²¤íŠ¸ê°€ ë°œìƒí•œë‹¤.