---
title: "ê¸€ ì‘ì„±, ì‚¬ì§„ ì²¨ë¶€, ì‚­ì œ, ìˆ˜ì •í•˜ê¸° ê¸°ëŠ¥ ë§Œë“¤ê¸°"
excerpt: "ë””ìŠ¤íŒ¨ì²˜ ì¨ë³´ê¸°, ì„¸ì…˜ì„ ì´ìš©í•´ì„œ íšŒì›ë“¤ë§Œ ê¸°ëŠ¥ ì‚¬ìš©í•˜ê²Œ í•˜ê¸°"
categories:
    - JAVA
tags :
    - JAVA
    - JSP
    - HTML
    - TIL
last-modified-at: 2021-07-07 T16:48
---

2021ì›” 07ì›” 06ì¼ ì–´ì œëŠ”, ë¡œê·¸ì¸ í•œ íšŒì›ë§Œ ê¸€ì“°ê¸°, ì‚­ì œí•˜ê¸° ê¸°ëŠ¥ë“±ì— ëŒ€í•œ ê¶Œí•œì´ ìˆë„ë¡
Sessionì„ ì´ìš©í•˜ëŠ” ë°©ë²•ì„ ê³µë¶€í–ˆë‹¤.

ì˜¤ëŠ˜ì€, ìˆ˜ì •í•˜ê¸° ê¸°ëŠ¥ì„ êµ¬í˜„í•´ë³´ì•˜ë‹¤.
Dispacherê¸°ëŠ¥ë„ ì‚¬ìš©í•´ë³´ì•˜ë‹¤.

[ê·¸ë°–ì˜ ê¸°ëŠ¥]
1. ë¡œê·¸ì¸í•˜ì§€ ì•Šìœ¼ë©´, ê¸€ ìƒì„¸ë³´ê¸°ë¥¼ í•  ìˆ˜ ì—†ë‹¤.
2. íšŒì›ì€ ìì‹ ì´ ì“´ ê¸€ì— ëŒ€í•´ì„œë§Œ ì‚­ì œ, ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.
3. ê¸€ ì‘ì„±, ìˆ˜ì • êµ¬ê°„ì— summernoteë¥¼ ë¶ˆëŸ¬ì™€ íšŒì›ë“¤ì´ ì´ë¥¼ ì´ìš©í•˜ì—¬ ê¸€ì„ ì‘ì„±í•  ìˆ˜ ìˆê²Œ í–ˆë‹¤.
4. ê¸€ì„ ì‘ì„±í•  ë•Œ íšŒì›ì€ ì‚¬ì§„íŒŒì¼ì„ ì²¨ë¶€í•  ìˆ˜ ìˆë‹¤.(ì²¨ë¶€í•œ íŒŒì¼ì€ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë¨)
5. ê¸€ ì œëª©ì´ ì—†ê±°ë‚˜, ë‚´ìš©ì´ ì—†ì„ ê²½ìš° ë”ë¶ˆì–´ ì¼ì • ê¸¸ì´(5)ë¥¼ ë„˜ê¸°ì§€ ëª»í•˜ë©´ ê¸¸ê²Œ ì¨ë‹¬ë¼ê³  alertê°€ ëœ¬ë‹¤.
6. ê²Œì‹œíŒ ê¸€ ì œëª©ì´ 15ìê°€ ë„˜ì–´ê°€ë©´, 15ì ê¹Œì§€ë§Œ ë³´ì—¬ì£¼ê³  ê·¸ ë’¤ì—ëŠ” "ÂºÂºğŸ‘€" ê°€ ë¶™ëŠ”ë‹¤.

```java
//Delete.java
package com.hyunalee.web;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import com.hyunalee.dao.BoardDAO;

@WebServlet("/delete")
public class Delete extends HttpServlet {
	private static final long serialVersionUID = 1L;


    public Delete() {
        super();

    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    	HttpSession session = request.getSession();
    	//bnoì •í™•í•´ì•¼ í•˜ê³ 
    	//ë¡œê·¸ì¸ í•œ ì‚¬ìš©ì
    	//sql = DELETE FROM í…Œì´ë¸”ëª… WHERE ì¡°ê±´=ê°’ AND ì¡°ê±´=ê°’

    	if(request.getParameter("bno") == null
    			|| Util.str2Int2(request.getParameter("bno")) == 0
    			|| session.getAttribute("id") == null
    			|| session.getAttribute("name") == null) {
    		//bnoê°€ ì•ˆ ì˜¤ê±°ë‚˜, bnoê°€ ìˆ«ìê°€ ì•„ë‹ˆê±°ë‚˜
    		//idì™€ nameì´ ì—†ìœ¼ë©´ ë¡œì§ ì‹¤í–‰ ëª»í•˜ê²Œ ë§‰ìŒ
    	}else {    		
    		int bno = Util.str2Int(request.getParameter("bno"));
    		//System.out.println(bno);
    		String id = (String) session.getAttribute("id");

    		BoardDAO dao = new BoardDAO();
    		int result = dao.delete(bno, id);
    		if(result == 1) {
    			//ì •ìƒ ì‚­ì œ
    			response.sendRedirect("success.jsp");
    		}else {
    			//ì‚­ì œ ì‹¤íŒ¨
    			response.sendRedirect("fail.jsp");
    		}
    	}

	}

	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	}

}
```

```java
//Update.java
package com.hyunalee.web;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import com.hyunalee.dao.BoardDAO;
import com.hyunalee.dto.BoardDTO;

@WebServlet("/update")
public class Update extends HttpServlet {
	private static final long serialVersionUID = 1L;
       BoardDAO dao;

    public Update() {
        super();
        dao = new BoardDAO();

    }


	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	response.setContentType("text/html;charset=UTF-8");
	HttpSession session = request.getSession();
    if(session.getAttribute("id")!= null && request.getParameter("bno")!= null
    		&& Util.str2Int2(request.getParameter("bno")) !=0) {
		// ë¡œê·¸ì¸ í•œ ìƒíƒœì´ê³ , bnoê°€ ìˆ«ìì¸ ìƒíƒœ
		// bnoì˜¤ëŠ”ì§€ í™•ì¸
		int bno = Util.str2Int(request.getParameter("bno"));
		String id =(String) session.getAttribute("id");
//		System.out.println("ì˜¤ëŠ” ë°ì´í„°ëŠ” : " + bno);
		// bnoë¥¼ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ë³´ë‚´ì„œ ê¸€ ì–»ì–´ì˜¤ê¸°
		BoardDTO dto = dao.update(bno,id);
		// í™”ë©´ì— ì¶œë ¥
//		System.out.println(dto.getBno());
//		System.out.println(dto.getBtitle());
//		System.out.println(dto.getBcontent());
////		System.out.println(dto.getId());
		if(dto != null) {
			//ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë¦¬í„´ëœ ê°ì²´ê°€ ìˆë‹¤ë©´ í™”ë©´ê·¸ë¦¬ê¸°
			//ë””ìŠ¤íŒ¨ì¹˜
			//ë””ìŠ¤íŒ¨ì¹˜ë¥¼ ì“°ë©´ , update.jspí™”ë©´ì¸ë°, update?=bnoì´ëŸ°ì‹ìœ¼ë¡œ ì£¼ì†Œí™”ë©´ ëœ¸
			RequestDispatcher dispatcher = request.getRequestDispatcher("./update.jsp");
			request.setAttribute("dto", dto); //ê°’ ì „ë‹¬
			dispatcher.forward(request, response);

		} else {
			//ì—ëŸ¬ë¡œ ë³´ë‚´ê¸°
			response.sendRedirect("error.jsp?errer=5505");
		}

	}else {
		//ë¡œê·¸ì¸ í•˜ì§€ ì•Šì•˜ê±°ë‚˜, bnoê°€ ì—†ê±°ë‚˜, bnoê°€ ìˆ«ìê°€ ì•„ë‹Œ ê²½ìš°
		//ì—ëŸ¬ë¡œ ë³´ë‚´ê¸°
		response.sendRedirect("error.jsp");
	}
}

	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		//controller
		//ê¸€ ìˆ˜ì • -> servlet(get) -> update.jsp
		//update.jsp -> servlet(post) -> board.jsp
	//esponse.setContentType("text/html;charset=UTF-8"); //í•œê¸€ ì²˜ë¦¬
		request.setCharacterEncoding("UTF-8");

//		int bno = Util.str2Int(request.getParameter("bno"));
//		System.out.println(title);
//		System.out.println(content);
		//ifë¬¸ìœ¼ë¡œ

		request.setCharacterEncoding("UTF-8");
		HttpSession session = request.getSession();

		if (request.getParameter("title") != null
				&& request.getParameter("content") != null
				&& request.getParameter("bno") != null
				&& Util.str2Int2(request.getParameter("bno")) != 0
		        && session.getAttribute("id") != null
		        && session.getAttribute("name") != null ){
		//ëª¨ë“  ë°ì´í„°ê°€ ë‹¤ ë“¤ì–´ì˜¨ë‹¤.
			String title = request.getParameter("title");
			String content = request.getParameter("content");
			int bno = Util.str2Int(request.getParameter("bno"));

			//ë°ì´í„°ë² ì´ìŠ¤ë¡œ ë³´ë‚´ê¸°
			BoardDTO dto = new BoardDTO();
			dto.setBno(bno);
			dto.setBtitle(title);
			dto.setBcontent(content);
			dto.setId((String) session.getAttribute("id"));
			//DAO DTO
			dao.update2(dto);
			//í˜ì´ì§€ ì´ë™
			response.sendRedirect("./detail.jsp?bno="+bno);

		}else {
			response.sendRedirect("./error.jsp");
		}


	}

}
```

```java
//BoardDAO - delete method
public int delete(int bno, String id) {
		int result = 0;
		Connection conn = DBConnection.dbConn();
		PreparedStatement pstmt = null;
		String sql = "DELETE FROM board WHERE bno=? "
				+ "AND no=(SELECT no FROM login WHERE id=?)";

		try {
			pstmt = conn.prepareStatement(sql);
			pstmt.setInt(1, bno);
			pstmt.setString(2, id);
			result = pstmt.executeUpdate();
			System.out.println(result + " !!!!!");
		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			try {
				if(pstmt != null) {pstmt.close();}
				if(conn != null) {conn.close();}
			} catch (SQLException e) {
				e.printStackTrace();
			}
		}

		return result;
	}
```

```java
//BoardDAO - update method
public BoardDTO update(int bno, String id) {
		BoardDTO dto = null;
		//conn = dbConn()
		Connection conn = DBConnection.dbConn();
		//pstmt
		PreparedStatement pstmt = null;
		//resultSet
		ResultSet rs = null;
		//sql detailê³¼ í¡ì‚¬í•˜ì§€ë§Œ +noê°€ ë“¤ì–´ê°„ë‹¤
		String sql = "SELECT * FROM board WHERE bno=? AND no=(SELECT no FROM login WHERE id=?)";

		try {
			pstmt = conn.prepareStatement(sql);
			pstmt.setInt(1, bno);
			pstmt.setString(2, id);
			rs = pstmt.executeQuery();
			while (rs.next()) {
				dto = new BoardDTO();
				dto.setBno(rs.getInt("bno"));//ìˆ˜ì •í•œ ìì‹ ì˜ ê¸€ë¡œ ëŒì•„ê°€ê¸°ìœ„í•´
				dto.setBtitle(rs.getString("btitle"));
				dto.setBcontent(rs.getString("bcontent"));
				//dto.setId(rs.getString("id"));//ì—†ì–´ë„ ë˜ê² ì§€ë§Œ ê°€ì ¸ê°„ë‹¤
			}

		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			try {
				if(rs != null) {rs.close();}
				if(pstmt != null) {pstmt.close();}
				if(conn != null) {conn.close();}
			} catch (SQLException e) {
				e.printStackTrace();
			}
		}

		return dto;
	}
```

```java
//BoardDAO - update2 method
public void update2(BoardDTO dto) {
		Connection conn = DBConnection.dbConn();
		PreparedStatement pstmt = null;
		String sql ="UPDATE board SET btitle=?,bcontent=? WHERE bno=? AND no=(SELECT no FROM login WHERE id=?)";

		try {
			pstmt = conn.prepareStatement(sql);
			pstmt.setString(1, dto.getBtitle());
			pstmt.setString(2,dto.getBcontent());
			pstmt.setInt(3, dto.getBno());
			pstmt.setString(4, dto.getId());
			pstmt.execute(); //select ì œì™¸í•œ ë‚˜ë¨¸ì§€
//			pstmt.executeQuery(); //select
//			pstmt.executeUpdate(); //ì˜í–¥ë°›ì€ í–‰ì´ ëª‡ ê°œ ì¸ì§€... ë¦¬í„´ íƒ€ì… int

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} finally {
			try {
				if(pstmt != null) {pstmt.close();}
				if(conn != null) {conn.close();}
			} catch (SQLException e) {

				e.printStackTrace();
			}
		}

	}
```

### **ê¸°ì¡´ íŒŒì¼ ìˆ˜ì •ëœ ë¶€ë¶„**

```jsx
//detail.jsp
<script>
function update(bno){
//alert("ìˆ˜ì •");
	if(confirm("ìˆ˜ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ")){
		location.href="update?bno="+bno;
	}
}
function del(bno){
//alert("ì‚­ì œ");
if(confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ")){
	alert("ì‚­ì œí•©ë‹ˆë‹¤.");
	location.href="delete?bno="+bno;
}
}
</script>

<body>
<%
	 if (session.getAttribute("id") != null && ((String) session.getAttribute("id")).equals(dto.getId())) {
	%>
	<img alt="delete" src="./delete.png" class="img"
		onclick="return del(<%=dto.getBno()%>)" title="ì´ ê¸€ì„ ì‚­ì œí•©ë‹ˆë‹¤.">
	<img alt="update" src="./modify.png" class="img"
		onclick="return update(<%=dto.getBno()%>)" title="ì´ ê¸€ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.">
	<%
	}
	%>
</body>
```

```jsx
//update.jsp
//write.jspì™€ ìƒë‹¹ ë¶€ë¶„ ê²¹ì¹˜ê¸° ë•Œë¬¸ì— ê¸°ë³¸ í‹€ì€ write.jspë¶€ë¶„ê³¼ ë™ì¼í•˜ë‹¤ ìƒê°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.

<body>
<%
	 BoardDTO dto = (BoardDTO) request.getAttribute("dto");
	%>
		<h1>ê¸€ ìˆ˜ì •í•˜ê¸°</h1>
		<div id="write">
		 <form action ="./update" method="post" onsubmit="return check()">
	      <input type ="text" name="title" id = "title" value="<%=dto.getBtitle() %>" placeholder="ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."><br>
	      <textarea name="content" id="content"  placeholder="ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."><%=dto.getBcontent() %></textarea><br>
	      <div class="wrap">
		  <button id="sub" type="submit">ê¸€ ìˆ˜ì •í•˜ê¸°</button>
		  <input type="hidden" name="bno" value="<%=dto.getBno() %>">
		  </div>
		 </form>
		</div>
</body>
```










__ê²°ê³¼ë¬¼__

![1](/assets/20210707/1.png)
![2](/assets/20210707/2.png)
![3](/assets/20210707/3.png)
