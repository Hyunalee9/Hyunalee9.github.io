---
title: "[35ÏùºÏ∞®] Í∞ÑÏ†ë access "
excerpt: "ÏïÑÏù¥Ìã∞Ïúå 0611_(2) "
categories:
      - ORACLE11g
tags:
      - ORACLE11g
      - TIL
last-modified-at: 2025-06-11T18:20
---

# Í∞ÑÏ†ë access

‚ñ∂Ô∏è DBA ÏÑ∏ÏÖò

```sql
CREATE USER anna IDENTIFIED BY oracle;
GRANT create session TO anna;
```

‚ñ∂Ô∏è ANNA ÏÑ∏ÏÖò

```sql
SELECT * FROM session_privs;
SELECT * FROM user_tab_privs;  -- Í∞ùÏ≤¥ Í∂åÌïú ÌôïÏù∏ 
```

‚ñ∂Ô∏è HR ÏÑ∏ÏÖò

```sql
GRANT execute ON hr.emp_info TO anna;   -- Ïó∞ÏäµÎ¨∏Ï†ú Ï§ë ÎßåÎì† ÌîÑÎ°úÏãúÏ†Ä ( 100 ÏûÖÎ†• Ïãú ÌîÑÎ°úÍ∑∏Îû® Ï¢ÖÎ£å)
GRANT execute ON hr.sawon_insert TO anna;
GRANT SELECT ON hr.sawon TO anna;
```

‚ñ∂Ô∏è ANNA ÏÑ∏ÏÖò

```sql
desc hr.emp_info;
execute hr.emp_info(120, p_id);   -- Í∞ÑÏ†ë access!

-- ÏßÅÏ†ë insert Î∂àÍ∞Ä
INSERT INTO sawon(id,name,day,deptno ) VALUES(1,'ÌôçÍ∏∏Îèô',sysdate,10);

-- Í∞ÑÏ†ë insert Í∞ÄÎä•
execute hr.sawon_insert(1,'ÌôçÍ∏∏Îèô',sysdate,10)

SELECT * FROM hr.sawon;
COMMIT;
```

‚ñ∂Ô∏è HR ÏÑ∏ÏÖò : sawon_insert ÌîÑÎ°úÏãúÏ†Ä execute Í∂åÌïú ÌöåÏàò

```sql
REVOKE execute ON hr.sawon_insert FROM anna; 
```

‚ñ∂Ô∏è ANNA ÏÑ∏ÏÖò  : Í∂åÌïú ÌöåÏàòÌï¥ÏÑú sawon_insert execute Ïã§Ìå®

```sql
execute hr.sawon_insert(1,'ÌôçÍ∏∏Îèô',sysdate,10)  
```

‚ñ∂Ô∏è HR ÏÑ∏ÏÖò : sawon_insert ÌîÑÎ°úÏãúÏ†Ä execute Í∂åÌïú annaÏóêÍ≤å Îã§Ïãú Ï£ºÍ∏∞ 

```sql
GRANT execute ON hr.sawon_insert TO anna;

-- sawon_insert Ïû¨ÏÉùÏÑ±

CREATE OR REPLACE PROCEDURE hr.sawon_insert
(p_id IN number,
 p_name IN varchar2,
 p_day IN date,
 p_deptno IN number)
IS
BEGIN
    INSERT INTO hr.sawon(id,name,day,deptno) VALUES(p_id, p_name, p_day, p_deptno);
END sawon_insert;
/
```

‚ñ∂Ô∏è ANNA ÏÑ∏ÏÖò :  Ïû¨ÏÉùÏÑ±Ìïú ÌîÑÎ°úÏãúÏ†Ä execute Í∞ÄÎä•

```sql
execute hr.sawon_insert(2,'ÌôçÍ∏∏Îèô',sysdate,10)
```

‚ñ∂Ô∏è HR ÏÑ∏ÏÖò : ÌîÑÎ°úÏãúÏ†Ä DROP 

```sql
DROP PROCEDURE hr.sawon_insert;
```

‚ñ∂Ô∏è ANNA ÏÑ∏ÏÖò :  DROPÌïú ÌîÑÎ°úÏãúÏ†Ä execute Î∂àÍ∞ÄÎä•

## Ïã†Í∑ú Î∂ÄÏÑú Ï†ïÎ≥¥Î•º ÏûÖÎ†•ÌïòÎäî ÌîÑÎ°úÏãúÏ†Ä

‚ñ∂Ô∏è **ÌÖåÏù¥Î∏î ÏÉùÏÑ±**

```sql
DROP TABLE hr.emp PURGE;
DROP TABLE hr.dept PURGE;

CREATE TABLE hr.emp AS SELECT * FROM hr.employees;
CREATE TABLE hr.dept AS SELECT * FROM hr.departments;

ALTER TABLE hr.emp ADD CONSTRAINT empid_pk PRIMARY KEY(employee_id);
ALTER TABLE hr.dept ADD CONSTRAINT deptid_pk PRIMARY KEY(department_id);
ALTER TABLE hr.dept ADD CONSTRAINT dept_mgr_id_fk FOREIGN KEY(manager_id) REFERENCES hr.emp(employee_id);

SELECT * FROm user_constraints WHERE table_name IN ('EMP', 'DEPT');
SELECT * FROm user_cons_columns WHERE table_name IN ('EMP', 'DEPT');
```

‚ñ∂Ô∏è **ÌîÑÎ°úÏãúÏ†Ä ÏÉùÏÑ±**

```sql
INSERT INTO hr.dept(department_id, department_name, manager_id, location_id)
VALUES(ÎßàÏßÄÎßâÎ∂ÄÏÑúÏΩîÎìú+10, ÏûÖÎ†•Î≥ÄÏàò, ÏûÖÎ†•Î≥ÄÏàò, ÏûÖÎ†•Î≥ÄÏàò)
```

üìç ÎßàÏßÄÎßâ Î∂ÄÏÑú ÏΩîÎìú ÎΩëÏïÑÎÇ¥Îäî Î≤ï? MAX

department_id Ïù∏Îç±Ïä§ Í±∏Î†§ ÏûàÍ∏∞ÎïåÎ¨∏Ïóê  MAX Ïç®ÎèÑ ÌÅ∞ Î∂ÄÌïòÍ∞Ä ÏùºÏñ¥ ÎÇòÏßÄ ÏïäÎäîÎã§.  

```sql
SELECT max(department_id)
FROM hr.dept;
```

![image.png](/assets/20250611/6.png)

üìç FULL SCAN(MIN/MAX) : Ïù∏Îç±Ïä§Í∞Ä Í±∏Î†§ÏûàÏñ¥ ÏµúÏÜüÍ∞íÏùÄ Îß® ÏôºÏ™ΩÎßå ÌÉêÏÉâ(MIN), ÏµúÎåìÍ∞íÏùÄ Îß® Ïò§Î•∏Ï™ΩÎßå ÌÉêÏÉâ(MAX)

```sql
SELECT max(department_id)
INTO ÎßàÏßÄÎßâ Î∂ÄÏÑú ÏΩîÎìú Î≥ÄÏàò
FROM hr.dept;
```

```sql
CREATE OR REPLACE PROCEDURE hr.add_dept
(p_name IN  varchar2, 
 p_mgr  IN  number,
 p_loc  IN  number
)

IS
v_max number;
BEGIN
	SELECT max(department_id)
      INTO v_max
      FROM hr.dept;
  
  INSERT INTO hr.dept(department_id, department_name, manager_id, location_id)
  VALUES(v_max+10, p_name , p_mgr  , p_loc  );
END;
/   
```

‚ñ∂Ô∏è executeÎã®ÏóêÏÑú EXCEPTION Ï≤òÎ¶¨

```sql
BEGIN
    hr.add_dept('Í≤ΩÏòÅÍ∏∞Ìöç',100,1800);   
    hr.add_dept('Îç∞Ïù¥ÌÑ∞ÏïÑÌÇ§ÌÖçÏ≤ò',99,1800);  -- 99Î≤à manager_id Ï°¥Ïû¨ÌïòÏßÄ z -> ÎπÑÏ†ïÏÉÅÏ†Å Ï¢ÖÎ£å -> rollback
    hr.add_dept('Ïù∏Ïû¨Í∞úÎ∞ú',101,1700);
END;
/
```

![image.png](/assets/20250611/7.png)

```sql
--EXCEPTION Ï≤òÎ¶¨
BEGIN
    hr.add_dept('Í≤ΩÏòÅÍ∏∞Ìöç',100,1800);   -- Ïù¥Í≤ÉÎßå Îì§Ïñ¥Í∞ê.
    hr.add_dept('Îç∞Ïù¥ÌÑ∞ÏïÑÌÇ§ÌÖçÏ≤ò',99,1800);  
    hr.add_dept('Ïù∏Ïû¨Í∞úÎ∞ú',101,1700);   
EXCEPTION
    WHEN OTHERS THEN
        dbms_output.put_line(SQLERRM);
END;
/
ROLLBACK;
```

![image.png](/assets/20250611/8.png)

‚ñ∂Ô∏è ÌîÑÎ°úÏãúÏ†ÄÎã®ÏóêÏÑú EXCEPTION Ï≤òÎ¶¨ 

```sql
CREATE OR REPLACE PROCEDURE hr.add_dept
(p_name IN  varchar2, 
 p_mgr  IN  number,
 p_loc  IN  number
)

IS
v_max number;
BEGIN
	SELECT max(department_id)
      INTO v_max
      FROM hr.dept;
  
  INSERT INTO hr.dept(department_id, department_name, manager_id, location_id)
  VALUES(v_max+10, p_name , p_mgr  , p_loc  );
  
EXCEPTION
    WHEN OTHERS THEN
        dbms_output.put_line('Ïò§Î•òÎ∂ÄÏÑú : '||p_name);
        dbms_output.put_line(SQLERRM);
END;
/ 

-----> Îã§Ïãú executeÌï¥Î≥¥Î©¥ Ïò§Î•òÎÇú Î∂ÄÎ∂Ñ Ï†úÏô∏ Ïù∏Ïû¨Í∞úÎ∞úÍπåÏßÄ ÏÇ¥ÏïÑÏûàÏùå
BEGIN
    hr.add_dept('Í≤ΩÏòÅÍ∏∞Ìöç',100,1800);   
    hr.add_dept('Îç∞Ïù¥ÌÑ∞ÏïÑÌÇ§ÌÖçÏ≤ò',99,1800);  -- 99Î≤à ÏÇ¨Ïõê Ï°¥Ïû¨ÌïòÏßÄ z -> ÎπÑÏ†ïÏÉÅÏ†Å Ï¢ÖÎ£å -> rollback
    hr.add_dept('Ïù∏Ïû¨Í∞úÎ∞ú',101,1700);   --
EXCEPTION
    WHEN OTHERS THEN
        dbms_output.put_line(SQLERRM);
END;
/
```

![image.png](/assets/20250611/9.png)