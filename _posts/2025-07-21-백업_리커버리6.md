---
title: "[61ì¼ì°¨] Backup & Recovery6"
excerpt: "ì•„ì´í‹°ìœŒ 0721"
categories:
      - ORACLE11g
tags:
      - ORACLE11g
      - TIL
last-modified-at: 2025-07-21T18:26
---

## archive mode

ğŸ“ ë¡œê·¸ ìŠ¤ìœ„ì¹˜ ë°œìƒ ì‹œ

1ï¸âƒ£ ì²´í¬ í¬ì¸íŠ¸ ë°œìƒ

2ï¸âƒ£ ë¦¬ë‘ ë¡œê·¸ íŒŒì¼ì„ ì €ì¥ (ARC ë¼ëŠ” ë°±ê·¸ë¼ìš´ í”„ë¡œì„¸ì„œê°€ ì²˜ìŒ ~ ë³€ê²½ëœ ì´ë ¥ ëª¨ë‘ ê¸°ë¡í•œë‹¤.)

ì•„ì¹´ì´ë¸Œ ëª¨ë“œë¼ë„, ë¦¬ë‘ ë¡œê·¸ê°€ í•˜ë‚˜ë¼ë„ ì†ì‹¤ë˜ë©´ ë¶ˆì™„ì „í•œ ë³µêµ¬ ë°©ì‹(ê°€ì¥ ìµœê·¼ì— ë°±ì—…ë°›ì•„ ë†“ì€ whole data file ë¦¬ìŠ¤íŠ¸í™”) ìœ¼ë¡œ ë³µêµ¬í•´ì•¼ í•œë‹¤.

ë§¤ì¼ ë¦¬ë‘ ì²´í¬í•´ì•¼í•˜ê³ , ë¦¬ë‘ê°€ ì†ì‹¤ë˜ë©´ ê·¸ ì¦‰ì‹œ ë°±ì—… ë°›ì•„ì•¼ í•œë‹¤.

- **NOARCHIVELOG vs ARCHIVELOG**
    
    ğŸ“**NOARCHIVELOG**
    
    - ê¸°ë³¸ì ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ëŠ” NOARCHIVELOG ëª¨ë“œë¡œ ìƒì„±ëœë‹¤.
    - ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œ í›„ì— ë°±ì—…ì„ ë°›ëŠ”ë‹¤.
        - shutdown normal | transactional | immediate
    - ë°±ì—… ëŒ€ìƒ íŒŒì¼ì€ data file, control fileì€ í•„ìˆ˜ë¡œ ë°±ì—…ì„ ë°›ì•„ì•¼ í•˜ê³  redo log fileì€ ì„ íƒ ì‚¬í•­ì´ë‹¤.
    - NOARCHIVELOGëª¨ë“œì˜ ë³µêµ¬ëŠ” ë¦¬ë‘ì— ì†ì‹¤ë¡œ ì¸í•´ ë°±ì—… ì‹œì ìœ¼ë¡œ ë³µêµ¬ ì‘ì—…ì„ í•  ìˆ˜ ë°–ì— ì—†ì–´ì„œ ë°ì´í„° ì†ì‹¤ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
    
    **NOARCHIVELOG ëª¨ë“œë¡œ ì‘ë™ë˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ íŠ¹ì§•** 
    
    - redo log ê°€ ê²¹ì³ ì“°ì—¬ì§€ë©´ ë§ˆì§€ë§‰ ë°±ì—…ì— ëŒ€í•´ì„œë§Œ ë³µêµ¬ ì‘ì—…ì„ í•  ìˆ˜ ìˆë‹¤.
    - redo log file ì´ ìˆœí™˜ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë°±ì—… ì´í›„ì— ë¦¬ë‘ ì •ë³´ê°€ ì—†ì–´ì§ˆ ìˆ˜ ìˆë‹¤.
    - redo log file ì´ log switch ê°€ ë°œìƒí•˜ë©´ checkpointê°€ ë°œìƒí•œ í›„ ì¦‰ì‹œ redo log fileì„ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    
    ğŸ“**ARCHIVELOG** 
    
    - log switchê°€ ë°œìƒí•˜ë©´ checkpointê°€ ë°œìƒí•˜ê³  arc ë°±ê·¸ë¼ìš´ë“œ í”„ë¡œì„¸ìŠ¤ê°€ í˜„ì¬ redo log fileì„ ë¬¼ë¦¬ì ì¸ ìœ„ì¹˜ì— ë³µì‚¬í•œ í›„ redo log file ì€ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    - control fileì— archiveëœ redo log file ì •ë³´ë¥¼ ê¸°ë¡ëœë‹¤.
    - ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì •ìƒì ì¸ ì¢…ë£Œ í›„ì— ë°±ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê³  ìš´ì˜ ì¤‘ì— ë°±ì—…(ì¼ê´€ì„± ì—†ëŠ” ë°±ì—…)ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.
    - ë³µêµ¬ëŠ” í˜„ì¬ ë¬¸ì œë˜ëŠ” ì§€ì ê¹Œì§€ ë³µêµ¬ê°€ ê°€ëŠ¥í•˜ë‹¤. (ë¦¬ë‘ê°€ ìˆê¸° ë•Œë¬¸ì—)
    
- ëª¨ë“œ í™•ì¸
    
    ```sql
    SYS@ora19c> archive log list
    
    Database log mode              No Archive Mode
    Automatic archival             Disabled
    Archive destination            USE_DB_RECOVERY_FILE_DEST
    Oldest online log sequence     9
    Current log sequence           11
    
    SYS@ora19c> show parameter db_recovery_file_dest 
    
    NAME                                 TYPE        VALUE
    ------------------------------------ ----------- ------------------------------
    db_recovery_file_dest                string      /u01/app/oracle/fast_recovery_
    db_recovery_file_dest_size           big integer 8256M
    ```
    
- Fast Recovery Area
    
    **ì˜¤ë¼í´ ë””ìŠ¤í¬ ë°±ì—… ì „ëµì˜ í•µì‹¬ êµ¬ì„± ìš”ì†Œ**
    
    1ï¸âƒ£ ASM(Automatic Storage Management, ìë™ ì €ì¥ ì˜ì—­ ê´€ë¦¬) ë””ìŠ¤í¬ ê·¸ë£¹ : 
    
    ì˜¤ë¼í´ ë°ì´í„°ë² ì´ìŠ¤ì— í•„ìš”í•œ ëª¨ë“  recovery ê´€ë ¨ íŒŒì¼ê³¼ ì‘ì—…ì„ êµ¬ì„±
    
    2ï¸âƒ£ FRA(Fast Recovery Area) : íŒŒì¼ ì‹œìŠ¤í…œì˜ ì €ì¥ ì˜ì—­ ìœ„ì¹˜
    
    ğŸŒ³ **ì˜êµ¬ í•­ëª© : instance ì—ì„œ ì£¼ë¡œ ì‚¬ìš©**
    
    - í˜„ì¬ control fileì˜ ë‹¤ì¤‘í™”ëœ ë³µì‚¬ë³¸
    - ì˜¨ë¼ì¸ ë¦¬ë‘ ë¡œê·¸ì˜ ë‹¤ì¤‘í™”ëœ ë³µì‚¬ë³¸
    
    ğŸŒ³ **ì„ì‹œ í•­ëª© : recovery ì‘ì—…ì—ì„œë§Œ í•„ìš”** 
    
    - ì•„ì¹´ì´ë¸Œëœ ë¦¬ë‘ ë¡œê·¸
    - ë°ì´í„° íŒŒì¼ ë³µì‚¬ë³¸ (RMAN ì„ ì´ìš©í•´ì„œ backup as copy ëª…ë ¹ì„ ìˆ˜í–‰í•˜ëŠ” ê²½ìš°, ì´ë¯¸ì§€ ë°ì´í„° íŒŒì¼ ë³µì‚¬ë³¸ ìƒì„±)
    - control file ë³µì‚¬ë³¸
    - ë°±ì—… í”¼ìŠ¤ (rmanì„ ì´ìš©í•´ì„œ ë°±ì—…)
    - Flashback log ì •ë³´ (flashback databaseê°€ í™œì„±í™”ëœ ê²½ìš°)
    
    Fast Recovery Area êµ¬ì„±
    
    ```sql
    SYS@ora19c> show parameter db_recovery_file_dest 
    
    NAME                                 TYPE        VALUE
    ------------------------------------ ----------- ------------------------------
    db_recovery_file_dest                string      /u01/app/oracle/fast_recovery_
    db_recovery_file_dest_size           big integer 8256M
    ```
    
- ARCHIVELOG ì„¤ì •
    
    ```sql
    SYS@ora19c> select log_mode from v$database;   -- ëª¨ë“œ ì¡°íšŒ 
    
    LOG_MODE
    ------------
    NOARCHIVELOG
    
    SYS@ora19c> !
    [oracle@oracle ~]$ cd $ORACLE_BASE
    [oracle@oracle oracle]$ ls
    admin  audit  cfgtoollogs  checkpoints  diag  fast_recovery_area  oradata  product
    [oracle@oracle oracle]$ cd fast_recovery_area
    [oracle@oracle fast_recovery_area]$ ls
    ORA19C
    [oracle@oracle fast_recovery_area]$ cd ORA19C
    [oracle@oracle ORA19C]$ ls
    archivelog  onlinelog
    
    -- ì„¤ì • ìœ„ì¹˜ 
    /u01/app/oracle/fast_recovery_area/ORA19C/archivelog
    
    ```
    
    1ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ ì •ìƒì ì¸ ì¢…ë£Œ
    
    ```sql
    shutdown immediate
    ```
    
    2ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ mount ê¹Œì§€ë§Œ ì‹œì‘
    
    ```sql
    startup mount
    ```
    
    3ï¸âƒ£ archivelog ëª¨ë“œë¡œ ë³€ê²½
    
    ```sql
    SYS@ora19c> alter database archivelog;
    SYS@ora19c> select log_mode from v$database;
    
    LOG_MODE
    ------------
    ARCHIVELOG
    
    ```
    
    4ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ open
    
    ```sql
    alter database open;
    
    SYS@ora19c> archive log list;
    Database log mode              Archive Mode
    Automatic archival             Enabled
    Archive destination            USE_DB_RECOVERY_FILE_DEST
    Oldest online log sequence     9
    Next log sequence to archive   11
    Current log sequence           11
    ```
    
- NOARCHIVELOG ì„¤ì •
    
    
    1ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ ì •ìƒì ì¸ ì¢…ë£Œ
    
    ```sql
    shutdown immediate
    ```
    
    2ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ mountê¹Œì§€ë§Œ ì‹œì‘
    
    ```sql
    startup mount
    ```
    
    3ï¸âƒ£ noarchivelog modeë¡œ ë³€ê²½
    
    ```sql
    alter database noarchivelog;
    ```
    
    4ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ open
    
    ```sql
    alter database open;
    SYS@ora19c> select log_mode from v$database;
    
    LOG_MODE
    ------------
    NOARCHIVELOG
    ```
    
- ì‹¤ìŠµ
    
    ğŸ“ ì•„ì¹´ì´ë¸Œ ëª¨ë“œ
    
    - ğŸ“ í™•ì¸ ì‘ì—…
        
        ```sql
        -- ë¦¬ë‘ ë¡œê·¸ ì •ë³´ 
        
        SYS@ora19c> SELECT a.group#, b.sequence#, a.member, b.status, b.first_change#, b.first_time, b.next_change#, b.next_time
        FROM v$logfile a, v$log b
        WHERE a.group# = b.group#
        ORDER BY b.group#;
        
           
             GROUP#  SEQUENCE# MEMBER
        ---------- ---------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                 1         16 /u01/app/oracle/oradata/ORA19C/redo01.log
                 2         17 /u01/app/oracle/oradata/ORA19C/redo02.log
                 3         15 /u01/app/oracle/oradata/ORA19C/redo03.log
        
                 
        -- ğŸ“Œ ë°ì´í„°íŒŒì¼ ë° í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ ìƒíƒœ í™•ì¸
        SYS@ora19c> SELECT a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
        FROM v$datafile a, v$tablespace b
        WHERE a.ts# = b.ts#; 
        
          FILE# TBS_NAME                       FILE_NAME                                                              STATUS  CHECKPOINT_CHANGE#
        ---------- ------------------------------ ---------------------------------------------------------------------- ------- ------------------
                 3 SYSAUX                         /u01/app/oracle/oradata/ORA19C/sysaux01.dbf                            ONLINE             2965060
                 1 SYSTEM                         /u01/app/oracle/oradata/ORA19C/system01.dbf                            SYSTEM             2965060
                 4 UNDOTBS1                       /u01/app/oracle/oradata/ORA19C/undotbs01.dbf                           ONLINE             2965060
                 7 USERS                          /u01/app/oracle/oradata/ORA19C/users01.dbf                             ONLINE             2965060
        
        ```
        
        2ï¸âƒ£ ì •ìƒì¢…ë£Œ
        
        ```sql
        shutdown immediate
        ```
        
    - ğŸ“ë°±ì—…
        - ğŸ“ ì¼ê´€ì„± ìˆëŠ” ë°±ì—… (consistent backup, closed backup, cold backup, offline backup)
            - 1ï¸âƒ£ ì •ìƒ ì¢…ë£Œ í›„ backup/arch/close ê²½ë¡œì— ë°±ì—…ë³¸ ë§Œë“¤ê¸°
                
                ```sql
                SYS@ora19c> shutdown immediate
                SYS@ora19c> !
                
                -- close í´ë” ë§Œë“¤ê³  ë°±ì—…
                [oracle@oracle arch]$ mkdir close
                [oracle@oracle arch]$ cd close
                [oracle@oracle close]$ pwd
                /home/oracle/backup/arch/close
                
                -- í˜„ì¬ í´ë”ì—ë‹¤ ctl, log, dbf íŒŒì¼ë“¤ ë³µì‚¬í•˜ê² ë‹¤
                [oracle@oracle close]$ cp -v /u01/app/oracle/oradata/ORA19C/*.{ctl,log,dbf} .
                ```
                
            - 2ï¸âƒ£ sqlplus ì ‘ì†í•´ì„œ pfile ë°±ì—…í•˜ê¸°
                
                ```sql
                [oracle@oracle close]$ sqlplus / as sysdba
                SYS@ora19c> create pfile='/home/oracle/backup/arch/close/initora19c.ora' from spfile;
                
                -- í™•ì¸ ì‘ì—…
                SYS@ora19c> ! ls /home/oracle/backup/arch/close/
                
                â–¶ï¸ control01.ctl  data01.dbf  initora19c.ora  redo01.log  redo02.log  redo03.log  sysaux01.dbf  system01.dbf  temp01.dbf  undotbs01.dbf  users01.dbf
                
                ```
                
            - 3ï¸âƒ£ ë¦¬ë‘ ë¡œê·¸ ì •ë³´ í™•ì¸, ë°ì´í„° íŒŒì¼, í…Œì´ë¸” ìŠ¤í˜ì´ìŠ¤ ìƒíƒœ í™•ì¸
                
                ```sql
                select a.group#, b.sequence#, a.member, b.bytes/1024/1024 mb, b.archived,
                       b.status, b.first_change#, b.first_time, b.next_change#, b.next_time
                from v$logfile a, v$log b
                where a.group# = b.group#
                order by b.group#; 
                
                    GROUP#  SEQUENCE# MEMBER
                ---------- ---------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         1         16 /u01/app/oracle/oradata/ORA19C/redo01.log
                         2         17 /u01/app/oracle/oradata/ORA19C/redo02.log
                         3         15 /u01/app/oracle/oradata/ORA19C/redo03.log
                
                select a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
                from v$datafile a, v$tablespace b
                where a.ts# = b.ts#; 
                
                     FILE# TBS_NAME                       FILE_NAME                                                              STATUS  CHECKPOINT_CHANGE#
                ---------- ------------------------------ ---------------------------------------------------------------------- ------- ------------------
                         3 SYSAUX                         /u01/app/oracle/oradata/ORA19C/sysaux01.dbf                            ONLINE             2965060
                         1 SYSTEM                         /u01/app/oracle/oradata/ORA19C/system01.dbf                            SYSTEM             2965060
                         4 UNDOTBS1                       /u01/app/oracle/oradata/ORA19C/undotbs01.dbf                           ONLINE             2965060
                         7 USERS                          /u01/app/oracle/oradata/ORA19C/users01.dbf                             ONLINE             2965060
                
                ```
                
            
        - ğŸ“ ì¼ê´€ì„± ì—†ëŠ” ë°±ì—… (online , open, hot)
            - 1ï¸âƒ£ ë°±ì—… ì •ë³´ í™•ì¸
                
                ```sql
                -- ì¼ê´€ì„± ì—†ëŠ” ë°±ì—…ë³¸ì„ ì²´í¬í•˜ëŠ” ì¿¼ë¦¬
                -- ë°ì´í„°ë² ì´ìŠ¤ ìš´ì˜ ì¤‘ì— ë°±ì—…
                select a.name, a.checkpoint_change#, b.status, b.change#, b.time
                from v$datafile a, v$backup b where a.file# = b.file#;
                
                NAME                                               CHECKPOINT_CHANGE# STATUS                CHANGE# TIME
                -------------------------------------------------- ------------------ ------------------ ---------- ---------
                /u01/app/oracle/oradata/ORA19C/system01.dbf                   2965060 NOT ACTIVE            2847704 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/sysaux01.dbf                   2965060 NOT ACTIVE            2847704 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/undotbs01.dbf                  2965060 NOT ACTIVE            2847704 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/users01.dbf                    2965060 NOT ACTIVE            2847704 21-JUL-25
                
                ```
                
            - 2ï¸âƒ£ open backup ìˆ˜í–‰ (full check point ë°œìƒí•´ì•¼ í•¨)
                
                ```sql
                -- ë°ì´í„°ë² ì´ìŠ¤ ì „ì²´ë¥¼ ë°±ì—… ëª¨ë“œë¡œ ì „í™˜
                -- RMANì´ ì•„ë‹Œ OS ìˆ˜ì¤€ì˜ ìˆ˜ë™ íŒŒì¼ ë³µì‚¬(cp) ë¥¼ ì´ìš©í•  ë•Œ
                -- ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë‚´ë¦¬ì§€ ì•Šê³ (OPEN ìƒíƒœ) ë°±ì—…ì„ ìˆ˜í–‰í•˜ê³ ì í•  ë•Œ
                alter database begin backup;
                
                -- ë°±ì—… ì •ë³´ í™•ì¸
                SYS@ora19c> select a.name, a.checkpoint_change#, b.status, b.change#, b.time
                from v$datafile a, v$backup b where a.file# = b.file#;
                
                NAME                                               CHECKPOINT_CHANGE# STATUS                CHANGE# TIME
                -------------------------------------------------- ------------------ ------------------ ---------- ---------
                /u01/app/oracle/oradata/ORA19C/system01.dbf                   2967063 ACTIVE                2967063 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/sysaux01.dbf                   2967063 ACTIVE                2967063 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/undotbs01.dbf                  2967063 ACTIVE                2967063 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/users01.dbf                    2967063 ACTIVE                2967063 21-JUL-
                ```
                
            - 3ï¸âƒ£ ëª¨ë“  ë°ì´í„° íŒŒì¼ ë°±ì—…
                
                home/oracle/backup/arch/open ê²½ë¡œì— ë°±ì—…
                
                ```sql
                ! cp -v /u01/app/oracle/oradata/ORA19C/*.dbf  /home/oracle/backup/arch/open/
                ls
                exit
                alter database end backup;
                ```
                
        - ğŸ“ online control file ë°±ì—…
            
            ```sql
            select name from v$controlfile;
            
            NAME
            --------------------------------------------------
            /u01/app/oracle/oradata/ORA19C/control01.ctl
            
            ALTER DATABASE BACKUP CONTROLFILE TO '/home/oracle/backup/arch/open/control01.ctl';
            
            ! ls /home/oracle/backup/arch/open/
            
            --  REDO ë¡œê·¸ íŒŒì¼ ì •ë³´ í™•ì¸
            SELECT a.group#, b.sequence#, a.member, b.bytes/1024/1024 mb, 
                   b.archived, b.status, b.first_change#, b.first_time, 
                   b.next_change#, b.next_time
            FROM v$logfile a, v$log b
            WHERE a.group# = b.group#
            ORDER BY b.group#;
            
                GROUP#  SEQUENCE# MEMBER
            ---------- ---------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                     1         10 /u01/app/oracle/oradata/ORA19C/redo01.log
                     2         11 /u01/app/oracle/oradata/ORA19C/redo02.log
                     3          9 /u01/app/oracle/oradata/ORA19C/redo03.log
            
            -- í˜„ì¬ ë°±ì—…ì„ ìˆ˜í–‰í–ˆì„ ë•Œ ë¦¬ë‘ ì •ë³´ê°€ ìˆëŠ” current redo log file ë¥¼ archive ë°›ì
            -- ë‚´ë¶€ì ìœ¼ë¡œ ê°•ì œë¡œ log switch ìœ ë°œ ( 1. ì²´í¬í¬ì¸íŠ¸ 2. ë¦¬ë‘ ë¡œê·¸ ì•„ì¹´ì´ë¸Œ)
            alter system archive log current;
            
            -- ìƒˆë¡œìš´ ê·¸ë£¹ìœ¼ë¡œ current í•œ ê·¸ë£¹ ë°”ë€Œì—ˆë‹¤.
                GROUP#  SEQUENCE# MEMBER
            ---------- ---------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                     1         10 /u01/app/oracle/oradata/ORA19C/redo01.log
                     2         11 /u01/app/oracle/oradata/ORA19C/redo02.log
                     3         12 /u01/app/oracle/oradata/ORA19C/redo03.log
            
            -- í™•ì¸í•´ë³´ê¸°
            [oracle@oracle ~]$ cd $ORACLE_BASE
            [oracle@oracle oracle]$ ls
            admin  audit  cfgtoollogs  checkpoints  diag  fast_recovery_area  oradata  product
            [oracle@oracle oracle]$ cd fast_recovery_area
            [oracle@oracle fast_recovery_area]$ ls
            ORA19C
            [oracle@oracle fast_recovery_area]$ cd ORA19C
            [oracle@oracle ORA19C]$ ls
            archivelog  onlinelog
            [oracle@oracle ORA19C]$ cd archivelog
            [oracle@oracle archivelog]$ ls
            2025_07_01  2025_07_02  2025_07_03  2025_07_07  2025_07_09  2025_07_14  2025_07_15  2025_07_16  2025_07_17  2025_07_21
            [oracle@oracle archivelog]$ cd 2025_07_21
            [oracle@oracle 2025_07_21]$ ls
            o1_mf_1_11_n7vlytjz_.arc
            
            -- ë‹¤ë¥¸ ì„¸ì…˜
            SYS@ora19c> alter system archive log current;
            
            System altered.
            
            SYS@ora19c> SELECT a.group#, b.sequence#, a.member, b.bytes/1024/1024 mb,
                   b.archived, b.status, b.first_change#, b.first_time,
                   b.next_change#, b.next_time
            FROM v$logfile a, v$log b
            WHERE a.group# = b.group#
            order by 1;
            
                GROUP#  SEQUENCE# MEMBER
            ---------- ---------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                     1         13 /u01/app/oracle/oradata/ORA19C/redo01.log
                     2         11 /u01/app/oracle/oradata/ORA19C/redo02.log
                     3         12 /u01/app/oracle/oradata/ORA19C/redo03.log
            
            -- í˜„ì¬ online backup ì •ë³´ í™•ì¸
            -- ë°±ì—… ì‹œì  scn : 2849125 
            -- ë°±ì—… ì´í›„ ë¡œê·¸ ì‹œí€€ìŠ¤ ì •ë³´ë“¤ : #11, #12, #13
            select a.name, a.checkpoint_change#, b.status, b.change#, b.time
            from v$datafile a, v$backup b
            where a.file# = b.file#;
            
            NAME                                               CHECKPOINT_CHANGE# STATUS                CHANGE# TIME
            -------------------------------------------------- ------------------ ------------------ ---------- ---------
            /u01/app/oracle/oradata/ORA19C/system01.dbf                   2849125 NOT ACTIVE            2847704 21-JUL-25
            /u01/app/oracle/oradata/ORA19C/sysaux01.dbf                   2849125 NOT ACTIVE            2847704 21-JUL-25
            /u01/app/oracle/oradata/ORA19C/undotbs01.dbf                  2849125 NOT ACTIVE            2847704 21-JUL-25
            /u01/app/oracle/oradata/ORA19C/users01.dbf                    2849125 NOT ACTIVE            2847704 21-JUL-25
            
            SELECT a.group#, b.sequence#, a.member, b.bytes/1024/1024 mb,
                   b.archived, b.status, b.first_change#, b.first_time,
                   b.next_change#, b.next_time
            FROM v$logfile a, v$log b
            WHERE a.group# = b.group#
            order by 1;
            
               GROUP#  SEQUENCE# MEMBER
            ---------- ---------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                     1         13 /u01/app/oracle/oradata/ORA19C/redo01.log
                     2         11 /u01/app/oracle/oradata/ORA19C/redo02.log
                     3         12 /u01/app/oracle/oradata/ORA19C/redo03.log
            
            -- ë°±ì—… ì‹œì , í˜„ì¬ ì‹œì  ë¡œê·¸ ì •ë³´ í™•ì¸ (ì»¨íŠ¸ë¡¤ íŒŒì¼ ì•ˆì— ì €ì¥ë˜ì–´ ìˆë‹¤.- ë…¼ë¦¬ì )
            SELECT sequence#, name, first_change#, next_change# 
            FROM v$archived_log;
            
             SEQUENCE# NAME                                               FIRST_CHANGE# NEXT_CHANGE#
            ---------- -------------------------------------------------- ------------- ------------
                    11 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2767692      2849125  <- ë°±ì—…ì‹œì  scn
                    12 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2849125      2849255
            
            -- ë¬¼ë¦¬ì ì¸ ì•„ì¹´ì´ë¸Œ íŒŒì¼ ê¼­ ì²´í¬
            ! ls /u01/app/oracle/fast_recovery_area/ORA19C/archivelog/2025_07_21
            
            o1_mf_1_11_n7vlytjz_.arc  o1_mf_1_12_n7vm7v41_.arc
            
            ```
            
    - ğŸ“ë³µêµ¬
        - ğŸ“ ë°ì´í„°ë² ì´ìŠ¤ ìš´ì˜ ì¤‘ì— non system datafile ì†ìƒë˜ì—ˆì„ ê²½ìš° ë³µêµ¬
            - 1ï¸âƒ£ ë°ì´í„° ìƒì„±
                
                ```sql
                create table hr.new(id number) tablespace users;
                insert into hr.new(id) values(1);
                commit;
                ```
                
            - 2ï¸âƒ£ ì¥ì•  ë°œìƒ
                
                ```sql
                SELECT f.file_name
                FROM dba_extents e, dba_data_files f
                WHERE e.file_id = f.file_id
                  AND e.segment_name = 'NEW'
                  AND e.owner = 'HR';
                  
                -- ì¥ì•  ë°œìƒ 
                ! ls /u01/app/oracle/oradata/ORA19C/users01.dbf
                ! rm /u01/app/oracle/oradata/ORA19C/users01.dbf
                ! ls /u01/app/oracle/oradata/ORA19C/users01.dbf
                
                -- ë³µêµ¬ í•„ìš” ì—¬ë¶€ í™•ì¸, íŠ¹ì • í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ì— ì†í•œ íŒŒì¼ í™•ì¸, ì²´í¬í¬ì¸íŠ¸ ë™ê¸°í™” ì ê²€,  RMAN ë˜ëŠ” ìˆ˜ë™ ë³µêµ¬ ì „ ì ê²€
                select a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
                from v$datafile a, v$tablespace b
                where a.ts# = b.ts#;
                
                     FILE# TBS_NAME                       FILE_NAME                                                              STATUS  CHECKPOINT_CHANGE#
                ---------- ------------------------------ ---------------------------------------------------------------------- ------- ------------------
                         3 SYSAUX                         /u01/app/oracle/oradata/ORA19C/sysaux01.dbf                            ONLINE             2849255
                         1 SYSTEM                         /u01/app/oracle/oradata/ORA19C/system01.dbf                            SYSTEM             2849255
                         4 UNDOTBS1                       /u01/app/oracle/oradata/ORA19C/undotbs01.dbf                           ONLINE             2849255
                         7 USERS                          /u01/app/oracle/oradata/ORA19C/users01.dbf                             ONLINE             2849255
                
                -- users01.dbf ì‚­ì œë˜ì—ˆê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ ë°œìƒ 
                CREATE TABLE hr.new_emp 
                TABLESPACE users 
                AS 
                SELECT * FROM hr.employees;
                
                SYS@ora19c> select count(*) from hr.employees;
                
                  COUNT(*)
                ----------
                       107
                
                SYS@ora19c> select * from hr.new
                  2  ;
                
                        ID
                ----------
                         1
                  
                ```
                
            - 3ï¸âƒ£ ë³µêµ¬ ì‘ì—…
                
                **ë³µêµ¬ ìˆ˜í–‰í•´ì•¼í•  í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ offline**
                
                ```sql
                alter tablespace í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ ì´ë¦„ offline [normal | temporary | immediate]
                -- ğŸ“ normal : ì²´í¬ í¬ì¸íŠ¸ ë°œìƒí•˜ëŠ” í•˜ë‚˜ì˜ ê¸°ëŠ¥
                -- ğŸ“ temporary : ê°€ëŠ¥í•œ ì²´í¬í¬ì¸íŠ¸
                -- ğŸ“ immediate : ì²´í¬ í¬ì¸íŠ¸ ë°œìƒí•˜ì§€ ì•ŠìŒ.
                
                select a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
                from v$datafile a, v$tablespace b
                where a.ts# = b.ts#;
                
                -- ì²´í¬í¬ì¸íŠ¸ ë°œìƒí•˜ì§€ ë§ê³  offlineìœ¼ë¡œ ë³€ê²½
                alter tablespace users offline immediate;
                
                select a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
                from v$datafile a, v$tablespace b
                where a.ts# = b.ts#;
                
                 -- 7 USERS         /u01/app/oracle/oradata/ORA19C/users01.dbf RECOVER 
                ```
                
                **ê°€ì¥ ìµœê·¼ ë°±ì—… íŒŒì¼ ì°¾ì•„ì„œ restore**
                
                ```sql
                ! ls /home/oracle/backup/arch/open/users01.dbf
                /home/oracle/backup/arch/open/users01.dbf
                
                ! cp -v /home/oracle/backup/arch/open/users01.dbf /u01/app/oracle/oradata/ORA19C/
                ```
                
            
            **ë°±ì—… ì´í›„ ë¦¬ë‘ ì •ë³´ ì ìš©**
            
            ```sql
            recover tablespace users;
            ```
            
            **ëŒ€ìƒ í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ oline ë³€ê²½**
            
            ```sql
            alter tablespace users online;
            
            -- í™•ì¸
            
                FILE# TBS_NAME                       FILE_NAME                                                              STATUS  CHECKPOINT_CHANGE#
            ---------- ------------------------------ ---------------------------------------------------------------------- ------- ------------------
                     3 SYSAUX                         /u01/app/oracle/oradata/ORA19C/sysaux01.dbf                            ONLINE             2849255
                     1 SYSTEM                         /u01/app/oracle/oradata/ORA19C/system01.dbf                            SYSTEM             2849255
                     4 UNDOTBS1                       /u01/app/oracle/oradata/ORA19C/undotbs01.dbf                           ONLINE             2849255
                     7 USERS                          /u01/app/oracle/oradata/ORA19C/users01.dbf                             ONLINE             2851811
            
            -- í™•ì¸ ì‘ì—…
            CREATE TABLE hr.new_emp 
            TABLESPACE users 
            AS 
            SELECT * FROM hr.employees;
            ```
            
                   **í…ŒìŠ¤íŠ¸ìš© í…Œì´ë¸” ì‚­ì œ** 
            
            ```sql
            drop table hr.new_emp purge
            ```
            
        - ğŸ“ ë°ì´í„°ë² ì´ìŠ¤ ì¢…ë£Œ í›„ non system datafile ì†ìƒë˜ì—ˆì„ ê²½ìš°
            - 1ï¸âƒ£ ì¥ì•  ìœ ë„
                
                ```sql
                shutdown immediate
                ! rm /u01/app/oracle/oradata/ORA19C/users01.dbf
                startup  -- ì˜¤ë¥˜ë‚œë‹¤. 
                ```
                
            - 2ï¸âƒ£ ë¬¸ì œë˜ëŠ” ëŒ€ìƒ íŒŒì¼ ì°¾ê¸°
                
                ```sql
                select * from v$recover_file;
                
                select a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
                from v$datafile a, v$tablespace b
                where a.ts# = b.ts#;
                ```
                
            - 3ï¸âƒ£ ë³µêµ¬ ì‘**ì—…**
                
                **ëŒ€ìƒ ë°ì´í„° íŒŒì¼ offline**
                
                ```sql
                -- ì•„ì¹´ì´ë¸Œ ëª¨ë“œì—ì„œëŠ” offline : ì²´í¬í¬ì¸íŠ¸ ë°œìƒ ì•ˆí•¨.
                alter database datafile 7 offline;
                
                -- í™•ì¸
                select a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
                from v$datafile a, v$tablespace b
                where a.ts# = b.ts#; 
                ```
                
            
            **ë°ì´í„°ë² ì´ìŠ¤ open**
            
            ```sql
            alter database open;
            
            SYS@ora19c> select count(*) from hr.employees;
            
              COUNT(*)
            ----------
                   107
            
            SYS@ora19c> select * from hr.new;
            select * from hr.new
                             *
            ERROR at line 1:
            ORA-00376: file 7 cannot be read at this time
            ORA-01110: data file 7: '/u01/app/oracle/oradata/ORA19C/users01.dbf'
            
            ```
            
            ê°€ì¥ ìµœê·¼ ë°±ì—…ë³¸ ì°¾ì•„ì„œ restore
            
            ```sql
            ! cp -v /home/oracle/backup/arch/open/users01.dbf /u01/app/oracle/oradata/ORA19C/
            ```
            
            ë°±ì—… ì´í›„ ë¦¬ë‘ ì •ë³´ ì ìš©
            
            ```sql
            recover tablespace users;
            ```
            
                   ë³µêµ¬ ì™„ë£Œ ë°ì´í„° íŒŒì¼ online ë³€ê²½
            
            ```sql
            alter database datafile 7 online;
            
            -- í™•ì¸
            select * from hr.new;
            ```
            
        - ğŸ“ ë°ì´í„°ë² ì´ìŠ¤ ì¢…ë£Œ í›„ ì—¬ëŸ¬ non system datafile ì†ìƒë˜ì—ˆì„ ê²½ìš°
            - 1ï¸âƒ£ ì¥ì•  ìœ ë„
                
                ```sql
                shutdown immediate
                
                # íŒŒì¼ ì¡´ì¬ í™•ì¸
                ! ls /u01/app/oracle/oradata/ORA19C/{sysaux01,users01}.dbf
                
                # ë‘ íŒŒì¼ ì‚­ì œ
                ! rm /u01/app/oracle/oradata/ORA19C/{sysaux01,users01}.dbf
                
                # ì‚­ì œ í™•ì¸
                ! ls /u01/app/oracle/oradata/ORA19C/{sysaux01,users01}.dbf
                
                startup
                -- startup ì€ ëª¨ë“  recover ëŒ€ìƒ íŒŒì¼ì„ ì¡°íšŒí•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.
                -- alert.log í™•ì¸í•˜ì.
                -- ì•„ë‹ˆë©´ ì´ë ‡ê²Œ í™•ì‹¤í•˜ê²Œ í™•ì¸
                
                SYS@ora19c> select * from v$recover_file;
                
                     FILE# ONLINE  ONLINE_ ERROR                                                                CHANGE# TIME          CON_ID
                ---------- ------- ------- ----------------------------------------------------------------- ---------- --------- ----------
                         3 ONLINE  ONLINE  FILE NOT FOUND                                                             0                    0
                         7 ONLINE  ONLINE  FILE NOT FOUND                                                             0                    0
                
                SYS@ora19c> select a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
                from v$datafile a, v$tablespace b
                where a.ts# = b.ts#;
                
                  2    3
                     FILE# TBS_NAME                       FILE_NAME                                                              STATUS  CHECKPOINT_CHANGE#
                ---------- ------------------------------ ---------------------------------------------------------------------- ------- ------------------
                         1 SYSTEM                         /u01/app/oracle/oradata/ORA19C/system01.dbf                            SYSTEM             2854509
                         3 SYSAUX                         /u01/app/oracle/oradata/ORA19C/sysaux01.dbf                            ONLINE             2854509
                         4 UNDOTBS1                       /u01/app/oracle/oradata/ORA19C/undotbs01.dbf                           ONLINE             2854509
                         7 USERS                          /u01/app/oracle/oradata/ORA19C/users01.dbf                             ONLINE             2854509
                
                ```
                
            - 2ï¸âƒ£ ë³µêµ¬ ìˆ˜í–‰
                
                ë³µêµ¬ ìˆ˜í–‰í•  ë°ì´í„° íŒŒì¼ offline ë³€ê²½
                
                ```sql
                alter database datafile 3 offline;
                alter database datafile 7 offline;
                
                select a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
                from v$datafile a, v$tablespace b
                where a.ts# = b.ts#;
                ```
                
            - 3ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ open
                
                ```sql
                alter database open;
                ```
                
            - 4ï¸âƒ£ ê°€ì¥ ìµœê·¼ ë°±ì—…ë³¸ ì°¾ì•„ì„œ restore
                
                ```sql
                
                SYS@ora19c> ! cp -v /home/oracle/backup/arch/open/{sysaux01,users01}.dbf /u01/app/oracle/oradata/ORA19C
                
                ```
                
            - 5ï¸âƒ£ ë°±ì—… ì´í›„ ë¦¬ë‘ ì •ë³´ ì ìš©
                
                ```sql
                recover tablespace sysaux;
                recover tablespace users;
                ```
                
            - 6ï¸âƒ£ ë³µêµ¬ ì™„ë£Œ ë°ì´í„°íŒŒì¼ online ë³€ê²½
                
                ```sql
                alter database datafile 3 online;
                alter database datafile 7 online;
                ```
                
            
        - ğŸ“ì‹œìŠ¤í…œ í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ ì†ìƒ ë³µêµ¬
            - 1ï¸âƒ£ ì¥ì•  ìœ ë°œ
                
                ```sql
                ! rm /u01/app/oracle/oradata/ORA19C/system01.dbf
                
                == ìƒˆë¡œìš´ ì„¸ì…˜ì—ì„œ v$database ì¡°íšŒê°€ëŠ¥
                -- sys.obj$ ì¡°íšŒì‹œ ì˜¤ë¥˜ë‚¨.
                ```
                
            - 2ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ ì¢…ë£Œ
                
                ```sql
                shutdown abort
                ```
                
            - 3ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ ì‹œì‘ (ë¬¸ì œë˜ëŠ” íŒŒì¼ í™•ì¸)
                
                ```sql
                startup
                
                select * v$recover_file;
                select status from v$instance;  --mounted ê¹Œì§€
                
                ```
                
            - 4ï¸âƒ£ ìµœê·¼ ë°±ì—…ë³¸ ì°¾ì•„ì„œ restore
                
                ```sql
                ! ls /home/oracle/backup/arch/open/system01.dbf
                ! cp -v /home/oracle/backup/arch/open/system01.dbf /u01/app/oracle/oradata/ORA19C/
                ```
                
            - 5ï¸âƒ£ ë°±ì—… ì´í›„ ë¦¬ë‘ ì •ë³´ ì ìš©
                
                ```sql
                recover tablespace system
                ```
                
            - 6ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ open
                
                ```sql
                alter database open;
                ```
                
        - ğŸ“ ë°±ì—…ë°›ì§€ ì•Šì€ í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ ì†ìƒ
            - 1ï¸âƒ£ ë°ì´í„° ìƒì„±
                
                ```sql
                create tablespace data_tbs datafile '/u01/app/oracle/oradata/ORA19C/data_tbs01.dbf' size 10m;
                
                -- ë°±ì—… ì •ë³´ í™•ì¸
                select a.name, a.checkpoint_change#, b.status, b.change#, b.time
                from v$datafile a, v$backup b
                where a.file# = b.file#;
                
                NAME                                               CHECKPOINT_CHANGE# STATUS                CHANGE# TIME
                -------------------------------------------------- ------------------ ------------------ ---------- ---------
                /u01/app/oracle/oradata/ORA19C/system01.dbf                   2854512 NOT ACTIVE            2847704 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/sysaux01.dbf                   2855666 NOT ACTIVE            2847704 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/undotbs01.dbf                  2854512 NOT ACTIVE            2847704 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/data_tbs01.dbf                 2856296 NOT ACTIVE                  0
                /u01/app/oracle/oradata/ORA19C/users01.dbf                    2855675 NOT ACTIVE            2847704 21-JUL-25
                
                -- change# -> 0, time : null ë°±ì—…ë°›ì§€ ì•Šì€ ê²ƒ
                
                create table hr.data_test(id number) tablespace data_tbs;
                insert into hr.data_test(id) values(1);
                commit; 
                
                -- ğŸ“Œ  ë¦¬ë‘ ë¡œê·¸ ì •ë³´ í™•ì¸
                SELECT a.group#, b.sequence#, a.member, b.status, b.first_change#, b.first_time, b.next_change#, b.next_time
                FROM v$logfile a, v$log b
                WHERE a.group# = b.group#
                ORDER BY b.group#;
                
                    GROUP#  SEQUENCE# MEMBER
                ---------- ---------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                         1         13 /u01/app/oracle/oradata/ORA19C/redo01.log
                         2         11 /u01/app/oracle/oradata/ORA19C/redo02.log
                         3         12 /u01/app/oracle/oradata/ORA19C/redo03.log
                
                alter system switch logfile;
                /
                /
                
                ```
                
            - 2ï¸âƒ£ ì¥ì•  ë°œìƒ
                
                ```sql
                ! ls /u01/app/oracle/oradata/ORA19C/data_tbs01.dbf
                ! rm /u01/app/oracle/oradata/ORA19C/data_tbs01.dbf
                ! ls /u01/app/oracle/oradata/ORA19C/data_tbs01.dbf
                
                shutdown immediate
                ```
                
            - 3ï¸âƒ£ ë³µêµ¬ ì§„í–‰
                
                ```sql
                conn / as sysdba
                ```
                
                ë°ì´í„°ë² ì´ìŠ¤ ì‹œì‘(ë¬¸ì œ ë°œìƒ í™•ì¸)
                
                ```sql
                startup
                select * from v$recover_file;
                
                    FILE# ONLINE  ONLINE_ ERROR                                                                CHANGE# TIME          CON_ID
                ---------- ------- ------- ----------------------------------------------------------------- ---------- --------- ----------
                         5 ONLINE  ONLINE  FILE NOT FOUND                                                             0                    0
                
                -- í™•ì¸
                -- ğŸ“Œ ë°ì´í„°íŒŒì¼ ë° í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ ìƒíƒœ í™•ì¸
                SELECT a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
                FROM v$datafile a, v$tablespace b
                WHERE a.ts# = b.ts#;
                
                     FILE# TBS_NAME                       FILE_NAME                                                              STATUS  CHECKPOINT_CHANGE#
                ---------- ------------------------------ ---------------------------------------------------------------------- ------- ------------------
                         1 SYSTEM                         /u01/app/oracle/oradata/ORA19C/system01.dbf                            SYSTEM             2857699
                         3 SYSAUX                         /u01/app/oracle/oradata/ORA19C/sysaux01.dbf                            ONLINE             2857699
                         4 UNDOTBS1                       /u01/app/oracle/oradata/ORA19C/undotbs01.dbf                           ONLINE             2857699
                         7 USERS                          /u01/app/oracle/oradata/ORA19C/users01.dbf                             ONLINE             2857699
                         5 DATA_TBS                       /u01/app/oracle/oradata/ORA19C/data_tbs01.dbf                          ONLINE             2857699
                
                -- ë°±ì—… ì •ë³´ í™•ì¸
                
                select a.name, a.checkpoint_change#, b.status, b.change#, b.time
                from v$datafile a, v$backup b
                where a.file# = b.file#;
                
                NAME                                               CHECKPOINT_CHANGE# STATUS                CHANGE# TIME
                -------------------------------------------------- ------------------ ------------------ ---------- ---------
                /u01/app/oracle/oradata/ORA19C/system01.dbf                   2857699 NOT ACTIVE            2847704 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/sysaux01.dbf                   2857699 NOT ACTIVE            2847704 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/undotbs01.dbf                  2857699 NOT ACTIVE            2847704 21-JUL-25
                /u01/app/oracle/oradata/ORA19C/data_tbs01.dbf                 2857699 FILE NOT FOUND              0
                /u01/app/oracle/oradata/ORA19C/users01.dbf                    2857699 NOT ACTIVE            2847704 21-JUL-25
                
                alter database datafile 5 offline;
                ```
                
                    
                
            - 4ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ open
                
                ```sql
                alter database open;
                
                -- í™•ì¸ select count(*) from hr.employees;
                ```
                
            - 5ï¸âƒ£ ë°±ì—… ë°›ì§€ ì•Šì€ í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ì— ì†í•œ íŒŒì¼ ì¬ìƒì„±
                
                ```sql
                ! ls /u01/app/oracle/oradata/ORA19C/data_tbs.dbf
                
                -- ì¬ìƒì„±
                alter database create datafile '/u01/app/oracle/oradata/ORA19C/data_tbs01.dbf';
                
                ```
                
            
               ğŸ“ ë°±ì—… ë°›ì§€ ì•Šì€ í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ì— ì†í•œ íŒŒì¼ ì¬ìƒì„±
            
            ```sql
            alter databases create datafile '/u01/app/oracle/oradata/ORA19C/data_tbs01.dbf' as '/home/oracle/backup/
            
            ```
            
            - 6ï¸âƒ£ í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ ìƒì„± ì‹œì ë¶€í„° í˜„ì¬ê¹Œì§€ ë¦¬ë‘ ì •ë³´ ì ìš©
                
                ```sql
                recover tablespace data_tbs;
                
                -- alter.log ë³´ë©´ì„œ í˜„ì¬ê¹Œì§€ ë¦¬ë‘ ì •ë³´ ì ìš©
                ```
                
            - 7ï¸âƒ£ ë³µêµ¬ ì™„ë£Œëœ ëŒ€ìƒ ë°ì´í„° íŒŒì¼ online
                
                ```sql
                alter database datafile 5 online;
                ```
                
            
        - ğŸ“ íŠ¹ì •í•œ í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•´ì„œ ë°±ì—…
            
            ```sql
            alter tablespace data_tbs begin backup;
            -- ë°±ì—… ì •ë³´ í™•ì¸
            select a.name, a.checkpoint_change#, b.status, b.change#, b.time
            from v$datafile a, v$backup b
            where a.file# = b.file#;
            
            -- ë¬¼ë¦¬ì  ì¥ì†Œì— ì¹´í”¼
            ! cp -v /u01/app/oracle/oradata/ORA19C/data_tbs01.dbf /home/oracle/backup/arch/open
            
            alter tablespace data_tbs end backup;
            select a.name, a.checkpoint_change#, b.status, b.change#, b.time
            from v$datafile a, v$backup b
            where a.file# = b.file#;
            
            -- í˜„ì¬ ì»¨íŠ¸ë¡¤íŒŒì¼ ë°±ì—…
            alter database backup controlfile to '/home/oracle/backup/arch/open/control01_202507211628.ctl';
            
            -- í˜„ì¬ ë¦¬ë‘ ì •ë³´ë¥¼ archive ë°›ì
            alter system archive log current;
            ```
            
        - ğŸ“ í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ì— ì†í•œ ì—¬ëŸ¬ ë°ì´í„° íŒŒì¼ë“¤ ì¤‘ì— íŠ¹ì •í•œ íŒŒì¼ì´ ì†ìƒë˜ì—ˆì„ ê²½ìš°
            
            ```sql
            SELECT a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
            FROM v$datafile a, v$tablespace b
            WHERE a.ts# = b.ts#;
            
            --  ê¸°ì¡´ í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ì— ìƒˆ ë°ì´í„°íŒŒì¼ ì¶”ê°€
            ALTER TABLESPACE data_tbs 
            ADD DATAFILE '/u01/app/oracle/oradata/ORA19C/data_tbs02.dbf' SIZE 5M;
            
            -- ì¶”ê°€ í›„ ë°ì´í„°íŒŒì¼ ëª©ë¡ ì¬ì¡°íšŒ
            SELECT a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
            FROM v$datafile a, v$tablespace b
            WHERE a.ts# = b.ts#;
            
            --í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ì˜ ì´ ìš©ëŸ‰ / ì‚¬ìš© ìš©ëŸ‰ / ì—¬ìœ  ê³µê°„ì„ MB ë‹¨ìœ„ë¡œ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬
            SELECT a.tablespace_name,b.file_name,  b.bytes/1024/1024 "Total Size MB", (b.bytes - c.free_byte)/1024/1024 "Used Size MB", c.free_byte/1024/1024 "Free Size MB",  b.autoextensible
            FROM dba_tablespaces a, dba_data_files b,    (SELECT tablespace_name, file_id, sum(bytes) free_byte   
                                                           FROM dba_free_space    
                                                        GROUP BY tablespace_name, file_id) c
                                                        WHERE a.tablespace_name = b.tablespace_name
                                                        AND a.tablespace_name = c.tablespace_name
            AND b.file_id = c.file_id;
            
            --  HR ìŠ¤í‚¤ë§ˆì˜ DATA_TEST ì„¸ê·¸ë¨¼íŠ¸ê°€ ì–´ë–¤ ë°ì´í„°íŒŒì¼(.dbf)ì— ì¡´ì¬í•˜ëŠ”ì§€ ì¡°íšŒ
            SELECT f.file_name 
            FROM dba_extents e, dba_data_files f 
            WHERE e.file_id = f.file_id 
              AND e.segment_name = 'DATA_TEST' 
              AND e.owner = 'HR';
              
            -- í…Œì´ë¸” ìƒì„± 
            CREATE TABLE hr.test_2025 
            TABLESPACE data_tbs 
            AS 
            SELECT * FROM hr.employees;  
            
            -- í™•ì¸
            SELECT f.file_name 
            FROM dba_extents e, dba_data_files f 
            WHERE e.file_id = f.file_id 
              AND e.segment_name = 'DATA_TEST' 
              AND e.owner = 'HR';
              
            -- ì˜ë„ì ìœ¼ë¡œ ëŒ€ëŸ‰ì˜ ë°ì´í„° ë°œìƒí•˜ê²Œ 
            INSERT INTO hr.test_2025 
            SELECT * FROM hr.test_2025;
            /
            /
            /
            /
            /...
            
            -- í™•ì¸
            SELECT f.file_name
            FROM dba_extents e, dba_data_files f
            WHERE e.file_id = f.file_id
              AND e.segment_name = 'TEST_2025'
              AND e.owner = 'HR';
            ```
            
           ![image.png](/assets/20250721/1.png)
            
            ```sql
            SELECT f.file_name, COUNT(*)
            FROM dba_extents e, dba_data_files f
            WHERE e.file_id = f.file_id
              AND e.segment_name = 'TEST_2025'
              AND e.owner = 'HR'
            GROUP BY f.file_name;
            
            --  í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ ì‚¬ìš©ëŸ‰ ì¡°íšŒ ì¿¼ë¦¬
            
            SELECT a.tablespace_name,
                   b.file_name,
                   b.bytes/1024/1024 AS "Total Size MB",
                   (b.bytes - c.free_byte)/1024/1024 AS "Used Size MB",
                   c.free_byte/1024/1024 AS "Free Size MB",
                   b.autoextensible
            FROM dba_tablespaces a,
                 dba_data_files b,
                 (SELECT tablespace_name, file_id, SUM(bytes) AS free_byte
                  FROM dba_free_space
                  GROUP BY tablespace_name, file_id) c
            WHERE a.tablespace_name = b.tablespace_name
              AND a.tablespace_name = c.tablespace_name
              AND b.file_id = c.file_id;
            ```
            
        - ğŸ“íŠ¹ì •í•œ í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ì— ì†í•œ ë°ì´í„°íŒŒì¼ ë°±ì—…
            - ë°±ì—…
                
                ```sql
                alter tablespace data_tbs begin backup;
                ! cp -v /u01/app/oracle/oradata/ORA19C/data_tbs02.dbf /home/oracle/backup/arch/open/
                ALTER TABLESPACE data_tbs END BACKUP;
                
                select a.name, a.checkpoint_change#, b.status, b.change#, b.time
                from v$datafile a, v$backup b
                where a.file# = b.file#;
                
                !
                ```
                
            - 1ï¸âƒ£ ì¥ì•  ë°œìƒ
                
                ```sql
                -- ğŸ“ŒíŠ¹ì • ë°ì´í„° íŒŒì¼ ê²½ë¡œ í™•ì¸
                ! ls /u01/app/oracle/oradata/ORA19C/data_tbs02.dbf
                
                -- ğŸ“Œì¥ì•  ìœ ë°œ (ë°ì´í„° íŒŒì¼ ì†ìƒ)
                ! rm /u01/app/oracle/oradata/ORA19C/data_tbs02.dbf
                ```
                
            - 2ï¸âƒ£ ë³µêµ¬ ì‘ì—…
                
                ë³µêµ¬ ìˆ˜í–‰í•´ì•¼í•  í…Œì´ë¸” ìŠ¤í˜ì´ìŠ¤ì— ëŒ€í•´ì„œ offline temporary (ê°€ëŠ¥í•œ íŒŒì¼ë“¤ë§Œ checkpoint ë°œìƒ)
                
                ```sql
                alter tablespace data_tbs offline temporary
                
                -- ğŸ“Œ ë°ì´í„°íŒŒì¼ ë° í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ ìƒíƒœ í™•ì¸
                SELECT a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
                FROM v$datafile a, v$tablespace b
                WHERE a.ts# = b.ts#;
                
                ```
                
                ë³µêµ¬ ìˆ˜í–‰í•´ì•¼í•  ë°ì´í„°íŒŒì¼ ë°±ì—…ì„ ì°¾ì•„ì„œ restore
                
                ```sql
                ! ls /home/oracle/backup/arch/open/data_tbs02.dbf
                ! cp -v /home/oracle/backup/arch/open/data_tbs02.dbf /u01/app/oracle/oradata/ORA19C/
                ```
                
                ë°±ì—… ì´í›„ ë¦¬ë‘ ì •ë³´ ì ìš©
                
                ```sql
                RECOVER TABLESPACE data_tbs;
                ```
                
                ë³µêµ¬ ì‘ì—… ì™„ë£Œëœ í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ online
                
                ```sql
                ALTER TABLESPACE data_tbs ONLINE;
                
                SELECT a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
                FROM v$datafile a, v$tablespace b
                WHERE a.ts# = b.ts#;
                
                SELECT COUNT(*) FROM hr.test_2025;
                
                COUNT(*)
                --------
                54784
                ```
                
                í…ŒìŠ¤íŠ¸ìš© ì‚­ì œ
                
                ```sql
                DROP TABLESPACE data_tbs INCLUDING CONTENTS AND DATAFILES;
                
                ! ls /home/oracle/backup/arch/open/data_tbs{01,02}.dbf
                ! rm /home/oracle/backup/arch/open/data_tbs{01,02}.dbf
                ! rm -i /home/oracle/backup/arch/open/control01_202507211628.ctl
                ```