---
title: "[62ì¼ì°¨] Backup & Recovery7_1"
excerpt: "ì•„ì´í‹°ìœŒ 0722"
categories:
      - ORACLE11g
tags:
      - ORACLE11g
      - TIL
last-modified-at: 2025-07-22T18:26
---

# ë°±ì—… & ë¦¬ì»¤ë²„ë¦¬ 7-1

ë‚ ì§œ: 2025ë…„ 7ì›” 22ì¼
ìœ í˜•: 62ì¼ì°¨, archive, ë°±ì—…ë¦¬ì»¤ë²„ë¦¬
í¬íŠ¸í´ë¦¬ì˜¤: ë¯¸ì™„ë£Œ

```sql
select sequence#, name, first_change#, next_change# from v$archived_log;

 SEQUENCE# NAME                                               FIRST_CHANGE# NEXT_CHANGE#
---------- -------------------------------------------------- ------------- ------------
        11 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2767692      2849125
        12 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2849125      2849255
        13 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2849255      2857693
        14 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2857693      2857696
        15 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2857696      2857699
        16 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2857699      2958854
```

ğŸ“ archive log fileì´ ìƒì„±ë  ìœ„ì¹˜ë¥¼ ìˆ˜ì •

â–¶ï¸ ì•„ì¹´ì´ë¸Œ ë°±ê·¸ë¼ìš´ë“œ í”„ë¡œì„¸ì„œ

```sql
SYS@ora19c> ! ps -ef | grep arc
oracle   16114     1  0 17:46 ?        00:00:00 ora_arc0_ora19c
oracle   16116     1  0 17:46 ?        00:00:00 ora_arc1_ora19c
oracle   16118     1  0 17:46 ?        00:00:00 ora_arc2_ora19c
oracle   16120     1  0 17:46 ?        00:00:00 ora_arc3_ora19c
oracle   29467 27424  0 19:35 pts/1    00:00:00 /bin/bash -c  ps -ef | grep arc
oracle   29469 29467  0 19:35 pts/1    00:00:00 grep arc
```

â–¶ï¸ ë””ë ‰í† ë¦¬ 2ê°œ ë§Œë“¤ê¸°

```sql
[oracle@oracle ~]$ mkdir  arch1 arch2
---> arch1 ì•ˆì—ëŠ” ì˜¨ë¼ì¸ ë°±ì—… ì¤‘ ìƒì„±ëœ ì•„ì¹´ì´ë¸Œ ë¡œê·¸ íŒŒì¼ ì €ì¥ë  ê²ƒ 
[oracle@oracle ~]$ ls
arch1  backup                create_control.sql  Documents  Downloads   LINUX.X64_193000_db_home.zip  Music            Pictures  Templates  Videos
arch2  control_20250718.txt  Desktop             dontouch   glogin.sql  login.sql                     new_control.txt  Public    userdata
[oracle@oracle ~]$ exit
exit
```

â–¶ï¸ ìœ„ì¹˜ ìˆ˜ì •

ğŸŒ³ mandatory : archive ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì–´ì•¼ redo log file ë¥¼ ê²¹ì³ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ë§Œì•½ì— mandatoryë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ê³³ì— ê³µê°„ì´ ë¶€ì¡±í•  ê²½ìš°

ğŸŒ³ optional : archive ì‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì§€ ì•Šì€ ê²½ìš°ì—ë„ redo log fileë¥¼ ê²¹ì³ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ê³µê°„ì´ ë¶€ì¡±í•˜ë©´ archive log file ì´ ìƒì„±ë˜ì§€ ì•ŠëŠ”ë‹¤. ê¸°ë³¸ê°’ 

```sql
alter system set log_archive_dest_1 = "location=/home/oracle/arch1 mandatory" scope = spfile;
alter system set log_archive_dest_2 = "location=/home/oracle/arch2 mandatory" scope = spfile;
```

â–¶ï¸ archive log file ì´ë¦„ í¬ë§·

**[í•„ìˆ˜]**

ğŸŒ³ %t : THREAD#. instance number

ğŸŒ³ %s : SEQUENCE#, log sequence number

ğŸŒ³ %r : Resetlogs ID, ì—¬ëŸ¬ ë°ì´í„°ë² ì´ìŠ¤ì— ê±¸ì³ ì•„ì¹´ì´ë¸Œëœ ë¡œê·¸ íŒŒì¼ì˜ ìœ ì¼í•œ ì´ë¦„ì„ ë‚˜íƒ€ë‚¸ë‹¤. (ì ˆëŒ€ ê²¹ì ¸ì§€ì§€ ì•Šì€ ê³ ìœ í•œ ë°ì´í„°ë² ì´ìŠ¤)

```sql
show parameter log_archive_format

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
log_archive_format                   string      %t_%s_%r.dbf
```

â–¶ï¸ archive log file ì´ë¦„ í¬ë§· ìˆ˜ì •

ğŸ“ /u01/app/oracle/oradata/ORA19C/users01.dbf ì†ìƒ

```sql
SYS@ora19c> alter system set log_archive_format = 'arch_%t_%s_%r .arc' scope = spfile;

System altered.

SYS@ora19c> shutdown immediate
Database closed.
Database dismounted.
ORACLE instance shut down.
SYS@ora19c> startup
ORACLE instance started.

Total System Global Area  713027608 bytes
Fixed Size                  8900632 bytes
Variable Size             507510784 bytes
Database Buffers          188743680 bytes
Redo Buffers                7872512 bytes
Database mounted.
Database opened.

SYS@ora19c> archive log list
Database log mode              Archive Mode
Automatic archival             Enabled
Archive destination            /home/oracle/arch2
Oldest online log sequence     15

show parameter log

log_archive_format                   string      arch_%t_%s_%r .arc

select destination,binding,status from v$archive_dest where destination is not null;

DESTINATION
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
/home/oracle/arch1
/home/oracle/arch2

-- í˜„ì¬ ë¦¬ë‘ ë¡œê·¸ ì •ë³´ ì¡°íšŒ
SELECT a.group#, b.sequence#, a.member, b.status, b.first_change#, b.first_time, b.next_change#, b.next_time
FROM v$logfile a, v$log b
WHERE a.group# = b.group#
ORDER BY b.group#;

 GROUP#  SEQUENCE# MEMBER
---------- ---------- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
         1         16 /u01/app/oracle/oradata/ORA19C/redo01.log
         2         17 /u01/app/oracle/oradata/ORA19C/redo02.log
         3         15 /u01/app/oracle/oradata/ORA19C/redo03.log

alter system switch logfile;

SYS@ora19c> select sequence#, name, first_change#, next_change# from v$archived_log;

 SEQUENCE# NAME                                               FIRST_CHANGE# NEXT_CHANGE#
---------- -------------------------------------------------- ------------- ------------
        11 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2767692      2849125
        12 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2849125      2849255
        13 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2849255      2857693
        14 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2857693      2857696
        15 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2857696      2857699
        16 /u01/app/oracle/fast_recovery_area/ORA19C/archivel       2857699      2958854
        17 /home/oracle/arch1/arch_1_17_1205348976_.arc             2958854      2972348
        17 /home/oracle/arch2/arch_1_17_1205348976_.arc             2958854      2972348
        18 /home/oracle/arch1/arch_1_18_1205348976_.arc             2972348      2972396
        18 /home/oracle/arch2/arch_1_18_1205348976_.arc             2972348      2972396

```

1ï¸âƒ£ ì†ìƒëœ íŒŒì¼ì´ ìˆëŠ” í…Œì´ë¸”ìŠ¤í˜ì´ìŠ¤ë¥¼ offlineìœ¼ë¡œ ì„¤ì •

```sql
alter tablespace users offline immediate;
```

2ï¸âƒ£ ìµœê·¼ ë°±ì—…ë³¸ ì°¾ì•„ì„œ restore

```sql
 ! ls /home/oracle/backup/arch/open/users01.dbf
```

3ï¸âƒ£ ë°±ì—… ì´í›„ ë¦¬ë‘ ì •ë³´ ì ìš©

![image.png](/assets/20250722/1.png)

```sql
! ls /home/oracle/arch1
```

![1)](/assets/20250722/2.png)

1)

![2)](/assets/20250722/3.png)

2)

```sql
ë§¨ë§ˆì§€ë§‰ ë¦¬ë‘ ì •ë³´ëŠ” auto ì…ë ¥í•˜ë©´ ì•Œì•„ì„œ ì ìš©ëœë‹¤.
```

4ï¸âƒ£ ë³µêµ¬ ì™„ë£Œëœ í…Œì´ë¸” ìŠ¤í˜ì´ìŠ¤ online

```sql
alter tablespace users online;
```