---
title: "[33ì¼ì°¨] ì´ì°¨ì› ë°°ì—´ "
excerpt: "ì•„ì´í‹°ìœŒ 0609_(2) ì—°ê´€ë°°ì—´, ì¤‘ì²©í…Œì´ë¸”, varray "
categories:
      - ORACLE11g
tags:
      - ORACLE11g
      - TIL
last-modified-at: 2025-06-09T18:15
---

# 2ì°¨ì› ë°°ì—´

ğŸ“ **2ì°¨ì› ë°°ì—´ì€ record íƒ€ì…ì„ í™œìš©í•´ì„œ ìƒì„±í•´ì•¼ ëœë‹¤.**

â¡ **1ì°¨ì› ë°°ì—´ ( ex. 1:50 , 2: 'Shipping', 3: 121 , 4 :1500)**

```sql
DECLARE
 TYPE dept_rec_type IS RECORD(
	 id number, name varchar(30), mgr number, loc number
	 );
v_rec dept_rec_type;	 

BEGIN
  FOR i IN 1..5 LOOP
	SELECT *
	INTO v_rec
	FROM hr.departments
    WHERE department_id = i *10;
  END LOOP;  
  
  dbms_output.put_line(v_rec.id);
  dbms_output.put_line(v_rec.name);
  dbms_output.put_line(v_rec.mgr);
  dbms_output.put_line(v_rec.loc);
  
END;
/
  
```

â–¶ï¸ **2ì°¨ì› ë°°ì—´ (1 : 10, 'Administration' , 200,1700, 2 : 20, 'Marketing', 201, 1800 ...)**

```sql
DECLARE
 TYPE dept_rec_type IS RECORD(
	 id number, name varchar(30), mgr number, loc number
	 );
	 
v_rec dept_rec_type;	 

TYPE dept_tab_type IS TABLE OF v_rec%TYPE INDEX BY pls_integer;
v_tab dept_tab_type;

BEGIN
  FOR i IN 1..5 LOOP
	SELECT *
	INTO v_tab(i)
	FROM hr.departments
    WHERE department_id = i *10;
  END LOOP;  
 
 FOR i IN v_tab.first..v_tab.last LOOP 
  dbms_output.put_line(v_tab(i).id);
  dbms_output.put_line(v_tab(i).name);
  dbms_output.put_line(v_tab(i).mgr);
  dbms_output.put_line(v_tab(i).loc);
 END LOOP; 
   
END;
/
```

â–¶ï¸ %rowtypeì„ ì´ìš©í•´ì„œ ì†ì‰½ê²Œ ì´ì°¨ì› ë°°ì—´ ì„ ì–¸

```sql
DECLARE
    TYPE dept_tab_type IS TABLE OF departments%rowtype INDEX BY pls_integer;
    v_tab dept_tab_type;	 

BEGIN
  FOR i IN 1..5 LOOP
	SELECT *
	INTO v_tab(i)
	FROM hr.departments
    WHERE department_id = i *10;
  END LOOP;  
 
 FOR i IN v_tab.first..v_tab.last LOOP 
  dbms_output.put_line(v_tab(i).department_id);
  dbms_output.put_line(v_tab(i).department_name);
  dbms_output.put_line(v_tab(i).manager_id);
  dbms_output.put_line(v_tab(i).location_id);
 END LOOP; 
   
END;
/
```

## ì¤‘ì²© í…Œì´ë¸”(Nested table)

- ì¤‘ì²© í…Œì´ë¸”ì€ ìµœëŒ€ 2Gbyteê¹Œì§€ ë™ì ìœ¼ë¡œ ì¦ê°€í•  ìˆ˜ ìˆë‹¤.
- ë°°ì—´ ë³€ìˆ˜ì— **ì €ì¥í•˜ëŠ” ê°’ë“¤ì„ ë¯¸ë¦¬ ì•Œê³  ìˆì„ ë•Œ ì‚¬ìš©**í•˜ë©´ í¸ë¦¬í•˜ë‹¤.
- ì—°ê´€ ë°°ì—´ê³¼ ë‹¬ë¦¬ keyëŠ” ìë™ìœ¼ë¡œ 1ë²ˆë¶€í„° ì‹œì‘í•´ì„œ ë§Œë“¤ì–´ì§„ë‹¤.
- ì¤‘ì²© í…Œì´ë¸”ì€ ì„ ì–¸ì‹œ ì´ˆê¸°í™”ê°€ ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤.

```sql
DECLARE
		/* ì¤‘ì²© í…Œì´ë¸” */
		TYPE id_type IS TABLE OF number;		-- í‚¤ ê°’ì„ ë”°ë¡œ ì•ˆì¤˜ë„ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì§.
		v_id id_type := id_type(100,101,200,105,103,107); 

		
BEGIN
		FOR i IN v_id.first..v_id.last LOOP
				dbms_output.put_line(v_id(i));
		END LOOP;
		dbms_output.put_line(v_id.count);
END;
/
```

## ì—°ê´€ ë°°ì—´ vs ì¤‘ì²© í…Œì´ë¸”

```sql
DECLARE
		/* ì—°ê´€ ë°°ì—´  */
		TYPE id_type IS TABLE OF number INDEX BY pls_integer;		
		v_id id_type;

		
BEGIN
        v_id(1) := 100;
        v_id(2) := 101;
        v_id(3) := 200;
        v_id(4) := 105;
        v_id(5) := 103;  
        v_id(6) := 107;
     
		FOR i IN v_id.first..v_id.last LOOP
				dbms_output.put_line(v_id(i));
		END LOOP;
		dbms_output.put_line(v_id.count);
END;
/

---------------------------------------------------------------------------------

DECLARE
		/* ì¤‘ì²© í…Œì´ë¸” */
		TYPE id_type IS TABLE OF number;		
		v_id id_type := id_type(100,101,200,105,103,107); 

		
BEGIN
		FOR i IN v_id.first..v_id.last LOOP
				dbms_output.put_line(v_id(i));
		END LOOP;
		dbms_output.put_line(v_id.count);
		
		-- ì¤‘ì²© í…Œì´ë¸”ì˜ ëì— ìš”ì†Œë¥¼ ì¶”ê°€í•œë‹¤.
		v_id.extend;
		v_id(7) := 109;
		
		-- â–¶ï¸ ì¤‘ê°„ì— ê°’ì„ ì§‘ì–´ë„£ëŠ” ë°©ë²•ì€ ì„ ì–¸í•  ë•Œ ì§ì ‘ ë„£ëŠ” ë°©ë²• ë°–ì— ì—†ë‹¤.
		-- â–¶ï¸ v_id.extend(ìš”ì†Œ ìˆ˜) : ì¤‘ì²© í…Œì´ë¸”ì˜ ëì— ìš”ì†Œ ìˆ˜ë§Œí¼ ìš”ì†Œë¥¼ ì¶”ê°€í•œë‹¤.
END;
/

/*
100
101
200
105
103
107
6
*/
```

â–¶ï¸ ì´ë ‡ê²Œ ê°‘ì„ í• ë‹¹í•´ë„ ëœë‹¤.

```sql
 DECLARE
		/* ì¤‘ì²© í…Œì´ë¸” */
		TYPE id_type IS TABLE OF number;		
		v_id id_type; 
		
BEGIN
		v_id := id_type(100,101,200,105,103,107);
		
		FOR i IN v_id.first..v_id.last LOOP
				dbms_output.put_line(v_id(i));
		END LOOP;
END;
/
```

## **extend(ë³µì‚¬í•  ê°¯ìˆ˜, ìš”ì†Œ ì¸ë±ìŠ¤)**

```sql
DECLARE
		/* ì¤‘ì²© í…Œì´ë¸” */
		TYPE id_type IS TABLE OF number;		
		v_id id_type := id_type(100,101,200,105,103,107); 

		
BEGIN
		v_id.extend(3,1); -- 1ë²ˆ ìš”ì†Œì˜ ê°’ì„ 3ë²ˆ ë³µì‚¬í•œë‹¤.
		FOR i IN v_id.first..v_id.last LOOP
				dbms_output.put_line(v_id(i));
		END LOOP;
END;
/
```

## ìš”ì†Œ ê°’ ìˆ˜ì •

```sql
DECLARE
		/* ì¤‘ì²© í…Œì´ë¸” */
		TYPE id_type IS TABLE OF number;		
		v_id id_type := id_type(100,101,200,105,103,107); 
BEGIN
	v_id.trim; -- ì œì¼ ë§ˆì§€ë§‰ ìš”ì†Œ ì‚­ì œ
	v_id(2) := 109 -- ìš”ì†Œê°’ ìˆ˜ì •
	v_id.delete(6); -- ìš”ì†Œ ì‚­ì œ
	
	FOR i IN v_id.first..v_id.last LOOP
				dbms_output.put_line(v_id(i));
	END LOOP;
END;
```

## VARRAY(Variable Size Array)

- ê³ ì •ëœ ìƒí•œ ê°’ì´ ìˆë‹¤.
- ìµœëŒ€ í¬ê¸°ëŠ” 2Gbyte

```sql
DECLARE
		/* varray */
		TYPE id_type IS VARRAY(6) OF number;		
		v_id id_type := id_type(100,101,200,105,103,107); 
BEGIN
	FOR i IN v_id.first..v_id.last LOOP
				dbms_output.put_line(v_id(i));
	END LOOP;
END;
```

â–¶ï¸ ê³ ì •ëœ ìƒí•œ ê°’ì„ ì´ˆê³¼í•˜ê²Œ ë˜ë©´ ì˜¤ë¥˜ ë°œìƒ

```sql
DECLARE
		/* varray */
		TYPE id_type IS VARRAY(5) OF number;		
		v_id id_type := id_type(100,101,200,105,103,107); 
BEGIN
	FOR i IN v_id.first..v_id.last LOOP
				dbms_output.put_line(v_id(i));
	END LOOP;
END;

-- ORA-06532: Subscript outside of limit
```

â–¶ï¸ ì…ë ¥ ê°’ ê°¯ìˆ˜ë³´ë‹¤ ìƒí•œ ê°’ì´ í´ ë•Œ

```sql
DECLARE
		/* varray */
		TYPE id_type IS VARRAY(10) OF number;		
		v_id id_type := id_type(100,101,200,105,103,107); 
BEGIN
    dbms_output.put_line(v_id.count);
   -- ê³µê°„ ì •ì˜ë¥¼ 10ë§Œí¼ í–ˆë”ë¼ë„ ì…ë ¥ê°’ ë§Œí¼ë§Œ ê°€ì§€ê³  ìˆì–´ ê°’ì„ ì¶”ê°€í•˜ë ¤ê³  í•˜ë©´ ì˜¤ë¥˜. 
   -- extend ì´ìš©
    v_id.extend; 
    v_id(7) := 111;
	FOR i IN v_id.first..v_id.last LOOP
				dbms_output.put_line(v_id(i));
	END LOOP;
END;
```

â–¶ï¸ VARRAY ì—ì„œëŠ” delete ì‚¬ìš© ë¶ˆê°€, ëŒ€ì‹  trim ì‚¬ìš©í•˜ì.

```sql

DECLARE
		TYPE id_type IS VARRAY(6) OF number;		
		v_id id_type := id_type(100,101,200,105,103,107); 
BEGIN

    -- v_id.delete(6);  varray ì—ì„œëŠ” delete ì‚¬ìš© ë¶ˆê°€ 
    v_id.trim(2); -- ëŒ€ì‹  trimì„ ì´ìš©í•˜ì. ì œì¼ ë’¤ì— 2ê°œ ìš”ì†Œë¥¼ ì œê±°í•œë‹¤.
	FOR i IN v_id.first..v_id.last LOOP
				dbms_output.put_line(v_id(i));
	END LOOP;
END;

/*
100
101
200
105
*/

```