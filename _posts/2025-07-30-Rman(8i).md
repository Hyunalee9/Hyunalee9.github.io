---
title: "[67ÏùºÏ∞®] RMAN(8i) "
excerpt: "ÏïÑÏù¥Ìã∞Ïúå 0730"
categories:
      - ORACLE19c
tags:
      - ORACLE19c
      - TIL
last-modified-at: 2025-07-30T21:08
---

# RMAN(8i)

## Recovery Manager

- RMANÏùÄ Ïò§ÎùºÌÅ¥ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ÏóêÏÑú Î∞±ÏóÖ, Î≥µÍµ¨ ÏûëÏóÖÏùÑ Í¥ÄÎ¶¨ÌïòÎäîÎç∞ ÏÇ¨Ïö©ÌïòÎäî Ïò§ÎùºÌÅ¥ Ïú†Ìã∏Î¶¨Ìã∞Ïù¥Îã§.
- RMANÏùÄ Ïö¥ÏòÅÏ≤¥Ï†úÏóêÏÑú **ÎèÖÎ¶ΩÏ†ÅÏù∏ Î™ÖÎ†π Ïñ∏Ïñ¥Î•º ÏÇ¨Ïö©**ÌïúÎã§.

```bash
-- ÎèÖÎ¶ΩÌòï Î™ÖÎ†π (stand alone)
backup database;

-- ÏûëÏóÖÌòï Î™ÖÎ†π (Ïó¨Îü¨ Í∞úÏùò Î™ÖÎ†πÏñ¥Î•º ÌïúÎ≤àÏóê ÏÇ¨Ïö©Ìï† Ïàò ÏûàÎäî Î∞©Î≤ï)
run{
	allocate channel ch1 type disk
	format ...
	
	...
}
```

- RMAN RepositoryÎäî target databaseÏôÄ backup, recovery ÏûëÏóÖÏóê ÎåÄÌïú Î©îÌÉÄÎç∞Ïù¥ÌÑ∞Ïù¥Îã§. repositoryÎäî Ìï≠ÏÉÅ target databaseÏùò control fileÏóê Ï†ÄÏû•ÎêúÎã§.

**Îî∞Î°ú Ï†ïÎ¶¨Ìïú RMANÏùò Ï£ºÏöî ÌäπÏßï**

1Ô∏è‚É£ **ÏûêÏ£º Ïã§ÌñâÌïòÎäî ÏûëÏóÖÏùÑ Ïä§ÌÅ¨Î¶ΩÌä∏Î°ú Ï†ÄÏû•**

- RMAN Recovery Catalog ServerÎ•º ÏÇ¨Ïö©Ìï† Í≤ΩÏö∞ ÏûêÏ£º ÏÇ¨Ïö©ÌïòÎäî Î∞±ÏóÖ Î™ÖÎ†πÏñ¥Îì§ÏùÑ Ïä§ÌÅ¨Î¶ΩÌä∏Î°ú Ï†ÄÏû•Ìïú ÌõÑ Î∂àÎü¨ÏÑú ÏÇ¨Ïö©Ìï† Ïàò ÏûàÎã§.

2Ô∏è‚É£ **Ï¶ùÎ∂Ñ Î∏îÎ°ù Î†àÎ≤® Î∞±ÏóÖ Í∏∞Îä• ÏßÄÏõê**

- Í≥ºÍ±∞Ïóê Î∞±ÏóÖ Î∞õÏùÄ ÎÇ¥Ïó≠ÏùÑ Ï°∞ÏÇ¨Ìï¥ Í∑∏ Í∏∞Ï§Ä Î∞±ÏóÖ Ïù¥ÌõÑÏóê Î≥ÄÍ≤ΩÎêú Î∏îÎ°ùÎßåÏ∞æÏïÑ Î∞±ÏóÖÏùÑ ÏàòÌñâÌï† Ïàò ÏûàÎã§. Î∞±ÏóÖ ÏãúÍ∞ÑÏùÑ Îã®Ï∂ïÌï† Ïàò ÏûàÎã§.

3Ô∏è‚É£ **ÏÇ¨Ïö©ÎêòÏßÄ ÏïäÏùÄ Î∏îÎ°ù Í±¥ÎÑàÎõ∞Í≥† Î∞±ÏóÖ ÏàòÌñâ** 

- Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ ÌååÏùºÏù¥ 100m Îùº ÌïòÎçîÎùºÎèÑ Ïã§Ï†ú ÏÇ¨Ïö©ÌïòÎäî Ïö©ÎüâÏùÄ ÏïÑÏ£º ÏûëÏùÑ Ïàò ÏûàÎã§. Ïù¥ Ï§ë ÌòÑÏû¨ ÏÇ¨Ïö©ÌïòÍ≥† ÏûàÎäî Î∏îÎ°ùÎßå Ï∞æÏïÑ Î∞±ÏóÖÏùÑ ÏàòÌñâÌï† Ïàò ÏûàÎã§.

4Ô∏è‚É£ Î∞±ÏóÖ ÏàòÌñâ Ï§ë ÌõºÏÜêÎêú Î∏îÎ°ù Í∞êÏßÄ

- Î∞±ÏóÖ ÏàòÌñâ ÎèÑÏ§ëÏóê ÌõºÏÜêÎêú Î∏îÎ°ùÏùÑ Í∞êÏßÄÌïòÏó¨ ÎßàÌÇπÌï¥ ÎëêÍ≥† Í≥ÑÏÜç Î∞±ÏóÖÏùÑ ÏßÑÌñâÌïúÎã§.

5Ô∏è‚É£ ASM Í∏∞Î∞ò Ïú†ÏùºÌïú Î∞±ÏóÖ ÎèÑÍµ¨

6Ô∏è‚É£ Î∞±ÏóÖ ÏàòÌñâ Ïãú ÏïïÏ∂ï ÏßÄÏõê 

## ‚òëÔ∏è Íµ¨ÏÑ±ÎèÑ

![image.png](/assets/20250730/1.png)

‚≠ê RMAN Î∞±ÏóÖ, Î≥µÍµ¨ Î™ÖÎ†π ‚Üí RMAN ÎåÄÏÉÅ ÏÑúÎ≤Ñ (target db) Ïóê Ï†ëÏÜçÌïòÏó¨ Î∞±ÏóÖÏùÑ ÏàòÌñâ. 

‚Üí Recovery Catalog ServerÍ∞Ä ÏûàÏúºÎ©¥ Î∞±ÏóÖ Í¥ÄÎ†® Ï†ïÎ≥¥Î•º **Catalog db**Ïóê Ï†ÄÏû•. ÏóÜÏúºÎ©¥ target db Ïùò **Ïª®Ìä∏Î°§ ÌååÏùº**Ïóê Í∏∞Î°ù

## ‚òëÔ∏è RMAN Î∞±ÏóÖ Ï¢ÖÎ•ò

1Ô∏è‚É£ backupsetÏúºÎ°ú Î∞±ÏóÖ ÏàòÌñâ (Í∏∞Î≥∏)

üìç RMANÏóêÏÑú Î∞±ÏóÖÏùÑ ÏàòÌñâÌïòÎ©¥ Î∞±ÏóÖ ÏÖã(ÎÖºÎ¶¨Ï†ÅÏù∏ Îç©Ïñ¥Î¶¨) ÏúºÎ°ú Î∞õÎäîÎã§. Ïã§Ï†úÎ°úÎäî Î∞±ÏóÖ ÌîºÏä§Î°ú Ï†ÄÏû•ÎêúÎã§.

‚ñ∂Ô∏è Backup Set 

- Í∞ÅÍ∞Å ÌïòÎÇòÏùò Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ ÌååÏùºÏùò Î∞±ÏóÖÏùÑ Ìè¨Ìï®ÌïòÎäî Î∞±ÏóÖ ÌîºÏä§ (backup piece)ÎùºÍ≥† ÌïòÎäî ÌååÏùºÏùò Î™®ÏùåÏù¥Îã§.
- Îç∞Ïù¥ÌÑ∞ ÌååÏùº, Ïª®Ìä∏Î°§ ÌååÏùº, ÏÑúÎ≤Ñ ÌååÎùºÎØ∏ÌÑ∞ ÌååÏùº, ÏïÑÏπ¥Ïù¥Î∏å ÌååÏùº Ìè¨Ìï®Îêú ÌïòÎÇò Ïù¥ÏÉÅÏùò binary file(Î∞±ÏóÖ ÌîºÏä§) Î™®ÏùåÏù¥Îã§.
- Backup SetÏùÑ ÏÇ¨Ïö©ÌïòÎ©¥ Îπà Îç∞Ïù¥ÌÑ∞ Î∏îÎ°ùÏù¥ Ï†ÄÏû•ÎêòÏßÄ ÏïäÏúºÎØÄÎ°ú Î∞±ÏóÖÏÖãÏóêÏÑú ÏÜåÎ™®ÌïòÎäî ÎîîÏä§ÌÅ¨ÎÇò ÌÖåÏù¥ÌîÑ Í≥µÍ∞ÑÏù¥ Ï§ÑÏñ¥Îì†Îã§.
- Î∞±ÏóÖÏÖãÏùÑ ÏïïÏ∂ïÌïòÎ©¥ Î∞±ÏóÖÏóê ÌïÑÏöîÌïú Í≥µÍ∞ÑÏùÑ Îçî Ï§ÑÏùº Ïàò ÏûàÎã§.

2Ô∏è‚É£ image copyÎ°ú Î∞±ÏóÖ ÏàòÌñâ

- Ïù¥ Î∞©Î≤ïÏùÄ ÏÇ¨Ïö©Ï§ëÏù∏ Î∏îÎ°ùÎßå Î∞±ÏóÖ Î∞õÎäî Í∏∞Îä•Ïù¥ÎÇò Ï¶ùÎ∂Ñ Î∞±ÏóÖ Î∞õÎäî Í∏∞Îä• Îì± ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏùå.

## ‚òëÔ∏è RMAN Î∞±ÏóÖÏãú Ï£ºÏùò ÏÇ¨Ìï≠

- open ÏÉÅÌÉúÏóêÏÑú Î∞±ÏóÖÏùÑ Î∞õÏúºÎ†§Î©¥ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§Í∞Ä **archive log mode**Î°ú Ïö¥ÏòÅÎêòÏñ¥Ïïº ÌïúÎã§.
- DBÎäî **mount ÎòêÎäî open** ÎêòÏñ¥ ÏûàÏñ¥Ïïº ÌïúÎã§.
- Ïö¥ÏòÅ Ï§ëÏù∏ Ïò®ÎùºÏù∏ Î¶¨Îëê Î°úÍ∑∏ ÌååÏùºÏùÄ Î∞±ÏóÖÏù¥ Î∂àÍ∞ÄÎä•ÌïòÎã§.

```bash
alter system archive log current; -> ÏöîÍ≤ÉÏùÄ? 
```

- ÎÖ∏ ÏïÑÏπ¥Ïù¥Î∏å Î™®ÎìúÏóêÏÑúÎäî clean Î∞±ÏóÖÎßå ÏÇ¨Ïö© Í∞ÄÎä•

## ‚òëÔ∏è Ïö©Ïñ¥ Ï†ïÎ¶¨

üìç **control_file_record_keep_time** : Î∞±ÏóÖ Ï†ïÎ≥¥Í∞Ä Í≤πÏ≥êÏì∞Ïù¥Í∏∞ Ï†ÑÍπåÏßÄ Ï†ÄÏû•ÎêòÎäî ÏµúÏÜå ÎÇ†ÏßúÏàòÎ•º Í≤∞Ï†ïÌïòÎäî ÌååÎùºÎØ∏ÌÑ∞

```sql
show parameter control_file_record_keep_time
-- 7Ïùº 

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
control_file_record_keep_time        integer     7

```

üìç **control file ÎÇ¥Ïö©**

- Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ïù¥Î¶Ñ, ÏÉùÏÑ±Îêú ÏãúÍ∞Ñ
- Ï≤¥ÌÅ¨Ìè¨Ïù∏Ìä∏
- **Îç∞Ïù¥ÌÑ∞ ÌååÏùº, Î¶¨Îëê Î°úÍ∑∏ ÌååÏùº, ÏïÑÏπ¥Ïù¥Î∏å ÌååÏùº**
- ÌòÑÏû¨ log sequence number
- Î∞±ÏóÖ Ï†ïÎ≥¥(Ïú†Ï†ÄÍ∞Ä ÏßÅÏ†ë Ïò®ÎùºÏù∏ Î∞±ÏóÖ ÏàòÌñâ)
- RMAN repository

üìç **Î∞±ÏóÖ ÏúÑÏπò**

- ÎîîÏä§ÌÅ¨ ÎîîÎ†âÌÜ†Î¶¨
- media management library (ÌÖåÏù¥ÌîÑ Ïû•Ïπò) ‚Üí Î¨¥Ï°∞Í±¥ RMAN
- fast recovery area (flash recovery area)
    - RMANÏóêÏÑú Î∞±ÏóÖÍ≥º Î≥µÍµ¨ Î∞è flashback database Î™©Ï†ÅÏúºÎ°ú ÏÇ¨Ïö©ÎêòÎäî ÎîîÏä§ÌÅ¨ ÏòÅÏó≠
    - ÌååÏùºÏùÄ ÌïÑÏöîÏóê Îî∞Îùº ÏûêÎèôÏúºÎ°ú Î≥¥Í¥Ä Î∞è ÏÇ≠Ï†úÎêúÎã§.
    - **control file Îã§Ï§ëÌôîÎêú Î≥µÏÇ¨Î≥∏**
    - **redo log file Îã§Ï§ëÌôîÎêú Î≥µÏÇ¨Î≥∏**
    - **ÏïÑÏπ¥Ïù¥Î∏åÎêú redo log**
    - fast recovery areaÏùò ÏÇ¨Ïö©Îêú Í≥µÍ∞ÑÏù¥ 85% warning alert Ïù¥ Î∞úÏÉùÌïòÍ≥† 97%Ïóê ÎèÑÎã¨ÌïòÎ©¥ critical alertÏù¥ Î∞úÏÉùÌïúÎã§. (alert logÏóê Í∏∞Î°ùÎêúÎã§.)
    
    ```sql
    select * from dba_outstanding_alerts;
    show parameter db_recovery_file_dest
    
    NAME                                 TYPE        VALUE
    ------------------------------------ ----------- ------------------------------
    db_recovery_file_dest                string      /u01/app/oracle/fast_recovery_
                                                     area
    db_recovery_file_dest_size           big integer 8256M
    
    select * from v$flash_recovery_area_usage;
    
    /*
    CONTROL FILE  	0	0	0	0
    REDO LOG	      0	0	0	0
    ARCHIVED LOG	  1.62	0	3	0
    BACKUP PIECE	  0.37	0	3	0
    IMAGE COPY	    0	0	0	0
    FLASHBACK LOG	  0	0	0	0
    FOREIGN ARCHIVED LOG	0	0	0	0
    AUXILIARY DATAFILE COPY	0	0	0	0
    
    */
    ```
    
    üìç PERCENT_SPACE_USED : ÏÇ¨Ïö©Ï§ëÏù∏ recovery area Î∞±Î∂ÑÏú®
    
    üìç PERCENT_SPACE_RECLAIMABLE : ÌöåÏàò Í∞ÄÎä•Ìïú recovery area Î∞±Î∂ÑÏú®
    
    üìç NUMBER_OF_FILES : recovery area ÌååÏùºÏùò Ïàò
    
    ```sql
    select * from v$recovery_file_dest;
    
    NAME
    --------------------------------------------------------------------------------
    SPACE_LIMIT SPACE_USED SPACE_RECLAIMABLE NUMBER_OF_FILES     CON_ID
    ----------- ---------- ----------------- --------------- ----------
    /u01/app/oracle/fast_recovery_area
     8657043456  172130816                 0               6          0
    ```
    

‚ñ∂Ô∏è RMAN Ï†ëÏÜç

```sql
[oracle@oracle ~]$ rman target /

Recovery Manager: Release 19.0.0.0.0 - Production on Wed Jul 30 10:23:20 2025
Version 19.3.0.0.0

Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.

connected to target database: ORA19C (DBID=**1258537005**) -- DB_IDÍ∞í Ï§ëÏöîÌïòÎã§.

-- RMANÏóêÏÑúÎèÑ ÏøºÎ¶¨Î•º ÏàòÌñâÌï† Ïàò ÏûàÎã§.

RMAN> select dbid, name, log_mode from v$database;

using target database control file instead of recovery catalog
      DBID NAME      LOG_MODE
---------- --------- ------------
1258537005 ORA19C    ARCHIVELOG

select file_id, tablespace_name, file_name, bytes/1024/1024 mb from dba_data_files;

 FILE_ID TABLESPACE_NAME
---------- ------------------------------
FILE_NAME
--------------------------------------------------------------------------------
        MB
----------
         1 SYSTEM
/u01/app/oracle/oradata/ORA19C/system01.dbf
       920

         3 SYSAUX
/u01/app/oracle/oradata/ORA19C/sysaux01.dbf
       700

         7 USERS
/u01/app/oracle/oradata/ORA19C/users01.dbf
         5

         4 UNDOTBS1
/u01/app/oracle/oradata/ORA19C/undotbs01.dbf
       340

-- ÌòÑÏû¨ DBÏùò temp ÌååÏùºÍ≥º Îç∞Ïù¥ÌÑ∞ ÌååÏùº ÌôïÏù∏
RMAN> report schema;

/*
List of Permanent Datafiles    
===========================
File Size(MB) Tablespace           RB segs Datafile Name
---- -------- -------------------- ------- ------------------------
1    920      SYSTEM               YES     /u01/app/oracle/oradata/ORA19C/system01.dbf
3    700      SYSAUX               NO      /u01/app/oracle/oradata/ORA19C/sysaux01.dbf
4    340      UNDOTBS1             YES     /u01/app/oracle/oradata/ORA19C/undotbs01.dbf
7    5        USERS                NO      /u01/app/oracle/oradata/ORA19C/users01.dbf

List of Temporary Files
=======================
File Size(MB) Tablespace           Maxsize(MB) Tempfile Name
---- -------- -------------------- ----------- --------------------
1    35       TEMP                 32767       /u01/app/oracle/oradata/ORA19C/temp01.dbf

üìç RB segs : Î°§Î∞± ÏÑ∏Í∑∏Î®ºÌä∏ 
*/  

-- Î∞±ÏóÖ Ï†ïÎ≥¥

RMAN> select a.name, a.checkpoint_change#, b.status, b.change#, b.time
from v$datafile a, v$backup b
where a.file# = b.file#;

NAME
--------------------------------------------------------------------------------
CHECKPOINT_CHANGE# STATUS                CHANGE# TIME
------------------ ------------------ ---------- ---------

/u01/app/oracle/oradata/ORA19C/system01.dbf
           4192808 NOT ACTIVE            4063220 29-JUL-25

/u01/app/oracle/oradata/ORA19C/sysaux01.dbf
           4192808 NOT ACTIVE            4063220 29-JUL-25

/u01/app/oracle/oradata/ORA19C/undotbs01.dbf
           4192808 NOT ACTIVE            4063220 29-JUL-25

/u01/app/oracle/oradata/ORA19C/users01.dbf
           4192808 NOT ACTIVE            4063220 29-JUL-25

--> Ïª®Ìä∏Î°§ ÌååÏùºÏù¥ Í∞ÄÏßÄÍ≥† ÏûàÏóàÎçò Î∞±ÏóÖ Ï†ïÎ≥¥

-- RMANÏóêÏÑú Î∞±ÏóÖ Ï†ïÎ≥¥
list backup;

BS Key  Type LV Size       Device Type Elapsed Time Completion Time
------- ---- -- ---------- ----------- ------------ ---------------
1       Full    10.20M     DISK        00:00:00     28-JUL-25
        BP Key: 1   Status: AVAILABLE  Compressed: NO  Tag: TAG20250728T095849
        Piece Name: /u01/app/oracle/fast_recovery_area/ORA19C/autobackup/2025_07_28/o1_mf_s_1207648729_n8flt9rk_.bkp
  SPFILE Included: Modification time: 28-JUL-25
  SPFILE db_unique_name: ORA19C

```

‚ñ∂Ô∏è ÌòÑÏû¨ configure Ï†ïÎ≥¥

```sql
show all;

RMAN configuration parameters for database with db_unique_name ORA19C are:
CONFIGURE RETENTION POLICY TO REDUNDANCY 1; # default
CONFIGURE BACKUP OPTIMIZATION OFF; # default
CONFIGURE DEFAULT DEVICE TYPE TO DISK; # default
**CONFIGURE CONTROLFILE AUTOBACKUP ON; # default
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '%F'; # default**
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO BACKUPSET; # default
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default
CONFIGURE MAXSETSIZE TO UNLIMITED; # default
CONFIGURE ENCRYPTION FOR DATABASE OFF; # default
CONFIGURE ENCRYPTION ALGORITHM 'AES128'; # default
CONFIGURE COMPRESSION ALGORITHM 'BASIC' AS OF RELEASE 'DEFAULT' OPTIMIZE FOR LOAD TRUE ; # default
CONFIGURE RMAN OUTPUT TO KEEP FOR 7 DAYS; # default
CONFIGURE ARCHIVELOG DELETION POLICY TO NONE; # default
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '/u01/app/oracle/product/19.3.0/dbhome_1/dbs/snapcf_ora19c.f'; # default

```

üìç **control file ÏûêÎèôÏúºÎ°ú Î∞±ÏóÖ ÏÑ§Ï†ï**

‚ñ∂Ô∏è Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Íµ¨Ï°∞Í∞Ä Î≥ÄÍ≤ΩÎê† Îïå **ÏûêÎèôÏúºÎ°ú control fileÍ≥º spfileÏù¥ Î∞±ÏóÖÏù¥ ÏßÑÌñâ**ÎêúÎã§.

‚û°Ô∏è `backup database` ÏàòÌñâ Îïå ÏûêÎèôÏúºÎ°ú control file, spfile Ï∂îÍ∞ÄÌï¥Ï§å 

```sql
**CONFIGURE CONTROLFILE AUTOBACKUP ON; # default**
```

‚ñ∂Ô∏è control file ÏûêÎèôÏúºÎ°ú Î∞±ÏóÖ ÎπÑÌôúÏÑ±Ìôî ÏÑ§Ï†ï

```sql
CONFIGURE CONTROLFILE AUTOBACKUP OFF;
```

‚ñ∂Ô∏è ÏûêÎèô Ïª®Ìä∏Î°§ ÌååÏùº Î∞±ÏóÖ ÏúÑÏπò(fast recovery area), Ïù¥Î¶Ñ ÏÑ§Ï†ï

```sql
**CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '%F'; # default**
```

- %F : c-DBID-YYYYMMDD-QQ
    - QQÎäî 00ÏúºÎ°ú ÏãúÏûëÌïòÍ≥† ÏµúÎåÄÍ∞íÏù¥ FFÏù∏ 16ÏßÑÏàò ÏãúÌÄÄÏä§
    - %F Ìè¨Îß∑ Î¨∏ÏûêÎäî ÌïÑÏàòÎ°ú ÏÑ§Ï†ïÌï¥Ïïº ÌïúÎã§.

‚ñ∂Ô∏è ÏûêÎèô Ïª®Ìä∏Î°§ ÌååÏùº Î∞±ÏóÖ ÏúÑÏπò, Ïù¥Î¶ÑÏùÑ ÏÑ§Ï†ï

```sql
**CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '/home/oracle/backup/rman/cf_%F';**
```

‚ñ∂Ô∏è configure ÏÑ§Ï†ïÏùÑ Í∏∞Î≥∏Í∞íÏúºÎ°ú ÏÑ§Ï†ï

```sql
**CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK CLEAR;**
```

‚ñ∂Ô∏è control file Î∞±ÏóÖÌïòÍ≥† ÏûàÎäî ÎèÑÏ§ëÏóê control fileÏùò ÎÇ¥Ïö©Ïù¥ Î≥ÄÍ≤ΩÎêúÎã§Î©¥ Î∞±ÏóÖ Ï†ÑÍ≥º Î∞±ÏóÖ ÌõÑÏóê ÎÇ¥Ïö©Ïù¥ Îã¨ÎùºÏßÄÎäî Î¨∏Ï†úÍ∞Ä Î∞úÏÉùÌïúÎã§. Í∑∏Îü∞ ÏÉÅÌô©Ïù¥ ÎêòÎ©¥ Î∞±ÏóÖ Î∞õÎçò control file ÏùÑ Ïä§ÎÉÖÏÉ∑ÏùÑ ÏÉùÏÑ±ÌïòÍ≥† Î∞±ÏóÖ ÌõÑÏóê ÎèôÍ∏∞ÌôîÏãúÏºúÏÑú Î¨∏Ï†úÎ•º Ìï¥Í≤∞ÌïúÎã§.

```sql
CONFIGURE SNAPSHOT CONTROLFILE NAME TO
'/u01/app/oracle/product/19.3.0/dbhome_1/dbs/snapcf_ora19c.f'; # default
```

‚ñ∂Ô∏è Ïä§ÎÉÖÏÉ∑ Ï†ÄÏû• ÏúÑÏπò Î≥ÄÍ≤Ω

```sql
CONFIGURE SNAPSHOT CONTROLFILE NAME TO
'/home/oracle/backup/rman/snapcf_ora19c.f'; 
```

‚ñ∂Ô∏è Ïä§ÎÉ°ÏÉ∑ Ï†ÄÏû• ÏúÑÏπò Í∏∞Î≥∏Í∞íÏúºÎ°ú ÏÑ§Ï†ï

```sql
CONFIGURE SNAPSHOT CONTROLFILE NAME CLEAR;
```

‚ñ∂Ô∏è Î∞±ÏóÖÏù¥ ÌïÑÏöîÌïú ÌååÏùº

```sql
RMAN> report need backup;

RMAN retention policy will be applied to the command
RMAN retention policy is set to redundancy 1
Report of files with less than 1 redundant backups
File #bkps Name
---- ----- -----------------------------------------------------
1    0     /u01/app/oracle/oradata/ORA19C/system01.dbf
3    0     /u01/app/oracle/oradata/ORA19C/sysaux01.dbf
4    0     /u01/app/oracle/oradata/ORA19C/undotbs01.dbf
7    0     /u01/app/oracle/oradata/ORA19C/users01.dbf

```

‚ñ∂Ô∏è Î∞±ÏóÖ ÎåÄÏÉÅ ÌååÏùº Ï∞æÏïÑÏÑú Î∞±ÏóÖÌïòÍ∏∞ (Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Î†àÎ≤®Î°ú Î∞±ÏóÖ ÏßÑÌñâ)

```sql
RMAN> backup database;
```

‚ñ∂Ô∏è User managed recovery ÏóêÏÑúÎäî alter database begin backup ~ Îç∞Ïù¥ÌÑ∞ÌååÏùº Î∞±ÏóÖ ~ end, Ïª®Ìä∏Î°§ ÌååÏùº, pfile Î∞±ÏóÖÎ∞õÏïòÎã§.

```sql
list backup;
```

‚ñ∂Ô∏è RMANÏóêÏÑú ÏïÑÏπ¥Ïù¥Î∏å Ï†ïÎ≥¥ Ï†ÄÏû•ÌïòÍ∏∞

```sql
alter system archive log current;

-- ÏïÑÏπ¥Ïù¥Î∏åÎêú Î™®Îì† Ï†ïÎ≥¥ Î≥¥Í∏∞
list archivelog all;
```

## ‚òëÔ∏è Ïã§Ïäµ

- üìç non-system tabespace Î≥µÍµ¨1
    
    ‚ñ∂Ô∏è ÏÉàÎ°úÏö¥ ÌÖåÏù¥Î∏î ÏÉùÏÑ±
    
    ```sql
    create table hr.loc_new tablespace users as select * from hr.locations;
    alter system switch logfile;
    
    -- Î°úÍ∑∏ Ï†ïÎ≥¥
    SELECT a.group#, b.sequence#, a.member, b.status, b.first_change#, b.first_time, b.next_change#, b.next_time
    FROM v$logfile a, v$log b
    WHERE a.group# = b.group#
    ORDER BY b.group#;
    
    -- ÏïÑÏπ¥Ïù¥Î∏å Ï†ïÎ≥¥
    select sequence#, name, first_change#, next_change# from v$archived_log;
    
    ! ls arch*
    
    SELECT f.tablespace_name, f.file_name
    FROM   dba_extents e,
           dba_data_files f
    WHERE  f.file_id = e.file_id
    AND    e.segment_name = 'LOC_NEW'
    AND    e.owner = 'HR';
    
    TABLESPACE_NAME  FILE_NAME
    ---------------  ---------------------------------------------
    USERS            /u01/app/oracle/oradata/ORA19C/users01.dbf
    ```
    
    ‚ñ∂Ô∏è Ïû•Ïï† Î∞úÏÉù
    
    ```sql
    ! rm /u01/app/oracle/oradata/ORA19C/users01.dbf
    ! ls /u01/app/oracle/oradata/ORA19C/users01.dbf
    
    select count(*) from hr.loc_new;
    alter system checkpoint;
    ```
    
    ‚ñ∂Ô∏è ÌòπÏãú Î™®Î•¥ÎãàÍπå Ï†ÄÏû• Í≥µÍ∞Ñ Ï†ïÎ¶¨
    
    ```sql
    ! df -l
    ```
    
    ‚ñ∂Ô∏è Ïò§Î•ò Ïú†ÎèÑÌïòÍ∏∞ ÏúÑÌï¥ÏÑú
    
    ```sql
    -- rmanÏóêÏÑú ÎÇòÍ∞ÄÍ∏∞
    exit
    -- Îã§Ïãú Îì§Ïñ¥Í∞ÄÍ∏∞
    rman target/
    
    Ïò§Î•ò Î∞úÏÉù
    ```
    
    ‚ñ∂Ô∏è Î¶¨Ïª§Î≤Ñ ÌïÑÏöîÌïú ÌååÏùº ÌôïÏù∏
    
    ```sql
    select * from v$recover_file;
    ```
    
    ‚ñ∂Ô∏è Ïû•Ïï† Î∞úÏÉù Ï†ïÎ≥¥
    
    ```sql
    list failure;
    
    Failure ID | Priority | Status | Time Detected | Summary
    -----------+----------+--------+---------------+-------------------------------------------------
    22         | HIGH     | OPEN   | 18-JUL-25     | One or more non-system datafiles are missing
    148        | HIGH     | OPEN   | 17-JUL-25     | One or more non-system datafiles need media recovery
    
    list failure 22 detail;
    list failure 148 detail;
    ```
    
    ‚ñ∂Ô∏è Î≥µÍµ¨
    
    ```sql
    **-- 12c**
    -- (1) ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§ offline mode 
    alter tablespace users offline immediate;
    
    -- (2) Í∞ÄÏû• ÏµúÍ∑ºÏóê Î∞õÏïÑ ÎÜìÏùÄ Î∞±ÏóÖÎ≥∏ Ï∞æÏïÑ Î¶¨Ïä§Ìä∏Ìôî
    restore tablespace users;
    
    -- (3) Î¶¨Îëê Ï†ïÎ≥¥ Ï†ÅÏö©
    recover tablespace users;
    
    -- (3) onlineÏúºÎ°ú Ïò¨Î¶¨Í∏∞
    alter tablespace users online;
    ```
    
    ‚ñ∂Ô∏è ÌôïÏù∏
    
    ```sql
    list failure;
    report schema;
    ```
    
- üìç non-system tabespace Î≥µÍµ¨2
    
    ‚ñ∂Ô∏è ÏÉàÎ°úÏö¥ ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§ ÏÉùÏÑ±
    
    ```sql
    create tablespace insa_tbs datafile '/home/oracle/insa_tbs01.dbf' size 10m;
    
    -- SQL PLUSÏóêÏÑú 
    create hr.emp tablespace insa_tbs as select * from hr.employees;
    ```
    
    ‚ñ∂Ô∏è Î∞±ÏóÖÏù¥ ÌïÑÏöîÌïú ÎåÄÏÉÅ Îç∞Ïù¥ÌÑ∞ ÌååÏùº Ï≤¥ÌÅ¨
    
    ```sql
    report need backup;
    ```
    
    ‚ñ∂Ô∏è Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Î†àÎ≤® Î∞±ÏóÖ
    
    ```sql
    -- backup database;
    ```
    
    ‚ñ∂Ô∏è ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§ Î†àÎ≤® Î∞±ÏóÖ
    
    ```sql
    -- backup tablespace insa_tbs;
    ```
    
    ‚ñ∂Ô∏è datafile Î†àÎ≤® Î∞±ÏóÖ
    
    ```sql
    -- backup datafile 5;
    ```
    
    ‚ñ∂Ô∏è Î∞±ÏóÖ ÌôïÏù∏ Ï†àÏ∞®
    
    ```sql
    list backup;
    
    -- Î∞±ÏóÖ ÎåÄÏÉÅ ÌôïÏù∏
    report need backup;
    
    -- ÌäπÏ†ïÌïú ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§ Î∞±ÏóÖÎ≥∏ Ï≤¥ÌÅ¨
    list backup of tablespace insa_tbs;
    ```
    
    ‚ñ∂Ô∏è ÌäπÏ†ïÌïú Îç∞Ïù¥ÌÑ∞ÌååÏùº Î∞±ÏóÖÎ≥∏ Ï≤¥ÌÅ¨
    
    ```sql
    list backup of datafile 5;
    list backup of datafile 'home/oracle/insa_tbs01.dbf';
    ```
    
    ‚ñ∂Ô∏è Ïû•Ïï† Î∞úÏÉù
    
    ```sql
    ! rm /home/oracle/insa_tbs01.dbf
    ! ls /home/oracle/insa_tbs01.dbf
    
    -- Ïò§Î•ò Ïú†Î∞ú
    rman > alter system checkpoint;
    ```
    
    ‚ñ∂Ô∏è Ïû¨Ï†ëÏÜç
    
    ```sql
    rman target/
    startup  
    select status from v$instance;
    
    Failure ID | Priority | Status | Time Detected | Summary
    -----------+----------+--------+---------------+-----------------------------------------
    22         | HIGH     | OPEN   | 30-JUL-25     | One or more non-system datafiles are missing
    
    select * from v$recover_file;
    report schema;
    ```
    
    ‚ñ∂Ô∏è Î≥µÍµ¨
    
    ```sql
    -- (1) Î≥µÍµ¨ ÏàòÌñâÌï¥Ïïº Ìï† Îç∞Ïù¥ÌÑ∞ ÌååÏùº offline
    alter database datafile 5 offline;
    -- (2) Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ open
    alter database open;
    select * from hr.emp_new;
    -- (3) restore
    restore datafile 5;
    -- (4) recover
    recover datafile 5;
    -- (5) online
    alter database datafile 5 online;
    ```
    
- üìç non-system tabespace Î≥µÍµ¨3
    
    ```sql
    ! rm /home/oracle/insa_tbs01.dbf
    alter system checkpoint;
    
    rman target /
    /* shutdown abort */
    startup
    
    --ÌïúÎ≤àÏóê ÏàòÌñâ (ÏûëÏóÖÌòï Î™®ÎìúÎ°ú ÏàòÌñâ)
    run{
    select status from v$instance; -- mounted
    alter database datafile 5 offline;
    restore datafile 5;
    recover datafile 5;
    alter database datafile 5 online;
    }
    
    alter database open;
    
    ```
    
- üìç non-system tabespace Î≥µÍµ¨4
    
    ```sql
    ! rm /home/oracle/insa_tbs01.dbf
    ! ls /home/oracle/insa_tbs01.dbf
    
    alter system checkpoint;
    
    rman target /
    /* shutdown abort */
    startup
    
    -- Î≥µÍµ¨ ÌïÑÏöî Î™©Î°ù Ï°∞Ìöå
    list failure;
    
    -- ÏÉàÎ°úÏö¥ ÏúÑ
    
    --ÌïúÎ≤àÏóê ÏàòÌñâ (ÏûëÏóÖÌòï Î™®ÎìúÎ°ú ÏàòÌñâ)
    run{
    select status from v$instance; -- mounted
    alter database datafile 5 offline;
    restore datafile 5;
    recover datafile 5;
    alter database datafile 5 online;
    }
    
    alter database open;
    
    ```
    
    ‚ñ∂Ô∏è Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞ ÌååÏùº ÏúÑÏπòÍ∞Ä ÏïÑÎãå ÏÉàÎ°úÏö¥ ÏúÑÏπòÏóê Î≥µÍµ¨ ÏûëÏóÖ
    
    ```sql
    /*
    1) Îç∞Ïù¥ÌÑ∞ ÌååÏùº offline 
    2) ÏÉàÎ°úÏö¥ ÏúÑÏπòÎ°ú ÌååÏùº Î≥µÏÇ¨
    3) alter database rename file 'Í∏∞Ï°¥ÏúÑÏπò' to 'ÏÉàÎ°úÏö¥ÏúÑÏπò';
    4) recover
    5) Îç∞Ïù¥ÌÑ∞ÌååÏùº online
    */
    
    -- ‚ñ∂Ô∏è ÏûëÏóÖÌòïÏúºÎ°ú ÏûëÏóÖÌïòÍ∏∞
    run{
    alter database datafile 5 offline;
    set newname for datafile 5 to '/u01/app/oracle/oradata/ORA19C/insa_tbs01.dbf';
    restore datafile 5;
    switch datafile 5;
    recover datafile 5;
    alter database datafil 5 online;
    }
    
    alter database open;
    report schema;
    ```
    
    ‚ñ∂Ô∏è ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§ ÏÇ≠Ï†ú
    
    ```sql
    drop tablespace insa_tbs including contents and datafiles;
    ```
    
    ‚ñ∂Ô∏è Ï†ïÏ±ÖÏÉÅ ÌïÑÏöî ÏóÜÎäî Î∞±ÏóÖ Ï†ïÎ≥¥, ÏïÑÏπ¥Ïù¥Î∏å Ï†ïÎ≥¥ ÌôïÏù∏
    
    ```sql
    report obsolete;
    ```
    
    ‚ñ∂Ô∏è Ï†ïÏ±ÖÏÉÅ ÌïÑÏöî ÏóÜÎäî Î∞±ÏóÖ Ï†ïÎ≥¥, ÏïÑÏπ¥Ïù¥Î∏å Ï†ïÎ≥¥ ÏÇ≠Ï†ú
    
    ```sql
    RMAN> report obsolete;
    
    RMAN retention policy will be applied to the command
    RMAN retention policy is set to redundancy 1
    no obsolete backups found
    
    -- ÏïÑÏπ¥Ïù¥Î∏åÏóê ÎåÄÌï¥ÏÑúÎäî ÎÖºÎ¶¨Ï†ÅÏù¥Í≤å ÏÜåÏú†Ìï† Ïàò ÏûàÏúºÎØÄÎ°ú cross check
    crosscheck archivelog all;
    
    /*
    released channel: ORA_DISK_1
    allocated channel: ORA_DISK_1
    channel ORA_DISK_1: SID=19 device type=DISK
    validation succeeded for archived log
    archived log file name=/home/oracle/arch2/arch_1_38_1205348976_.arc RECID=41 STAMP=1207826605
    validation succeeded for archived log
    archived log file name=/home/oracle/arch1/arch_1_38_1205348976_.arc RECID=40 STAMP=1207826605
    Crosschecked 2 objects
    
    */
    ```
    
    ‚ñ∂Ô∏è crosscheck ÌõÑ Î¨∏Ï†úÍ∞Ä ÎêòÎäî Ï†ïÎ≥¥Î•º expired Îêú ÏïÑÏπ¥Ïù¥Î∏å ÌååÏùº ÌôïÏù∏
    
    ```sql
    list expired archivelog all;
    ```
    
    ‚ñ∂Ô∏è expired Îêú ÏïÑÏπ¥Ïù¥Î∏å ÌååÏùº ÏÇ≠Ï†ú
    
    ```sql
    delete expired archivelog all;
    
    -- ÌôïÏù∏
    report obsolete;
    ```
    
    ‚ñ∂Ô∏è Î∞±ÏóÖ Ï†ïÎ≥¥Ïóê ÎåÄÌï¥ cross check
    
    ```sql
    crosscheck backup;
    ```
    
    ‚ñ∂Ô∏è expired Îêú Î∞±ÏóÖ Ï†ïÎ≥¥
    
    ```sql
    list expired backup;
    ```
    
    ‚ñ∂Ô∏è expired Îêú Î∞±ÏóÖ ÏÇ≠Ï†ú
    
    ```sql
    delete expired backup;
    
    -- ÌôïÏù∏
    report obsolete
    ```
    
    ‚ñ∂Ô∏è image copy Î∞±ÏóÖÎ≥∏ Ï≤¥ÌÅ¨
    
    ```sql
    crosscheck datafilecopy all;
    ```
    
    ‚ñ∂Ô∏è image copy expired ÌôïÏù∏
    
    ```sql
    list expired datafilecopy all;
    ```
    
    ‚ñ∂Ô∏è 
    
    ```sql
    delete expired datafilecopy all;
    ```
    
- üìç system datafile Î≥µÍµ¨
    
    ‚ñ∂Ô∏è Ïû•Ïï† Î∞úÏÉù
    
    ```sql
    ! rm /u01/app/oracle/oradata/ORA19C/system01.dbf
    ```
    
    ‚ñ∂Ô∏è Î≥µÍµ¨
    
    ```sql
    >RMAN
    
    list failure;
    list failure 5862 detail;
    
    -- 1) restore
    restore tablespace system;
    -- 2) recover
    recover datafile 1
    -- 3) Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ open 
    alter database open;
    ```
    
- üìç Î™®Îì† datafile Î≥µÍµ¨
    
    ‚ñ∂Ô∏è Ïû•Ïï† Î∞úÏÉù
    
    ```sql
    ! rm /u01/app/oracle/oradata/ORA19C/*.dbf
    alter system checkpoint;
    startup
    list failure;
    list failure 5942 detail;
    list failure 22 detail;
    ```
    
    ‚ñ∂Ô∏è Î™®Îì† Îç∞Ïù¥ÌÑ∞ ÌååÏùº restore
    
    ```sql
    restore database;
    ```
    
    ‚ñ∂Ô∏è recover
    
    ```sql
    recover database
    ```
    
    ‚ñ∂Ô∏è Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ open
    
    ```sql
    alter database open;
    ```
    
- üìç Î™®Îì† datafileÏù¥ ÏûàÎäî ÎîîÏä§ÌÅ¨ ÏÜêÏÉÅ Î≥µÍµ¨
    
    üå≥ **Í∏∞Ï°¥ ÏúÑÏπò :  /u01/app/oracle/oradata/ORA19C/*.dbf ‚Üí /home/oracle/oradata/*.dbf**
    
    ```sql
    
    SYS@ora19c> ! rm /u01/app/oracle/oradata/ORA19C/*.dbf
    
    RMAN> alter system checkpoint;
    
    # Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞ÌååÏùº ÏúÑÏπòÍ∞Ä ÏïÑÎãå ÏÉàÎ°úÏö¥ ÏúÑÏπòÏóê Î≥µÍµ¨ ÏûëÏóÖ
    1) Îç∞Ïù¥ÌÑ∞ ÌååÏùº offline
    2) ÏÉàÎ°úÏö¥ ÏúÑÏπòÎ°ú ÌååÏùº Î≥µÏÇ¨
    3) alter database rename file 'Í∏∞Ï°¥ÏúÑÏπò' to 'ÏÉàÎ°úÏö¥ÏúÑÏπò';
    4) recover
    5) Îç∞Ïù¥ÌÑ∞ÌååÏùº online
    ```
    
    ![image.png](/assets/20250730/2.png)
    
    ```sql
    RMAN> run {
        set newname for datafile 1 to '/home/oracle/oradata/system01.dbf';
    		set newname for datafile 3 to '/home/oracle/oradata/sysaux01.dbf';
    		set newname for datafile 4 to '/home/oracle/oradata/undotbs01.dbf';
    		set newname for datafile 7 to '/home/oracle/oradata/users01.dbf';
    		set newname for datafile 1 to '/home/oracle/oradata/temp01.dbf';
        restore datafile ;
        switch datafile all;
    		switch tempfile all;
    			 recover datafile;
    		alter database open;
    }
    
    report schema;
    list backup;
    ```
    
    ‚ñ∂Ô∏è ÏõêÎ≥µ   **/home/oracle/oradata/*.dbf  ‚Üí /u01/app/oracle/oradata/ORA19C/*.dbf** 
    
    ```sql
    RMAN> run {
        set newname for datafile 1 to '**/u01/app/oracle/oradata/ORA19C/**system01.dbf';
    		set newname for datafile 3 to '**/u01/app/oracle/oradata/ORA19C/**sysaux01.dbf';
    		set newname for datafile 4 to '**/u01/app/oracle/oradata/ORA19C/**undotbs01.dbf';
    		set newname for datafile 7 to '**/u01/app/oracle/oradata/ORA19C/**users01.dbf';
    		set newname for datafile 1 to '**/u01/app/oracle/oradata/ORA19C/**temp01.dbf';
        restore datafile ;
        switch datafile all;
    		switch tempfile all;
    			 recover datafile;
    		alter database open;
    }
    ```
    
- üìç Î∞±ÏóÖ Î∞õÏßÄ ÏïäÏùÄ ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§Ïóê ÏÜçÌïú Îç∞Ïù¥ÌÑ∞ ÌååÏùº ÏÜêÏÉÅ Î≥µÍµ¨
    
    ‚ñ∂Ô∏è Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
    
    ```sql
    create tablespace data_tbs datafile '/u01/app/oracle/oradata/ORA19C/data_tbs01.dbf' size 5m;
    create table hr.dept_new tablespace data_tbs as select * from hr.departments;
    select count(*) from hr.dept_new;
    
    -- Î°úÍ∑∏ Ï†ïÎ≥¥
    SELECT a.group#, b.sequence#, a.member, b.status, b.first_change#, b.first_time, b.next_change#, b.next_time
    FROM v$logfile a, v$log b
    WHERE a.group# = b.group#
    ORDER BY b.group#;
    
    -- ÏïÑÏπ¥Ïù¥Î∏å Ï†ïÎ≥¥
    select sequence#, name, first_change#, next_change# from v$archived_log;
    
    ```
    
    ‚ñ∂Ô∏è Ïû•Ïï† Ïú†Î∞ú
    
    ```sql
    ! rm /u01/app/oracle/oradata/ORA19C/data_tbs01.dbf
    report schema;
    list failure;
    list failure 6305 detail;
    ```
    
    ![image.png](/assets/20250730/3.png)
    
    ‚ñ∂Ô∏è Î∞±ÏóÖÎ≥∏ ÏûàÎäîÏßÄ ÌôïÏù∏Ìï¥Î≥¥Í∏∞
    
    ```sql
    list backup of datafile 5;
    ```
    
    ‚ñ∂Ô∏è ÎåÄÏÉÅ Îç∞Ïù¥ÌÑ∞ ÌååÏùº offline
    
    ```sql
    alter database datafile 5 offline;
    ```
    
    ‚ñ∂Ô∏è Îπà ÍªçÎç∞Í∏∞ Îç∞Ïù¥ÌÑ∞ ÌååÏùº ÏÉùÏÑ±
    
    ```sql
    alter database create datafile '/u01/app/oracle/oradata/ORA19C/data_tbs01.dbf';
    ```
    
    üå≥ Îòê Îã§Î•∏ Î∞©Î≤ï : alter database create datafile ‚ÄòÍ∏∞Ï°¥Îç∞Ïù¥ÌÑ∞ÌååÏùº‚Äô as ‚ÄòÏÉàÎ°úÏö¥Îç∞Ïù¥ÌÑ∞ÌååÏùº‚Äô;
    
    ‚ñ∂Ô∏è recover
    
    ```sql
    recover datafile 5;
    ```
    
    ‚ñ∂Ô∏è Îç∞Ïù¥ÌÑ∞ÌååÏùº online
    
    ```sql
    alter database datafile 5 online;
    
    -- ÌôïÏù∏ : report schema;
    ```
    
    ‚ñ∂Ô∏è Î∞±ÏóÖ ÌïÑÏöîÌïú ÌååÏùº Î∞±ÏóÖ Î∞õÍ∏∞
    
    ```sql
    report need backup;
    backup datafile 5;
    list backup;
    ```
    
- üìç ÌäπÏ†ïÌïú ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§Ïóê ÏÜçÌïú Ïó¨Îü¨ Îç∞Ïù¥ÌÑ∞ ÌååÏùº Ï§ë ÏùºÎ∂Ä Îç∞Ïù¥ÌÑ∞ ÌååÏùº Î≥µÍµ¨
    
    ‚ñ∂Ô∏è Îç∞Ïù¥ÌÑ∞ ÌååÏùº Ï∂îÍ∞Ä
    
    ```sql
    alter tablespace data_tbs add datafile '/u01/app/oracle/oradata/ORA19C/data_tbs02.dbf' size 5m;
    
    SELECT a.file#, b.name tbs_name, a.name file_name, a.status, a.checkpoint_change#
    FROM v$datafile a, v$tablespace b
    WHERE a.ts# = b.ts#;
    ```
    
    ‚ñ∂Ô∏è ÌÖåÏù¥Î∏î ÏÉùÏÑ±
    
    ```sql
    create table hr.emp_2025 tablespace data_tbs as select * from hr.employees;
    ```
    
    ‚ñ∂Ô∏è ÎåÄÎüâÏùò Îç∞Ïù¥ÌÑ∞ Îã¥Í∏∞
    
    ```sql
    insert into hr.emp_2025 select * from hr.emp_2025;
    
    SELECT f.tablespace_name,
           f.file_name,
           COUNT(*) 
    FROM   dba_extents e,
           dba_data_files f
    WHERE  f.file_id = e.file_id
      AND  e.segment_name = 'EMP_2025'
      AND  e.owner = 'HR'
    GROUP BY f.tablespace_name, f.file_name;
    
    /*
    TABLESPACE_NAME	FILE_NAME	ÏùµÏä§ÌÖêÌä∏ Í∞úÏàò   
    DATA_TBS	/u01/app/oracle/oradata/ORA19C/data_tbs01.dbf	16
    DATA_TBS	/u01/app/oracle/oradata/ORA19C/data_tbs02.dbf	2
    */
    ```
    
    ‚ñ∂Ô∏è Î∞±ÏóÖ Îã¥Í∏∞
    
    ```sql
    > RMAN 
    report need backup;
    backup datafile 2;
    list backup of datafile 2;
    ```
    
    ‚ñ∂Ô∏è ÌäπÏ†ïÌïú ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§Ïóê ÏÜçÌïú Îç∞Ïù¥ÌÑ∞ ÌååÏùº Ï§ë Ìïú ÌååÏùºÏù¥ ÏÜêÏÉÅ
    
    ‚ñ∂Ô∏è Ïû•Ïï† Î∞úÏÉù
    
    ```sql
    ! rm /u01/app/oracle/oradata/ORA19C/data_tbs02.dbf
    alter system checkpoint;
    ```
    
    ‚ñ∂Ô∏è Î≥µÍµ¨ ÌïÑÏöîÌïú ÌååÏùº ÌôïÏù∏
    
    ```sql
    > RMAN
    report schema;
    list failure;
    list faulure 6495 detail; 
    ```
    
    ‚ñ∂Ô∏è ÏÜêÏÉÅÎêú Îç∞Ïù¥ÌÑ∞ ÌååÏùº offline
    
    ```sql
    database datafile 2 offline;
    alter database open;
    select count(*) from hr.dept_new;
    ```
    
    ‚ñ∂Ô∏è restore
    
    ```sql
    restore datafile 2;
    ```
    
    ‚ñ∂Ô∏è recover
    
    ```sql
    recover datafile 2;
    ```
    
    ‚ñ∂Ô∏è online
    
    ```sql
    alter database datafile 2 online;
    
    -- ÌôïÏù∏
    select count(*) from hr.emp_2025;
    ```
    
    ‚ñ∂Ô∏è ÏÇ≠Ï†ú
    
    ```sql
    drop tablespace data_tbs including contents and datafiles;
    -- ÌôïÏù∏
    report schema;
    ```
    
    ‚ñ∂Ô∏è ÏùòÎØ∏ÏóÜÎäî Î∞±ÏóÖÎ≥∏ ÏÇ≠Ï†ú
    
    ```sql
    report obsolete;
    delete obsolete;
    ```