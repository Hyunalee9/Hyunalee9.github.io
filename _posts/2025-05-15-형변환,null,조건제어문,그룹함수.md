---
title: "[18ì¼ì°¨] í˜• ë³€í™˜, null , ì¡°ê±´ ì œì–´ë¬¸, ê·¸ë£¹í•¨ìˆ˜"
excerpt: "ì•„ì´í‹°ìœŒ 0515"
categories:
      - ORACLE11g
tags:
      -  ORACLE11g
      - TIL
last-modified-at: 2025-05-15T21:26
---

# í•¨ìˆ˜ (í˜• ë³€í™˜, null , ì¡°ê±´ ì œì–´ë¬¸, ê·¸ë£¹í•¨ìˆ˜)

# í˜• ë³€í™˜ í•¨ìˆ˜

## to_date

- ë¬¸ì ë‚ ì§œë¥¼ ë‚ ì§œí˜•(date)ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
- to_date(ë¬¸ìë‚ ì§œ, â€˜ë‚ ì§œ ëª¨ë¸ ìš”ì†Œâ€™)

```sql
SELECT *
FROM hr.employees
WHERE hire_date >= '2006-01-01'
AND hire_date <= '2006-12-31';
```

```sql
-- í•œêµ­ ì§€ì—­ì— ë§ê²Œ ë‚ ì§œê°’ì„ ì…ë ¥í•˜ê²Œ ë˜ë©´ ì˜¤ë¼í´ì´ ì•”ì‹œì ìœ¼ë¡œ í˜•ë³€í™˜í•´ì„œ ìˆ˜í–‰í•œë‹¤.
SELECT *
FROM hr.employees
WHERE hire_date >= '2006-01-01'
AND hire_date <= '2006-12-31';

SELECT *
FROM hr.employees
WHERE hire_date >= '2006/01/01'
AND hire_date <= '2006/12/31';

SELECT *
FROM hr.employees
WHERE hire_date >= '20060101'
AND hire_date <= '20061231';

-- í•œêµ­ ì§€ì—­ (RR/MM/DD) 
-- yyyy/mm/dd
-- yyyy-mm-dd
-- yyyymmdd
-- > ìœ„ì˜ í˜•ì‹ë„ ê°€ëŠ¥..

-- ì–´ëŠ ì§€ì—­ì—ì„œë“ ì§€ ë‚ ì§œê°’ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ëª…ì‹œì ìœ¼ë¡œ í˜•ë³€í™˜í•´ì„œ ìˆ˜í–‰.
SELECT *
FROM hr.employees
WHERE hire_date >= to_date('2006-01-01', 'yyyy-mm-dd')
AND hire_date <= to_date('2006-12-31','yyyy-mm-dd');
```

![ì•”ì‹œì  ë³€í™˜](/assets/20250515/1.png)

ì•”ì‹œì  ë³€í™˜

![image.png](/assets/20250515/2.png)

â†’  **ëª…ì‹œì  ë³€í™˜ ì£¼ì˜**

:  ì‹¤í–‰ ê³„íšì„ ë³´ë‹ˆ 2006-12-31 00:00:00 ê¹Œì§€ë¼ í‘œì‹œë˜ì–´ ìˆìœ¼ë¯€ë¡œ

2006-12-31 ì´í›„ ë°ì´í„°ëŠ” ëˆ„ë½ë  ìˆ˜ ìˆë‹¤.

â†’ â€˜syyyyâ€™ ì˜ â€˜sâ€™ ëŠ” ì„¸ê¸°

```sql
-- ì‹œë¶„ì´ˆ ë“¤ì–´ìˆëŠ” ì»¬ëŸ¼ì´ë¼ë©´ ì•„ë˜ì™€ ê°™ì´
SELECT *
FROM hr.employees
WHERE hire_date BETWEEN to_date('2006/01/01' , 'yyyy-mm-dd') AND to_date('2006-12-31 23:59:59','yyyy-mm-dd hh24:mi:ss')

SELECT *
FROM hr.employees
WHERE hire_date >= to_date('2006-01-01', 'yyyy-mm-dd')
AND hire_date <= to_date('2007-01-01','yyyy-mm-dd');
```

```sql
-- ë°ì´í„° íƒ€ì…ì„ ë§ì¶°ì„œ ë¹„êµí•´ì•¼í•œë‹¤.
-- department_idì€ íšŒì‚¬ë§ˆë‹¤ ìˆ«ìì¼ìˆ˜ë„ ìˆê³ , ë¬¸ìì¼ ìˆ˜ë„ ìˆë‹¤.
-- í˜•ì´ ë§ì§€ ì•Šìœ¼ë©´ ë¬¸ì¥ íŠœë‹ë•Œ ë¬¸ì œê°€ ë  ìˆ˜ ìˆë‹¤.
-- í˜•ì— ë§ê²Œ ë¹„êµí•˜ì.

SELECT *
FROM hr.employees
WHERE department_id = 10;

SELECT *
FROM hr.employees
WHERE department_id = '10';
```

```sql
-- ì•”ì‹œì ìœ¼ë¡œ í˜•ë³€í™˜ì´ ìˆ˜í–‰ëœë‹¤.
SELECT '1' + 1 FROM dual;

-- ëª…ì‹œì ìœ¼ë¡œ í˜•ë³€í™˜ ìˆ˜í–‰
SELECT to_number('1','9') + 1 FROM dual;
```

## to_number

- ë¬¸ììˆ«ì(char)ë¥¼ ìˆ˜ì¹˜í˜•(number)ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
- to_number(ë¬¸ììˆ«ì, ìˆ«ìëª¨ë¸ìš”ì†Œ(ìƒëµê°€ëŠ¥))

# Null ê´€ë ¨ í•¨ìˆ˜

**null** 

- nullì€ ì‚¬ìš©í•  ìˆ˜ ì—†ê±°ë‚˜, í• ë‹¹ë˜ì§€ ì•Šì•˜ê±°ë‚˜, ì•Œ ìˆ˜ ì—†ê±°ë‚˜, ì ìš©í•  ìˆ˜ ì—†ëŠ” ê°’, ê²°ì¸¡ê°’(ì¹˜)
- nullì€ 0, ê³µë°±ì´ ì•„ë‹ˆë‹¤.

## nvl

- nvl(ì»¬ëŸ¼,ì‹¤ì œê°’)
- nullê°’ì„ ì‹¤ì œ ê°’ìœ¼ë¡œ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜
- nvlí•¨ìˆ˜ëŠ” ì…ë ¥ë˜ëŠ” ì¸ìˆ˜ ê°’ë“¤ì˜ ë°ì´í„° íƒ€ì…ì´ ì¼ì¹˜í•´ì•¼ í•œë‹¤.

```sql
SELECT
	employee_id,
	salary,
	commission_pct,
	(salary * 12) + (salary*12*commission_pct) ann_sal_1,
	(salary * 12) + (salary*12*nvl(commission_pct,0)) ann_sal_2
FROM hr.employees;
```

```sql
SELECT
    nvl(commission_pct,0),
    nvl(commission_pct,'no_comm')  -- commission_pctì»¬ëŸ¼ê³¼ í˜•ì„ ë§ì£¼ì§€ ì•Šì•„ ì˜¤ë¥˜
FROM hr.employees;

SELECT
    nvl(commission_pct,0),
    nvl(to_char(commission_pct),'no_comm')  -- í˜•ì„ ë§ì£¼ê¸° ìœ„í•´ commission_pctê°’ì„ ë¬¸ìí˜•ìœ¼ë¡œ ë°”ê¾¼ë‹¤.
FROM hr.employees;

```

![image.png](/assets/20250515/3.png)

ìˆ«ìë¥¼ ë¬¸ìë¡œ ê·¸ëƒ¥ ë°”ê¾¸ë©´ 0ì´ ì˜ë¦°ë‹¤.

ìˆ«ì ëª¨ë¸ ìš”ì†Œë¥¼ ì ì ˆíˆ ì§€ì •í•´ì¤€ë‹¤.

```sql
--COMMISSION_PCT : NUMBER(2,2) , 0ê°œì˜ ì •ìˆ˜. ë‘ ê°œì˜ ì†Œìˆ˜
SELECT 
    commission_pct,
    nvl(to_char(commission_pct,'0.99'),'no_comm')
FROM hr.employees; 
```

![image.png](/assets/20250515/4.png)

## nvl2

- nvl2(exp1,exp2,exp3)
- ì²«ë²ˆì§¸ exp1ì´ null ì•„ë‹ˆë©´ exp2 ìˆ˜í–‰í•˜ê³  ì²«ë²ˆì§¸ exp1ì´ nullì´ë©´ exp3ë¥¼ ìˆ˜í–‰í•œë‹¤.
- exp2, exp3ì˜ ë°ì´í„° íƒ€ì…ì´ ì¼ì¹˜í•´ì•¼ í•œë‹¤.

```sql
SELECT
    nvl2(commission_pct,(salary*12)+(salary*12*commission_pct),salary*12) ann_sal3
FROM hr.employees;
```

```sql
SELECT
    nvl(commission_pct,0),
    nvl(to_char(commission_pct),'no_comm'),
    nvl2(commission_pct, salary*12, 'no_comm')   -- í˜• ë§ì§€ ì•Šì•„ ì˜¤ë¥˜ 
FROM hr.employees;

SELECT
    nvl(commission_pct,0),
    nvl(to_char(commission_pct),'no_comm'),
    nvl2(commission_pct, to_char(salary*12), 'no_comm')  -- ì—°ë´‰ì„ ë¬¸ì íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ í˜•ì„ ë§ì¶°ì¤Œ.
FROM hr.employees;
```

## coalesce(exp1, exp2, exp3, â€¦ , expn)

- ì²«ë²ˆì§¸ exp1ì´ nullì´ë©´ exp2ë¥¼ ìˆ˜í–‰í•˜ê³  exp2ë„ nullì´ë©´ exp3ë¥¼ ìˆ˜í–‰í•˜ê³  exp3ë„ nullì´ë©´ ë‹¤ìŒ ì¸ìˆ˜(í‘œí˜„ì‹)ë¥¼ ìˆ˜í–‰í•œë‹¤. ì¦‰ nullì´ ë°œìƒí•˜ì§€ ì•Šì„ë•Œê¹Œì§€ ì¸ìˆ˜(í‘œí˜„ì‹)ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜

```sql
SELECT 
	coalesce((salary *12) + (salary*12*commission_pct), salary * 12 ,0) ann_sal_4
FROM hr.employees;	
```

## nullif(exp1,exp2)

- ë‘ í‘œí˜„ì‹ì„ ë¹„êµí•´ì„œ ê°™ìœ¼ë©´ nullì„ ë¦¬í„´í•˜ê³  ê°™ì§€ ì•Šìœ¼ë©´ exp1ì„ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜

```sql
SELECT
	employee_id,
	length(last_name),
	length(first_name),
	nullif(length(last_name),length(first_name))
FROM hr.employees;
```

- PL/SQL

```sql
if exp1 = exp2 then
	null;
else
	exp1;
end if;		
```

# ì¡°ê±´ ì œì–´ë¬¸

- SQLì—ì„œëŠ” ifë¥¼ ì‚¬ìš©í•´ì„œ ì¡°ê±´ ì œì–´ë¬¸ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ë‹¤.
- decodeí•¨ìˆ˜, case í‘œí˜„ì‹

## decode

- ê¸°ì¤€ ê°’ê³¼ ë¹„êµ ê°’ì€ ë‚´ë¶€ì ìœ¼ë¡œ `=` ë¹„êµ ì—°ì‚°ìë§Œ ì‚¬ìš©í•œë‹¤.

```sql
decode(ê¸°ì¤€ê°’,
				ë¹„êµê°’1, ì°¸ê°’1,
				ë¹„êµê°’2, ì°¸ê°’2,
				ë¹„êµê°’3, ì°¸ê°’3,
				ê¸°ë³¸ê°’)
```

```sql
SELECT
	employee_id,
	salary,
	job_id,
	decode(job_id,
						'IT_PROG', salary*1.1,
						'ST_CLERK',salary*1.2,
						'SA_REP', salary*1.3,
						salary) revised_salary
FROM hr.employees;												
```

## case í‘œí˜„ì‹

- ê¸°ì¤€ê°’ê³¼ ë¹„êµê°’ì— ëŒ€í•´ì„œ ëª¨ë“  ë¹„êµ ì—°ì‚°ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```sql
-- ê¸°ì¤€ê°’(=,>,>=,<,<=,<>,!=,^=,in between and, like) ë¹„êµê°’, ë…¼ë¦¬ì—°ì‚°ì(not,and,or)
case 
	 when ê¸°ì¤€ê°’ = ë¹„êµê°’1 then ì°¸ê°’1
	 when ê¸°ì¤€ê°’ = ë¹„êµê°’2 then ì°¸ê°’2
   when ê¸°ì¤€ê°’ = ë¹„êµê°’3 then ì°¸ê°’3	
	 else ê¸°ë³¸ê°’
end

case ê¸°ì¤€ê°’
	 when ë¹„êµê°’1 then ì°¸ê°’1
	 when ë¹„êµê°’2 then ì°¸ê°’2
   when ë¹„êµê°’3 then ì°¸ê°’3	
	 else ê¸°ë³¸ê°’
end
```

```sql
SELECT
	employee_id,
	salary,
	job_id,
	case job_id
				when 'IT_PROG'  then salary*1.1
				when 'ST_CLERK' then salary*1.2
				when 'SA_REP'   then salary*1.3
				else salary
	end revised_salary
FROM hr.employees;	
```

```sql
-- DBA í…Œì´ë¸”ì—ì„œ ì¡°íšŒí•´ì•¼í•œë‹¤! 
SELECT KEYWORD  FROM v$reserved_words;   -- í‚¤ì›Œë“œ ì¡°íšŒ
SELECT * FROM v$reserved_words WHERE KEYWORD = 'LEVEL';
```

â†’ íŒŒì´ì¬ì—ì„œëŠ”

```python
import keyword
keyword.kwlist
```

## decodeí•¨ìˆ˜, case í‘œí˜„ì‹ì—ì„œ null check í•˜ëŠ” ë°©ë²•

- decodeí•¨ìˆ˜, case í‘œí˜„ì‹ì—ì„œ null check ë°©ë²•
- decodeí•¨ìˆ˜ëŠ” null keywordë¥¼ ì´ìš©í•´ì„œ null check
- case í‘œí˜„ì‹ì€ is null ì—°ì‚°ìë¥¼ ì´ìš©í•´ì„œ null check

```sql
SELECT
    employee_id,
    salary,
    commission_pct,
    decode(commission_pct,null,salary*12, (salary*12)+(salary*12*commission_pct),salary*12) ann_sal
FROM hr.employees;   
```

```sql
SELECT
    employee_id,
    salary,
    commission_pct,
    case
        when commission_pct is null then salary *12
        else 
            (salary*12)+(salary*12*commission_pct)
    end
FROM hr.employees;  
```

## Y2K ë¬¸ì œ

                                                         <RR í‘œê¸°ë²• í‘œ>

| í–‰: ë°ì´í„° ì…ë ¥ ì—°ë„/ ì—´ :  í˜„ì¬ ì—°ë„ | 0 ~ 49 | 50 ~ 99 |
| --- | --- | --- |
| 0-49 | ë°˜í™˜ ë‚ ì§œëŠ” í˜„ì¬ ì„¸ê¸°ë¥¼ ë°˜ì˜ | ë°˜í™˜ ë‚ ì§œëŠ” ì´ì „ ì„¸ê¸°ë¥¼ ë°˜ì˜ |
| 50~99 | ë°˜í™˜ ë‚ ì§œëŠ” ì´í›„ ì„¸ê¸°ë¥¼ ë°˜ì˜ | ë°˜í™˜ ë‚ ì§œëŠ” í˜„ì¬ ì„¸ê¸°ë¥¼ ë°˜ì˜ |

| í˜„ì¬ì—°ë„ | ë°ì´í„° ì…ë ¥ ë‚ ì§œ | YY  | RR |
| --- | --- | --- | --- |
| 1994 | 95-10-27 | 1995 | 1995 |
| 1994 | 17-10-27 | 1917 | 2017 |
| 2001 | 17-10-27 | 2017 | 2017 |
| 2048 | 52-10-27 | 2052 | 1952 |
| 2051 | 47-10-27 | 2047 | 2147 |

```sql
SELECT
	to_char(to_date('95-10-27','yy-mm-dd'),'yyyy-mm-dd'),
	to_char(to_date('95-10-27','rr-mm-dd'),'yyyy-mm-dd')
FROM dual;

```

# ê·¸ë£¹ í•¨ìˆ˜

- ì—¬ëŸ¬ í–‰ ë‹¹ í•˜ë‚˜ì˜ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
- sum, avg, median, variance, stddev, max, min, count
- ê·¸ë£¹ í•¨ìˆ˜ ì…ë ¥í•˜ëŠ” ê°’ì´ ìˆ˜ì¹˜í˜•ë§Œ ì…ë ¥í•´ì•¼ í•˜ëŠ” ê·¸ë£¹ í•¨ìˆ˜ : sum, avg, median, variance, stddev
- ê·¸ë£¹ í•¨ìˆ˜ ì…ë ¥í•˜ëŠ” ê°’ì´ ëª¨ë“  íƒ€ì…ì´ ê°€ëŠ¥í•œ ê·¸ë£¹ í•¨ìˆ˜: max, min, count
- ê·¸ë£¹ í•¨ìˆ˜ëŠ” nullì€ í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¨ count(*)ëŠ” null í¬í•¨í•œ í–‰ìˆ˜ë¥¼ êµ¬í•œë‹¤.

## count

- í–‰ì˜ ìˆ˜ë¥¼ êµ¬í•˜ëŠ” í•¨ìˆ˜

```sql
SELECT
	count(*)    -- null í¬í•¨
FROM hr.employees;

SELECT
	count(commission_pct)    -- null í¬í•¨ x
FROM hr.employees;

SELECT
	count(department_id)     -- null í¬í•¨ x
FROM hr.employees;

SELECT
    count(unique department_id)
FROM hr.employees;

SELECT
    count(*)
FROM hr.employees
WHERE department_id = 50;
```

## sum(í•©)

```sql
SELECT 
		sum(salary)
FROM hr.employees;
```

## avg(í‰ê· )

```sql
SELECT 
	avg(salary)
FROM hr.employees;
```

ğŸ“ ê²°ì¸¡ì¹˜ ì œì™¸í•˜ê³  í‰ê·  êµ¬í•´ì§„ë‹¤.

ex) 1, null, 3   : (1+3)/2

ğŸ“ ê²°ì¸¡ì¹˜ í¬í•¨í•´ í‰ê· ì„ êµ¬í•˜ë ¤ë©´ nvl í•¨ìˆ˜ë¥¼ ì´ìš©í•œë‹¤.

ex) 1, null, 3 : (1+0+3)/3

```sql
SELECT     -- ê²°ì¸¡ê°’ ì œì™¸
    avg(commission_pct)
FROM hr.employees;

SELECT     -- ê²°ì¸¡ê°’ í¬í•¨
    avg(nvl(commission_pct,0))
FROM hr.employees;
```

## median(ì¤‘ì•™ê°’)

```sql
SELECT avg(salary), median(salary)
FROM hr.employees;
```

## variance (ë¶„ì‚°)

```sql
SELECT avg(salary), variance(salary)
FROM hr.employees;
```

## stddev(í‘œì¤€í¸ì°¨)

```sql
SELECT avg(salary), variance(salary), stddev(salary)
FROM hr.employees;
```

## max(ìµœëŒ“ê°’), min(ìµœì†Ÿê°’)

```sql
SELECT max(salary), min(salary), max(salary) - min(salary) "range"
FROM hr.employees;
```

```sql
SELECT
    count(last_name),
    count(hire_date),
    max(last_name),
    max(hire_date),
    min(last_name),
    min(hire_date)
FROM hr.employees;
```

## GROUP BY ì ˆ

- í…Œì´ë¸”ì˜ í–‰ì„ ì‘ì€ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆëŠ” ì ˆ

```sql
-- ë¶€ì„œë³„ ê¸‰ì—¬ ì´ì•¡ì„ êµ¬í•˜ê¸°
SELECT department_id, sum(salary)
FROM  hr.employees
GROUP BY department_id;
```

- ê·¸ë£¹í•¨ìˆ˜ ì‚¬ìš©ì‹œ ì£¼ì˜ í• ì 
    - null í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    - SELECTì ˆì— ê·¸ë£¹ í•¨ìˆ˜ì— í¬í•¨ë˜ì§€ ì•Šì€ ê°œë³„ ì»¬ëŸ¼ì€ í•˜ë‚˜ë„ ë¹ ì§ ì—†ì´ GROUP BY ì ˆì— ëª…ì‹œí•´ì•¼ í•œë‹¤.
    - GROUP BY ì ˆì—ëŠ” ì—´ ë³„ì¹­, ìœ„ì¹˜ í‘œê¸°ë²• ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. (ì˜¤ë¥˜ ë°œìƒ)
    - WHERE ì ˆì—ì„œëŠ” ê·¸ë£¹ í•¨ìˆ˜ì˜ ê²°ê³¼ë¥¼ ì œí•œí•  ìˆ˜ ì—†ë‹¤. (ì˜¤ë¥˜ ë°œìƒ)
    - ê·¸ë£¹ í•¨ìˆ˜ë¥¼ ë‘ ë²ˆ ì¤‘ì²©í•˜ê²Œ ë˜ë©´ ê°œë³„ ì»¬ëŸ¼ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. (ì˜¤ë¥˜ ë°œìƒ)

```sql
SELECT department_id, sum(salary)
FROM  hr.employees;

-- > ê·¸ë£¹ í•¨ìˆ˜ì— í¬í•¨ë˜ì–´ ìˆì§€ ì•ŠëŠ” ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ë©´ ì˜¤ë¥˜ë‚œë‹¤.
-- > GROUP BY ê¼­ ì“°ê¸°. 
```

```sql
-- GROUP BY ì ˆì— ë³„ì¹­ x, ì‹¤í–‰ ìˆœì„œ(SELECT ë³´ë‹¤ GROUP BTê°€ ë¨¼ì € ì‹¤í–‰)ë•Œë¬¸ì— ì˜¤ë¥˜ë‚œë‹¤.
SELECT department_id dept_id, job_id, sum(salary)
FROM hr.employees
GROUP BY dept_id, job_id;
```

```sql
-- WHERE ì ˆì€ í–‰ì„ ì œí•œí•˜ëŠ” ì ˆì´ë‹¤.
SELECT department_id, sum(salary)
FROM hr.employees
WHERE sum(salary) >= 15000
GROUP BY department_id;
```

## HAVING ì ˆ

- ê·¸ë£¹ í•¨ìˆ˜ì˜ ê²°ê³¼ë¥¼ ì œí•œí•˜ëŠ” ì ˆ

```sql
SELECT department_id, sum(salary)
FROM hr.employees
GROUP BY department_id
HAVING sum(salary) >= 15000;

-- GROUP BY(1)ì™€ HAVING ì ˆ(2)ì€ ìˆœì„œ ë°”ê¿”ë„ ë¬´ë°©í•˜ë‹¤.
SELECT department_id, sum(salary)
FROM hr.employees
HAVING sum(salary) >= 15000
GROUP BY department_id;
```

```sql
SELECT department_id, sum(salary)
FROM hr.employees
GROUP BY department_id
HAVING count(*) >= 5;
```

```sql
-- ìˆœì„œ ì§€í‚¤ê¸°
SELECT department_id, sum(salary)
FROM hr.employees    
WHERE last_name like '%i%' 
GROUP BY department_id
HAVING sum(salary) >= 10000
ORDER BY 1;
```

```sql
-- ê·¸ë£¹ í•¨ìˆ˜ ì¤‘ì²©ì‹œ, ì˜¤ë¥˜ ë°œìƒ (ë‹¨ì¼í–‰í•¨ìˆ˜ê°€ ì•„ë‹Œë° ë‹¨ì¼í–‰í•¨ìˆ˜ì²˜ëŸ¼ ì‚¬ìš©í–ˆìœ¼ë¯€ë¡œ) 
-- í•´ê²° ë°©ë²•ì€ ì„œë¸Œ ì¿¼ë¦¬ë¥¼ ì´ìš©í•´ì•¼ í•œë‹¤.
SELECT department_id ,max(sum(salary))
FROM hr.employees
GROUP BY deparment_id;
```