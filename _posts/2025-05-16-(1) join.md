---
title: "[19ì¼ì°¨] join"
excerpt: "ì•„ì´í‹°ìœŒ 0516_(1)"
categories:
      - ORACLE11g
tags:
      -  ORACLE11g
      - TIL
last-modified-at: 2025-05-16T20:46
---

# JOIN(ì¡°ì¸)

- ë‘ ê°œ ì´ìƒì˜ í…Œì´ë¸”ì—ì„œ ë‚´ê°€ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•

## cartesian product

- ì¡°ì¸ ì¡°ê±´ì´ ìƒëµëœ ê²½ìš°
- ì¡°ì¸ ì¡°ê±´ì„ ì˜ëª» ìƒì„±í•œ ê²½ìš°
- ì²«ë²ˆì§¸ í…Œì´ë¸” í–‰ì˜ ìˆ˜ì™€ ë‘ë²ˆì§¸ í…Œì´ë¸”ì˜ í–‰ìˆ˜ê°€ ê³±í•´ì§„ë‹¤.

```sql
SELECT employee_id, department_name
FROM hr.employees, hr.departments;
```

## equi join ( = inner join, simple join, ë“±ê°€ ì¡°ì¸)

- ì¡°ì¸í‚¤ê°’ì´ ì¼ì¹˜í•˜ëŠ” ë°ì´í„°ë§Œ ì¶”ì¶œí•˜ëŠ” ì¡°ì¸

```sql
SELECT employee_id, department_name
FROM hr.employees e , hr.departments d
WHERE e.department_id = d.department_id;  -- ì¡°ì¸ ì¡°ê±´ ìˆ ì–´
      ---------------  -----------------
      -- mìª½ ì§‘í•©(107)   *  1ìª½ ì§‘í•©(27)   =   mìª½ ê²°ê³¼ ì§‘í•©
```

â†’ 106ê°œ ë‚˜ì™”ë‹¤. ì‚¬ì› ìˆ˜ëŠ” 107ëª…ì¸ë° ê·¸ ì¤‘ department_idê°€ ì—†ëŠ” ì‚¬ì›ì´ 1ëª… ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.

![image.png](/assets/20250516/1.png)

â†’ ì¡°ì¸í•˜ê¸° ìœ„í•´ì„œëŠ” ì—…ë¬´ ë¶„ì„ì´ ë¨¼ì €ë‹¤. ERD ë¨¼ì € ë³´ê³  ë‹´ë‹¹ìì—ê²Œ ë¬¼ì–´ë³´ì.

â†’ ì–‘ìª½ í…Œì´ë¸”ì˜ ë˜‘ê°™ì€ ì´ë¦„ ì°¾ì•„ë³´ê¸°

â†’ ê°ê°ì˜ í…Œì´ë¸”ì—ì„œ ì»¬ëŸ¼ , ë˜‘ê°™ì€ ì´ë¦„ì´ë¼ë„ ì˜ë¯¸ëŠ” ì„œë¡œ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤.

ex) employees í…Œì´ë¸”ì˜ manage_id : ì§ì† ìƒê´€, department í…Œì´ë¸”ì˜ manager_id 

ğŸ“ SQL command ì°½ì—ì„œ 

```sql
-- (1)
SELECT employee_id, department_id
FROM   hr.employees
ORDER BY 2;

-- (2)
SELECT department_id, department_name
FROM   hr.departments
ORDER BY 1;
```

![image.png](/assets/20250516/2.png)

```sql
SELECT department_id, department_name   
FROM   hr.departments;

SELECT employee_id, last_name
FROM   hr.employees;

-- ì¡°ì¸ì€ í”„ë¡œê·¸ë˜ë°ì  ê´€ì ì—ì„œ ë³´ë©´ ë£¨í”„ì˜ ë°˜ë³µì´ë‹¤. 1 : N 
SELECT e.employee_id, e.last_name, e.first_name, e.salary , d.department_name
FROM hr.employee e, hr.departments d
WHERE e.employee_id = d.manager_id;
```

![image.png](/assets/20250516/3.png)

```sql
-- sql*plus í˜ì´ì§€ ë§ì´ ë‚˜ì˜¬ ê²½ìš°
SQL> set pagesize 1000
/

-- linesize
SQL> set linesize 200 
/

--ì—´ í­
SQL> col last_name format a15     -- col ì—´ format ìë¦¬ìˆ˜
/
```

```sql
-- í˜„ì¬ ì‚¬ì›ë“¤ì´ ê·¼ë¬´í•˜ê³  ìˆëŠ” ë„ì‹œ ì •ë³´ë¥¼ íŒŒì•…í•´ì£¼ì„¸ìš”.
-- LOCATIONS TABLE : ë¶€ì„œ ì •ë³´ ë°ì´í„°
-- employeesì™€ locations ì‚¬ì´ì— ì—°ê²° ê³ ë¦¬ê°€ ì—†ë‹¤. departments í…Œì´ë¸”ì„ ì´ìš©í•œë‹¤.
-- departments í…Œì´ë¸”ì˜ location_id ì™€ locations í…Œì´ë¸”ì˜ location_idë¥¼ ì—°ê²°í•œë‹¤.

SELECT employee_id
FROM hr.employees;

SELECT city
FROM hr.locations;

--------------

SELECT employee_id, city          -- 
FROM hr.employees, hr.locations;

SELECT department_id, location_id
FROM hr.departments;

SELECT location_id, city
FROM hr.locations;

--- (1) ---
SELECT e.employee_id, d.location_id
FROM hr.employees e, hr.departments d
WHERE e.department_id = d.department_id;

-- (2) 
SELECT (1) ì¡°ì¸ ê²°ê³¼ ì§‘í•©location_id, city    
FROM hr.locations l   (1) ,ì¡°ì¸ ê²°ê³¼ ì§‘í•©
WHERE l.location_id = (1) ì¡°ì¸ê²°ê³¼ì§‘í•© d.location_id;

-- 1) 2) í•©ì¹˜ì
SELECT e.employee_id, l.city
FROM hr.employees e, hr.departments d, hr.locations l
WHERE e.department_id = d.department_id <- ì¡°ì¸ ì¡°ê±´ ìˆ ì–´
AND d.location_id = l.location_id;

```

**nê°œ í…Œì´ë¸”ì„ ì¡°ì¸í•˜ë ¤ë©´ ì¡°ì¸ ì¡°ê±´ ìˆ ì–´ëŠ” n-1ê°œì˜ ì¡°ì¸ì¡°ê±´ìˆ ì–´ë¥¼ ì‘ì„±í•´ì•¼í•œë‹¤.**

```sql
-- í˜„ì¬ ì‚¬ì›ë“¤ì´ ê·¼ë¬´í•˜ê³  ìˆëŠ” êµ­ê°€ ì •ë³´ë¥¼ íŒŒì•…í•´ì£¼ì„¸ìš”.
-- COUNTRIES : êµ­ê°€ ì •ë³´
-- ì´ê²ƒë„ employees í…Œì´ë¸”ê³¼ ì§ì ‘ì ìœ¼ë¡œ ì—°ê²°ë˜ì§€ ì•Šì•˜ë‹¤.
-- ë¨¼ì € LOCATION í…Œì´ë¸”ê³¼ ì¡°ì¸í•œ ê²°ê³¼ë¥¼ ê°€ì§€ê³  COUNTRIES í…Œì´ë¸”ê³¼ ì¡°ì¸í•´ì•¼ í• ê¹Œ

SELECT e.employee_id, c.country_name
FROM hr.employees e, hr.departments d, hr.locations l, hr.countries c
WHERE e.department_id = d.department_id -- <- ì¡°ì¸ ì¡°ê±´ ìˆ ì–´
AND d.location_id = l.location_id
AND l.country_id = c.country_id;
```

## outer join

- í‚¤ ê°’ì´ ì¼ì¹˜ ë˜ëŠ” ë°ì´í„°, í‚¤ ê°’ì´ ì¼ì¹˜ ë˜ì§€ ì•Šì€ ë°ì´í„°ë„ ì¶œë ¥í•˜ëŠ” ì¡°ì¸
- í•œ ìª½ì—ë§Œ (+) í‘œí˜„í•œë‹¤.
- ì–‘ ìª½ì— (+) ë¥¼ ìˆ˜í–‰í•˜ë©´ ì˜¤ë¥˜ ë°œìƒ

```sql
-- í‚¤ ê°’ì´ ì¼ì¹˜ë˜ëŠ” ë°ì´í„° ë½‘ê³ , (+)ë¶€í˜¸ê°€ ì¨ì ¸ìˆì§€ ì•ŠëŠ” ë‹¤ë¥¸ìª½ í…Œì´ë¸”ì˜ ì¼ì¹˜ë˜ì§€ ì•ŠëŠ” ì •ë³´ ë½‘ëŠ”ë‹¤.
SELECT
    e.last_name, e.job_id, d.department_name
FROM hr.employees e, hr.departments d
WHERE e.department_id = d.department_id(+);
```

```sql
-- ì¼ì¹˜ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ëª¨ë‘ ë½‘ê³  ì‹¶ê¸°ì— 
SELECT
    e.last_name, e.job_id, d.department_name, l.city
FROM hr.employees e, hr.departments d, hr.locations l
WHERE e.department_id = d.department_id(+)  
AND d.location_id = l.location_id(+); 
```

```sql
-- ì˜¤ë¥˜ ë°œìƒ. ansi ëŠ” ì´ ê²½ìš° full outer joinì„ í•œë‹¤. ì˜¤ë¼í´ì€ union ì„ ì´ìš©í•œë‹¤.
-- ì–‘ìª½ì„ ë‹¤ í•©ì¹˜ê³  ì¤‘ë³µì„ ì‚­ì œí•˜ê³  ì‹¶ì€ ê²ƒ
SELECT
    e.last_name, e.job_id, d.department_name
FROM hr.employees e, hr.departments d
WHERE e.department_id(+) = d.department_id(+);
```

## self join

- ìì‹ ì˜ í…Œì´ë¸”ì„ ì°¸ì¡°í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ì¡°ì¸

![image.png](/assets/20250516/4.png)

```sql
SELECT *
FROM hr.employees;

-- ì‚¬ì› í…Œì´ë¸”
SELECT employee_id, last_name, manager_id
FROM hr.employees;

-- ê´€ë¦¬ì í…Œì´ë¸”
SELECT employee_id, last_name
FROM hr.employees
ORDER BY 1;

SELECT w.employee_id, w.last_name, m.employee_id, m.last_name
FROM hr.employees w,hr.employees m
WHERE w.manager_id = m.employee_id
ORDER BY 1;
```

```sql
-- ì•„ìš°í„° ì¡°ì¸ : ì§ì† ìƒê´€ì´ ì—†ëŠ” King (ì‚¬ì¥ë‹˜)ë„ ë³´ê³  ì‹¶ë‹¤. 
SELECT w.employee_id, w.last_name, m.employee_id, m.last_name
FROM hr.employees w,hr.employees m
WHERE w.manager_id = m.employee_id(+)
ORDER BY 1;
```

## non-equi-join

- equi join(=) í•  ìˆ˜ ì—†ëŠ” ë‹¤ë¥¸ ë¹„êµ ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ëŠ” ì¡°ì¸ ê¸°ë²•
- ê°’ì„ ë²”ìœ„ë¡œ ì¡°ì¸í•˜ë ¤ëŠ” ê²½ìš° ë§ì´ ì‚¬ìš©ëœë‹¤.

ë¨¼ì € í…Œì´ë¸”ì„ ë§Œë“ ë‹¤.

```sql
-- F5ë²ˆ ëˆ„ë¥´ë©´ í•œêº¼ë²ˆì— ì‹¤í–‰.
-- ê¸‰ì—¬ì˜ ë“±ê¸‰ ë ˆì´ë¸”
DROP TABLE hr.job_grades purge;
CREATE TABLE hr.job_grades
( grade_level varchar2(3),
  lowest_sal  number,
  highest_sal number);

INSERT INTO hr.job_grades VALUES ('A',1000,2999);
INSERT INTO hr.job_grades VALUES ('B',3000,5999);
INSERT INTO hr.job_grades VALUES ('C',6000,9999);
INSERT INTO hr.job_grades VALUES ('D',10000,14999);
INSERT INTO hr.job_grades VALUES ('E',15000,24999);
INSERT INTO hr.job_grades VALUES ('F',25000,40000);
commit;
```

```sql
-- ì‚¬ì›ë“¤ ê¸‰ì—¬ì˜ ë“±ê¸‰ ë ˆì´ë¸”
SELECT employee_id, salary, j.grade_level
FROM hr.employees e, hr.job_grades j
WHERE e.salary >= j.lowest_sal
AND e.salary <= j.highest_sal;

SELECT employee_id, salary, j.grade_level
FROM hr.employees e, hr.job_grades j
WHERE e.salary BETWEEN j.lowest_sal AND j.highest_sal;
```

![image.png](/assets/20250516/5.png)

```sql
-- ë¶€ì„œ ì´ë¦„ê¹Œì§€ íŒŒì•…
SELECT e.employee_id, e.salary , j.grade_level, d.department_name
FROM hr.employees e , hr.departments d, job_grades j
WHERE e.salary >= j.lowest_sal
AND e.salary <= j.highest_sal
AND e.department_id = d.department_id(+);
```

![image.png](/assets/20250516/6.png)
