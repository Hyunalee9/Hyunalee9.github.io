---
title: "[14ÏùºÏ∞®] python14"
excerpt: "ÏïÑÏù¥Ìã∞Ïúå 0509_Merge, Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù"
categories:
      - Python
tags:
      - Python
      - TIL
last-modified-at: 2025-05-08T23:15
---

# 250509  Merge, Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù

# **DataFrame Merge(Join)**

```python
emp = pd.DataFrame(data={
    'empno':[100,101,200,201],
    'ename':['ÌôçÍ∏∏Îèô', 'Ïò§Ïå§', 'Scott', 'King'],
    'deptno': [10,10,20,40]
})
emp
```

![image.png](/assets/20250509/1.png)

```python
dept = pd.DataFrame(data={
    'deptno' : [10, 20, 30],
    'dname' : ['IT','HR','Sales']
})
dept
```

![image.png](/assets/20250509/2.png)

- `pd.merge(df1, df2, how, on, ...)`¬†Ìï®Ïàò(function)
- `pd.DataFrame.merge(df, how, on, ..)`¬†Î©îÏÑúÎìú(method)
- `how`¬†ÌååÎùºÎØ∏ÌÑ∞: merge(join) Î∞©Ïãù ÏÑ§Ï†ï.
    - inner, left, right, outer
    - mergeÏùò Í∏∞Î≥∏Í∞íÏùÄ inner. how=`inner`ÏÉùÎûµ Í∞ÄÎä•.
- `on`¬†ÌååÎùºÎØ∏ÌÑ∞: merge(join)Ïùò Í∏∞Ï§ÄÏù¥ ÎêòÎäî Ïª¨Îüº(Ïª¨ÎüºÎì§Ïùò Î¶¨Ïä§Ìä∏)Î•º ÏÑ§Ï†ï.
    - merge(join)Î•º ÌïòÎ†§Îäî 2Í∞úÏùò Îç∞Ïù¥ÌÑ∞ÌîÑÎ†àÏûÑÏóêÏÑú Ïª¨Îüº Ïù¥Î¶ÑÏù¥ Í∞ôÏùÄ Í≤ΩÏö∞ÏóêÎäî on ÌååÎùºÎØ∏ÌÑ∞ ÏÑ§Ï†ïÏùÑ ÏÉùÎûµ Í∞ÄÎä•.

## **inner join**

```python
pd.merge(emp, dept)
# how='inner', on='deptno' ÏÉùÎûµ 
```

![image.png](/assets/20250509/3.png)

```python
emp.merge(dept)  # left join
```

![image.png](/assets/20250509/4.png)

```python
dept.merge(emp)  # right join 
```

![image.png](/assets/20250509/5.png)

## **left outer join**

![image.png](/assets/20250509/6.png)

```python
pd.merge(emp, dept, how='left')  # emp ÌÖåÏù¥Î∏îÏùò Í∞íÏùÄ Î™®Îëê Ï°¥Ïû¨ÌïòÎÇò, dept ÌÖåÏù¥Î∏î Í∞íÏùÄ ÏóÜÎäî Í∞íÏù¥ Ï°¥Ïû¨ÌïúÎã§. 
```

![image.png](/assets/20250509/7.png)

## right (outer) join

```python
pd.merge(emp,dept,how='right')
```

![image.png](/assets/20250509/8.png)

## **(full) outer join**

```python
pd.merge(emp, dept, how='outer')
```

![image.png](/assets/20250509/9.png)

## **merge(join) Í∏∞Ï§ÄÏù¥ ÎêòÎäî Ïª¨Îüº Ïù¥Î¶ÑÏù¥ Îã§Î•∏ Í≤ΩÏö∞**

```python
dept = pd.DataFrame(data={
    'dno' : [10, 20, 30],
    'dname' : ['IT','HR','Sales']
})
dept
```

![image.png](/assets/20250509/10.png)

```python
pd.merge(emp, dept, left_on='deptno', right_on = 'dno')
```

![image.png](/assets/20250509/11.png)

```python
# ÏÇ¨Î≤à, Ïù¥Î¶Ñ, ÏóÖÎ¨¥, Îß§ÎãàÏ†Ä ÏÇ¨Î≤à, ÏûÖÏÇ¨ÎÇ†Ïßú, Í∏âÏó¨, ÏàòÎãπ, Î∂ÄÏÑúÎ≤àÌò∏
emp_col_names = ['empno','ename','job','mgr','hiredate','sal','comm','deptno']
emp_file = 'https://raw.githubusercontent.com/JakeOh/202504_itwill_oracle88/refs/heads/main/emp.csv'
```

```python
# emp_fileÏùÑ ÏùΩÏñ¥ÏÑú Îç∞Ïù¥ÌÑ∞ÌîÑÎ†àÏûÑÏùÑ ÏÉùÏÑ±.
emp = pd.read_csv(emp_file, names=emp_col_names)
emp
```

```python
# Î∂ÄÏÑúÎ≤àÌò∏, Î∂ÄÏÑúÏù¥Î¶Ñ, Î∂ÄÏÑúÏúÑÏπò
dept_col_names = ['deptno', 'dname', 'loc']
dept_file = 'https://raw.githubusercontent.com/JakeOh/202504_itwill_oracle88/refs/heads/main/dept.csv'
```

```python
# dept_fileÏùÑ ÏùΩÏñ¥ÏÑú Îç∞Ïù¥ÌÑ∞ÌîÑÎ†àÏûÑÏùÑ ÏÉùÏÑ±.
dept = pd.read_csv(dept_file, names=dept_col_names)
dept
```

![image.png](/assets/20250509/12.png)

Î∂ÄÏÑúÎ≥Ñ Í∏âÏó¨ ÌèâÍ∑†

```python
emp_by_deptno = emp.groupby(by='deptno').sal.mean()
```

```python
emp_dept = pd.merge(emp,dept) # inner join 
emp_dept.groupby(by=['deptno', 'dname']).sal.mean()
```

Self-Join  - ÏßÅÏõêÍ≥º Îß§ÎãàÏ†Ä Ï†ïÎ≥¥Î•º ÌïòÎÇòÏùò Îç∞Ïù¥ÌÑ∞ ÌîÑÎ†àÏûÑÏúºÎ°ú merge(join)

```python
pd.merge(emp, emp, left_on='mgr', right_on ='empno')  # inner join  , ÏÇ¨Ïû•Îãò(KING) ÎπºÍ≥† 
```

```python
pd.merge(emp, emp, how='left', left_on='mgr', right_on ='empno')  # left join
```

## **DataFrame Î™®Ïñë Î∞îÍæ∏Í∏∞(Reshape)**

**melt**

`pd.DataFrame.melt()`¬†Î©îÏÑúÎìú: wide-form Îç∞Ïù¥ÌÑ∞Î•º long-form Îç∞Ïù¥ÌÑ∞Î°ú Î≥ÄÌôò

- `id_vars`¬†ÌååÎùºÎØ∏ÌÑ∞: melting ÎèôÏûëÏùÑ Ìï† Îïå Ïª¨ÎüºÏúºÎ°ú Ïú†ÏßÄÌï† Ïª¨Îüº Ïù¥Î¶Ñ(Îì§).
    - `id_vars`Î°ú ÏÑ§Ï†ïÌïòÏßÄ ÏïäÏùÄ Î™®Îì† Î≥ÄÏàò(Ïª¨Îüº)Îì§ÏùÄ¬†`variable`¬†Ïª¨ÎüºÏúºÎ°ú meltingÎê®.
    - `id_vars`Î°ú ÏÑ§Ï†ïÌïòÏßÄ ÏïäÏùÄ Î™®Îì† Î≥ÄÏàò(Ïª¨Îüº)Îì§Ïùò ÏÖÄÏóê ÏûàÎäî Í∞íÎì§ÏùÄ¬†`value`¬†Ïª¨ÎüºÏúºÎ°ú meltingÎê®.
- `var name`¬†ÌååÎùºÎØ∏ÌÑ∞:¬†`variable`¬†Ïª¨ÎüºÏùò Ïù¥Î¶ÑÏúºÎ°ú ÏÇ¨Ïö©Ìï† Î¨∏ÏûêÏó¥.
- `value_name ÌååÎùºÎØ∏ÌÑ∞:`value` Ïª¨ÎüºÏùò Ïù¥Î¶ÑÏúºÎ°ú ÏÇ¨Ïö©Ìï† Î¨∏ÏûêÏó¥.

```python
df = pd.DataFrame({
    'gender' : ['Female', 'Male'],
    'lunch' : [10,5],
    'dinner' : [20,30]
})
df
```

![image.png](/assets/20250509/13.png)

```python
df.melt(id_vars=['gender'])   # gender Ïª¨ÎüºÏùÄ Ïú†ÏßÄÎêòÍ≥†, lunchÏôÄ dinner Ïª¨ÎüºÏùÄ Î≥ÄÏàòÍ∞Ä ÎêòÏóàÎã§.
```

![image.png](/assets/20250509/14.png)

```python
df.melt(id_vars=['gender'], var_name='time', value_name='size')
```

![image.png](/assets/20250509/15.png)

**pivot**

`pd.DataFrame.pivot()`¬†Î©îÏÑúÎìú: long-form(ÏÑ∏Î°úÎ°ú Í∏¥) Îç∞Ïù¥ÌÑ∞ÌîÑÎ†àÏûÑÏùÑ wide-form(Í∞ÄÎ°úÎ°ú Í∏¥) Îç∞Ïù¥ÌÑ∞ÌîÑÎ†àÏûÑÏúºÎ°ú Î≥ÄÌôò.

- `index`¬†ÌååÎùºÎØ∏ÌÑ∞: pivotingÌïú Îç∞Ïù¥ÌÑ∞ ÌîÑÎ†àÏûÑÏóêÏÑú row indexÎ°ú ÏÇ¨Ïö©Ìï† Ïª¨Îüº(Îì§)Ïùò Ïù¥Î¶Ñ.
- `columns`¬†ÌååÎùºÎØ∏ÌÑ∞: pivotingÌïú Îç∞Ïù¥ÌÑ∞ÌîÑÎ†àÏûÑÏóêÏÑú Ïª¨Îüº Ïù¥Î¶ÑÏúºÎ°ú ÏÇ¨Ïö©Ìï† Ïª¨Îüº(Îì§)Ïùò Ïù¥Î¶Ñ.
- `values`¬†ÌååÎùºÎØ∏ÌÑ∞: pivotingÌïú Îç∞Ïù¥ÌÑ∞ÌîÑÎ†àÏûÑÏùò Í∞Å ÏÖÄÏóê Ï±ÑÏö∏ Í∞íÎì§Ïù¥ ÏûàÎäî Ïª¨Îüº(Îì§)Ïùò Ïù¥Î¶Ñ.

```python
df2 = pd.DataFrame({
    'time': ['Lunch'] * 3 + ['Dinner'] * 3,
    'day' : ['Fri','Sat','Sun'] * 2,
    'total_bill' : np.arange(10,70,10),
    'tip' : np.arange(1,7)
})
df2
```

![image.png](/assets/20250509/16.png)

```python
df2.pivot(index='time', columns='day', values='tip')
```

![image.png](/assets/20250509/17.png)

```python
result = df2.pivot(index='time', columns='day', values=['total_bill','tip'])
```

```python
df2.pivot(index='day', columns='time', values='tip')
```

Ïó¥Í≥º Ìñâ Î∞îÍæ∏Í∏∞

```python
df2.pivot(index='day', columns='time', values='tip')
```

![image.png](/assets/20250509/18.png)

```python
df2.pivot(index='day', columns='time', values=['total_bill','tip'])
```

## **pivot table**

`pd.DataFrame.pivot_table()`¬†Î©îÏÑúÎìú ÌååÎùºÎØ∏ÌÑ∞:

- `values`: pivotingÏùÑ Ìï¥ÏÑú Í∞Å ÏÖÄÏóê Í∞íÏúºÎ°ú ÏÑ§Ï†ïÌï† Î≥ÄÏàò(Îì§).
- `index`¬†: pivotingÏùÑ Ìï† Îïå row indexÎ°ú ÏÑ§Ï†ïÌï† Î≥ÄÏàò(Îì§).
- `columns`¬†: pivotingÏùÑ Ìï† Îïå Ïª¨Îüº Ïù¥Î¶ÑÏúºÎ°ú ÏÑ§Ï†ïÌï† Î≥ÄÏàò(Îì§).
- `aggfunc`¬†: aggregation function(ÏßëÍ≥Ñ Ìï®Ïàò). ÌÜµÍ≥Ñ Í∞íÏùÑ Í≥ÑÏÇ∞ÌïòÎäî Ìï®Ïàò Ïù¥Î¶Ñ ÎòêÎäî Ìï®Ïàò Í∞ùÏ≤¥.
    - aggfunc ÌååÎùºÎØ∏ÌÑ∞Ïùò Í∏∞Î≥∏Í∞íÏùÄ 'mean'.

Îç∞Ïù¥ÌÑ∞ÏÖã tips

```python
# ÏÑ±Î≥Ñ ÌåÅÏùò ÌèâÍ∑†
tips.pivot_table(values='tip', index='sex', observed=True)  # aggfunc = 'mean' ÏÉùÎûµ
```

![image.png](/assets/20250509/19.png)

```python
# ÏÑ±Î≥Ñ Ìù°Ïó∞Ïó¨Î∂ÄÎ≥Ñ ÌåÅÏùò ÌèâÍ∑†
tips.pivot_table(values='tip', index=['sex', 'smoker'], observed=True)
```

![image.png](/assets/20250509/20.png)

```python
tips.pivot_table(values='tip', index='sex', columns='smoker', observed=True)   # indexÏôÄ columns Îäî Î≤îÏ£ºÌòï Î≥ÄÏàòÎ•º Í∏∞ÏûÖ values Îäî Ï£ºÎ°ú Ïà´Ïûê ÌÉÄÏûÖ Î≥ÄÏàò
```

![image.png](/assets/20250509/21.png)

**ÏßëÍ≥Ñ Ìï®Ïàò(aggfunc)Í∞Ä Ïó¨Îü¨ Í∞úÏù∏ Í≤ΩÏö∞**

```python
# ÏÑ±Î≥Ñ ÏöîÏùºÎ≥Ñ ÌåÅÏùò ÌèâÍ∑†, ÏµúÏÜüÍ∞í, ÏµúÎåìÍ∞í
tips.pivot_table(values='tip', index=['sex','day'], aggfunc=['mean', 'min', 'max'], observed=True)
```

![image.png](/assets/20250509/22.png)

```python
tips.pivot_table(values=['tip'], index='sex',columns='day', aggfunc=['mean','min','max'], observed=True)
```

![image.png](/assets/20250509/23.png)

# Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù

üìçÎç∞Ïù¥ÌÑ∞ ÏàòÏßë Í≤ΩÎ°ú ÏÜåÍ∞ú 

- https://www.data.go.kr/index.do
- https://data.seoul.go.kr/
- https://data.molit.go.kr/

## **ColabÏóêÏÑú ÌïúÍ∏Ä Ìè∞Ìä∏ ÏÇ¨Ïö©ÌïòÍ∏∞**

**Step 1. ÌïúÍ∏Ä Ìè∞Ìä∏ ÏÑ§Ïπò**

```python
# Jupyther notebook ÌôòÍ≤ΩÏóêÏÑú Î¶¨ÎàÖÏä§ Î™ÖÎ†πÏñ¥Î•º Ïã§Ìñâ
# sudo - Í¥ÄÎ¶¨Ïûê Í∂åÌïú ÏñªÍ∏∞
# apt-get ÌîÑÎ°úÍ∑∏Îû® ÏÑ§ÏßÄ/Ï†úÍ±∞Ìï† Îïå
# -y : ÏÑ§Ïπò Ï§ë Î¨ºÏùå Î™®Îëê ÎèôÏùò
!sudo apt-get install -y fonts-nanum
!sudo fc-cache -fv   # Ï∫êÏâ¨ ÏßÄÏõÄ
!rm ~/.cache/matplotlib -rf    # matplotlib Ìè¥Îçî ÏßÄÏõåÏßê
```

**Step 2. Colab Runtime Ïû¨ÏãúÏûë(ÏÑ∏ÏÖò Îã§Ïãú ÏãúÏûë Ctrl+M)**

**Step 3. matplotlib Ìå®ÌÇ§ÏßÄÏóêÏÑú ÌïúÍ∏Ä Ìè∞Ìä∏Î•º ÏÇ¨Ïö©Ìï† Ïàò ÏûàÎèÑÎ°ù ÏÑ§Ï†ï**

```python
from logging import fatal
import matplotlib.pyplot as plt
plt.rc('font', family='NanumBarunGothic')
```

```python
# ÌïúÍ∏Ä Ìè∞Ìä∏ ÌÖåÏä§Ìä∏
import pandas as pd

df = pd.DataFrame({
    'Íµ¨' : ['Í∞ïÎÇ®Íµ¨', 'ÏÑúÏ¥àÍµ¨'],
    'Ïú†ÎèôÏù∏Íµ¨' : [1_000, 1_100]   # _ : Ï≤ú ÏûêÎ¶¨Î•º Íµ¨Î∂ÑÌïòÍ∏∞ ÏúÑÌï¥ÏÑú ÏÇ¨Ïö© Í∞ÄÎä•
})

plt.bar(x=df['Íµ¨'], height=df['Ïú†ÎèôÏù∏Íµ¨'])
plt.xlabel('Íµ¨')
plt.ylabel('Ïú†ÎèôÏù∏Íµ¨')
plt.show()
```

![image.png](/assets/20250509/24.png)

ÌïúÍ∏Ä Ìè∞Ìä∏ Ïûò Î°úÎìúÎêúÎã§.

# **2025ÎÖÑ 4Ïõî Ï†ÑÍµ≠ ÏïÑÌååÌä∏ Ïã§Í±∞ÎûòÍ∞Ä Î∂ÑÏÑù**

## **ÌïÑÏöî Ìå®ÌÇ§ÏßÄ import**

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
```

## **Îç∞Ïù¥ÌÑ∞ÌîÑÎ†àÏûÑ ÏÉùÏÑ±**

```python
file_path = 'https://github.com/JakeOh/202504_itwill_oracle88/raw/refs/heads/main/apt_202504.csv'
```

```python
apt = pd.read_csv(file_path, skiprows=15, encoding='euc-kr', thousands=',')
# skiprows ÌååÎùºÎØ∏ÌÑ∞: ÌååÏùºÏóêÏÑú ÏÉùÎûµÌïòÍ≥† ÎÑòÏñ¥Í∞ÄÎäî Ï§Ñ Ïàò.
# encoding ÌååÎùºÎØ∏ÌÑ∞: ÌÖçÏä§Ìä∏ ÌååÏùºÏùò Ïù∏ÏΩîÎî© ÌÉÄÏûÖÏùÑ ÏÑ§Ï†ï. (Ïòà) utf-8(Linux, MacOS), cp949(ÌïúÍ∏Ä Windows), euc-kr, ...
# thousands ÌååÎùºÎØ∏ÌÑ∞: Ïà´Ïûê ÏûêÎ£åÏóêÏÑú Ï≤úÏûêÎ¶¨ Íµ¨Î∂ÑÏûêÍ∞Ä ÏÇ¨Ïö©ÎêòÍ≥† ÏûàÏùÑ Îïå. (Ïòà) 10,000
```

## Îç∞Ïù¥ÌÑ∞ ÌîÑÎ†àÏûÑ ÌååÏïÖ

```python
apt.head()
```

![image.png](/assets/20250509/25.png)

```python
# 36974 Ìñâ , 20Í∞úÏùò Ïó¥
# Í≤∞Ï∏°Í∞íÏùÄ Î≤àÏßÄ Ïª¨ÎüºÏóê 1Í∞ú ÏûàÏùå
apt.info()
```

![image.png](/assets/20250509/26.png)

## **Îç∞Ïù¥ÌÑ∞ ÌÉêÏÉâ ÏãúÍ∞ÅÌôî**

ÏïÑÌååÌä∏ Ï†ÑÏö© Î©¥Ï†Å Î∂ÑÌè¨ ÏãúÍ∞ÅÌôî

![image.png](/assets/20250509/27.png)

```python
# ÏïÑÏõÉÎùºÏù¥Ïñ¥Í∞Ä ÍµâÏû•Ìûà ÎßéÎã§.
sns.boxplot(data=apt, x='Ï†ÑÏö©Î©¥Ï†Å(„é°)')
plt.show()
```

![image.png](/assets/20250509/28.png)

```python
sns.histplot(data=apt, x='Ï†ÑÏö©Î©¥Ï†Å(„é°)', bins=20)
plt.show()
```

![image.png](/assets/20250509/29.png)

```
fig, axes = plt.subplots(nrows=2, ncols=1, figsize=(6,10))

sns.boxplot(data=apt, x='Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)', ax=axes[0])
# ÏïÑÌååÌä∏ Í∞ÄÍ≤©Ïùò Î∂ÑÌè¨Îäî ÏôºÏ™ΩÏúºÎ°ú ÏπòÏö∞Ïπú(left-skewed) Í≤ΩÌñ•Ïù¥ ÏûàÎã§.
sns.histplot(data=apt, x='Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)', ax=axes[1])
plt.show()
```

![image.png](/assets/20250509/30.png)

## **Í±∞ÎûòÏú†Ìòï ÎπàÎèÑÏàò**

```python
apt['Í±∞ÎûòÏú†Ìòï'].value_counts()   # ÎåÄÎ∂ÄÎ∂Ñ Ï§ëÍ∞úÍ±∞ÎûòÎ•º ÌÜµÌï¥ ÏïÑÌååÌä∏Î•º Íµ¨Îß§
```

**ÏãúÍ∞ÅÌôî**

```python
# countplot : Ïπ¥ÌÖåÍ≥†Î¶¨(Î≤îÏ£º) ÌÉÄÏûÖ Î≥ÄÏàòÏùò ÎπàÎèÑÏàòÎ•º ÎßâÎåÄÎ°ú ÌëúÌòÑÌïú Í∑∏ÎûòÌîÑ
sns.countplot(data=apt, x='Í±∞ÎûòÏú†Ìòï')
plt.show()
```

![image.png](/assets/20250509/31.png)

Í±∞ÎûòÍ∞ÄÍ≤© ÏµúÎåìÍ∞í/ÏµúÏÜüÍ∞í Ìñâ(row) Í≤ÄÏÉâ

```python
pt[((apt['Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)']) == apt['Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)'].max()) | (apt['Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)'] == apt['Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)'].min())]
```

![image.png](/assets/20250509/32.png)

‚Üí 105ÏñµÏù¥ ÏµúÍ≥†Í∞Ä, 1200ÎßåÏõêÏù¥ ÏµúÏ†ÄÍ∞Ä (ÌôîÎì§Ïßù ÎÜÄÎùºÏÑú Íµ¨Í∏ÄÏóê Í≤ÄÏÉâÌï¥Î¥§ÎäîÎç∞ Ï†ïÎßê 1200ÎßåÏõêÏù¥ÏóàÎã§.)

## **ÌååÏÉùÎ≥ÄÏàò Ï∂îÍ∞Ä**

```python
# str(property) : ÏãúÎ¶¨Ï¶àÏïàÏóê ÏûàÎäî stringÏùÑ Îã§Î£®Í≥† Ïã∂ÏùÑÎïå ÏÇ¨Ïö©
# ex) Ïù∏Ï≤úÍ¥ëÏó≠Ïãú Î∂ÄÌèâÍµ¨ Î∂ÄÌèâÎèô -> province : Ïù∏Ï≤úÍ¥ëÏó≠Ïãú 
apt['province']= apt['ÏãúÍµ∞Íµ¨'].str.split().str[0]  
```

```python
apt['county'] = apt['ÏãúÍµ∞Íµ¨'].str.split().str[1]
```

```python
# Í∞ÄÏû• Í±∞Îûò Í±¥ÏàòÍ∞Ä ÎßéÏùÄ ÏßÄÏó≠ÏùÄ Í≤ΩÍ∏∞ÎèÑ
province_counts = apt.province.value_counts().sort_values()
province_counts
```

![image.png](/assets/20250509/33.png)

**ÏãúÍ∞ÅÌôî**

```python
sns.countplot(data=apt, y='province')
plt.show()
```

![image.png](/assets/20250509/34.png)

```python
# Ïù¥Î†áÍ≤åÎèÑ Í∑∏Î¶¥ Ïàò ÏûàÎã§.
plt.barh(y=province_counts.index, width=province_counts)
plt.show()
```

![image.png](/assets/20250509/35.png)

**Ïó∞, Ïõî ÌååÏÉùÎ≥ÄÏàò Ï∂îÍ∞Ä**

```python
apt['year'] = apt['Í≥ÑÏïΩÎÖÑÏõî'] // 100
apt['month'] = apt['Í≥ÑÏïΩÎÖÑÏõî'] % 100
```

## **ÏÑúÏö∏Ïãú Íµ¨Î≥Ñ ÏïÑÌååÌä∏ Îß§Îß§Í∞Ä Î∂ÑÏÑù**

```python
# seoul_apt = apt[apt.province == 'ÏÑúÏö∏ÌäπÎ≥ÑÏãú']
seoul_apt = apt[apt.province.str.startswith('ÏÑúÏö∏')]
```

```python
# Íµ¨Î≥Ñ Îß§Îß§Í±¥Ïàò, Í±∞ÎûòÍ∏àÏï° ÌèâÍ∑†, ÏµúÎåìÍ∞í, ÏµúÏÜüÍ∞í
# aggfunc : ÌîºÎ≤ó ÌÖåÏù¥Î∏îÏùò Í∞íÏóê ÏÇ¨Ïö©Ìï† ÏßëÍ≥Ñ Ìï®Ïàò
seoul_apt.groupby(by='county')['Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)'].agg(['count','mean','max','min'])
```

![image.png](/assets/20250509/36.png)

```python
seoul_by_county = seoul_apt.pivot_table(values='Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)', index='county', aggfunc=['count', 'mean', 'min', 'max'])
seoul_by_county
```

## **ÏÑúÏö∏ÏóêÏÑú Í±∞ÎûòÍ±¥ÏàòÍ∞Ä ÎßéÏùÄ ÏÉÅÏúÑ 10Í∞ú Íµ¨Ïùò Í±∞ÎûòÍ∏àÏï° ÌèâÍ∑†, ÏµúÏÜüÍ∞í, ÏµúÎåìÍ∞í**

```python
# headÎ•º Ïù¥Ïö©
seoul_top10_count = seoul_by_county.sort_values(by=('count', 'Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)'), ascending=False).head(10)
seoul_top10_count
```

ÏãúÍ∞ÅÌôî

```python
sns.barplot(data=seoul_top10_count, x=('count', 'Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)'), y=seoul_top10_count.index)
plt.show()
```

![image.png](/assets/20250509/37.png)

## **ÏÑúÏö∏ÏóêÏÑú Íµ¨Î≥Ñ ÏïÑÌååÌä∏ Ïã§Í±∞ÎûòÍ∞Ä ÌèâÍ∑† ÏÉÅÏúÑ 10Í∞ú Íµ¨Ïùò Í±∞ÎûòÍ±¥Ïàò, Í±∞ÎûòÍ∏àÏï° ÌèâÍ∑†, ÏµúÏÜüÍ∞í, ÏµúÎåìÍ∞í**

```python
seoul_top10_mean = seoul_by_county.sort_values(by=('mean', 'Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)'), ascending=False).head(10)
seoul_top10_mean
```

![image.png](/assets/20250509/38.png)

```python
sns.barplot(data=seoul_top10_mean, x=('mean', 'Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)'), y=seoul_top10_mean.index)
plt.show()
```

![image.png](/assets/20250509/39.png)

‚Üí Í∞ïÎÇ®Ïù¥ ÏßëÍ∞í Ï†úÏùº ÎπÑÏã∏Îã§.

## **Í¥ëÏó≠ÏãúÎèÑÎ≥Ñ ÏïÑÌååÌä∏ Í±∞Îûò Î∂ÑÏÑù**

```python
by_province = apt.groupby(by='province')['Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)'].agg(['count', 'mean', 'min', 'max'])
by_province
```

## **ÏïÑÌååÌä∏ Í±∞Îûò Í±¥Ïàò ÏÉÅÏúÑ 5Í∞ú Í¥ëÏó≠ÏãúÎèÑ**

```python
top5_count_by_province = by_province.sort_values(by='count', ascending=False).head(5)
top5_count_by_province
```

![image.png](/assets/20250509/40.png)

**ÏãúÍ∞ÅÌôî**

```python
sns.barplot(data=top5_count_by_province, x='count', y='province')
plt.show()
```

![image.png](/assets/20250509/41.png)

## **Ïã§Í±∞ÎûòÍ∞Ä ÌèâÍ∑† ÏÉÅÏúÑ 5Í∞ú Í¥ëÏó≠ÏãúÎèÑ**

```python
top5_mean_by_province = by_province.sort_values(by='mean', ascending=False).head(5)
top5_mean_by_province
```

![image.png](/assets/20250509/42.png)

```python
sns.barplot(data=top5_mean_by_province, x='mean', y='province')
plt.show()
```

![image.png](/assets/20250509/43.png)

# **Ï†ÑÏö©Î©¥Ï†Å¬†84m2¬†Ïù¥ÏÉÅ¬†100m2¬†ÎØ∏ÎßåÏùò ÏÑúÏö∏ÌäπÎ≥ÑÏãú ÏïÑÌååÌä∏**

```python
# ÏïÑÍπå Í∑∏ÎûòÌîÑ Î¥§ÏùÑÎïå ÎåÄÎ∂ÄÎ∂Ñ ÏÑ†Ìò∏ÌïòÎäî Î©¥Ï†ÅÏù¥ 84m2 Ï†ïÎèÑÏòÄÎã§. 
seoul_midsize_apt = seoul_apt[(seoul_apt['Ï†ÑÏö©Î©¥Ï†Å(„é°)'] >= 84) & (seoul_apt['Ï†ÑÏö©Î©¥Ï†Å(„é°)'] < 100)]
seoul_midsize_apt
```

```python
seoul_midsize_by_county = seoul_midsize_apt.groupby(by='county')['Í±∞ÎûòÍ∏àÏï°(ÎßåÏõê)'].agg(['count', 'mean', 'min', 'max'])
seoul_midsize_by_county
```

![image.png](/assets/20250509/44.png)

‚Üí ÏÉÅÏúÑ4Í∞ú  Í±∞ÎûòÍ∏àÏï°

## **Í±∞ÎûòÏàò ÏÉÅÏúÑ 10Í∞ú Íµ¨**

```python
seoul_midsize_top10_count = seoul_midsize_by_county.sort_values(by='count', ascending=False).head(10)
seoul_midsize_top10_count
```

![image.png](/assets/20250509/45.png)

## **Ïã§Í±∞ÎûòÍ∞Ä ÏÉÅÏúÑ 10Í∞ú Íµ¨**

```python
seoul_midsize_top10_mean = seoul_midsize_by_county.sort_values(by='mean', ascending=False).head(10)
seoul_midsize_top10_mean
```

‚Üí Ïó≠Ïãú Í∞ïÎÇ®Ïù¥ ÏÉÅÏúÑÏóê ÏûàÏóàÎã§.